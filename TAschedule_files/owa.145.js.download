self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.145.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[145],{2685:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(30),a=15,o=420;function i(e){if(e)return o;var t=Object(r.a)();return t?t.UserOptions.DefaultReminderTimeInMinutes:a}},3302:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(2685),o=n(4998),i=n(10),l=n(1325),d=n(545),c=n(782),u=15;function s(e,t,n){var s,b,O,f=Object(c.a)(),j=u,I=!1,p=!t&&!n;if(e?(e.IsAllDayEvent?(s=e.Start||Object(i.Wb)(Object(i.Pb)()),b=e.End||Object(i.Wb)(Object(i.e)(Object(i.Pb)(),1)),p=!1):(s=e.Start||Object(i.f)(Object(i.Xb)(Object(i.Pb)()),1),b=e.End||Object(i.h)(s,f)),j=e.ReminderMinutesBeforeStart||Object(a.a)(e.IsAllDayEvent),e.ParentFolderId||(O=Object(o.a)()),I=e.IsOnlineMeeting):(s=Object(i.f)(Object(i.Xb)(Object(i.Pb)()),1),b=Object(i.h)(s,f),O=Object(o.a)(),j=Object(a.a)(!1)),p){var g=Object(d.g)(s,b);s=g.start,b=g.end}var v={ItemId:null,ParentFolderId:O,Subject:null,ReminderIsSet:-1!=j,ReminderMinutesBeforeStart:j,LastModifiedTime:null,InstanceKey:null,Preview:null,__type:null,Start:s,StartTimeZoneId:s.tz,End:b,EndTimeZoneId:b.tz,IsAllDayEvent:!1,IsRoomRequested:!1,AutoRoomBookingStatus:void 0,IsDraft:!1,FreeBusyType:"Busy",IsMeeting:!1,IsCancelled:!1,IsRecurring:!1,IsResponseRequested:!0,CalendarItemType:"Single",ResponseType:null,Organizer:null,RequiredAttendees:null,OptionalAttendees:null,Resources:null,AppointmentReplyTime:null,Recurrence:null,Location:null,IntendedFreeBusyStatus:null,IsOrganizer:!0,AppointmentReplyName:null,IsSeriesCancelled:null,CharmId:Object(l.t)().IconId,Locations:null,ClientSeriesId:null,EffectiveRights:null,HasAttachments:!1,HasBlockedImages:!1,Attachments:null,Sensitivity:"Normal",Body:{Value:"",BodyType:"HTML"},EntityNamesMap:0,TailoredXpEntities:null,UID:null,ExperienceType:"Unspecified",DoNotForwardMeeting:!1,IsOnlineMeeting:I,JoinOnlineMeetingUrl:null,Categories:null,InboxReminders:null,MeetingRequestWasSent:null,ExtractionSourceId:null,OnlineMeetingProvider:null,OnlineMeetingJoinUrl:null,OnlineMeetingConferenceId:null,OnlineMeetingTollNumber:null,OnlineMeetingTollFreeNumbers:null,SeriesMasterItemId:null,ExtractionSourceInternetMessageId:null,PersonId:null,InReplyTo:null,HideAttendees:!1,IsFreeBusyOnly:null,MeetingNotesWebUrl:null,SkypeTeamsProperties:null,DocLinks:[],AppendOnSend:[],IsBookedFreeBlocks:!1,AssociatedTasks:[],CollabSpace:null};return e&&(v=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v),e),{Start:s,End:b}),e.FreeBusyType||(v.FreeBusyType=e.IsAllDayEvent?"Free":"Busy")),v}},3783:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1753),a=n(175);function o(e){var t=Object(r.e)(e);return Object(a.z)(t)}},4998:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(290),a=n(175),o=n(3783),i=n(389);function l(){var e=Object(a.w)(),t=d(null==e?void 0:e.id.mailboxInfo.userIdentity);if(t)return t;var n=Object(i.i)();if(n){var o=d(n.userIdentity);if(o)return o}var l=null,c=Object(r.d)();return e&&(c=e.id.mailboxInfo,l=Object(a.r)(e)),{Id:l,mailboxInfo:c}}function d(e){var t=Object(a.w)(e),n=t?function(e){var t=Object(o.a)(e);return t?t.filter(a.N):null}(t.id.mailboxInfo.userIdentity):null,r=n?n.length:0,i=t;return n&&r>0?(i=n[r-1],t&&n.forEach((function(e){e.id.id==t.id.id&&(i=t)})),{Id:Object(a.r)(i),mailboxInfo:i.id.mailboxInfo}):null}},545:function(e,t,n){"use strict";var r=n(178);function a(e){return Object(r.f)()&&0!==e?e<60?Object(r.c)():Object(r.b)():0}var o=n(782);function i(){var e=Object(o.a)(),t=a(e);return Math.max(e-t,0)}var l,d=n(10);function c(e,t){if(!Object(r.g)())return t;var n=a(Object(d.x)(t,e)),o=n?Object(d.ec)(t,n):t;return Object(d.Gb)(e,o)?o:t}function u(e,t){if(!Object(r.h)())return e;var n=a(Object(d.x)(t,e)),o=n?Object(d.h)(e,n):e;return Object(d.Gb)(o,t)?o:e}function s(e,t){return{start:u(e,t),end:c(e,t)}}function b(e,t,n,a){var o=Object(d.x)(t,e),i=Object(d.x)(a,n),c=60-Object(r.b)();return 0===o&&0!==i&&i<c?l.ZeroToShort:0===o&&i>=c?l.ZeroToLong:0===i&&0!==o&&o<c?l.ShortToZero:0===i&&o>=c?l.LongToZero:o<c&&i<c||o>=c&&i>=c?l.None:o<c&&i>=c?l.ShortToLong:o>=c&&i<c?l.LongToShort:null}function O(e,t,n,a,o,i){if(!Object(r.h)())return n;var c=b(e,t,n,a),u=o?n:e,s=n;return c===l.ShortToLong?s=Object(d.h)(Object(d.ec)(u,Object(r.c)()),Object(r.b)()):c===l.LongToShort?s=Object(d.h)(Object(d.ec)(u,Object(r.b)()),Object(r.c)()):c!==l.ZeroToShort||i?c!==l.ZeroToLong||i||(s=Object(d.h)(u,Object(r.b)())):s=Object(d.h)(u,Object(r.c)()),Object(d.Gb)(s,a)?s:n}function f(e,t,n,a){if(!Object(r.g)())return a;var o=b(e,t,n,a),i=a;return o===l.ShortToLong?i=Object(d.ec)(Object(d.h)(a,Object(r.c)()),Object(r.b)()):o===l.LongToShort?i=Object(d.ec)(Object(d.h)(a,Object(r.b)()),Object(r.c)()):o===l.ZeroToShort?i=Object(d.ec)(a,Object(r.c)()):o===l.ZeroToLong&&(i=Object(d.ec)(a,Object(r.b)())),Object(d.Gb)(n,i)?i:a}function j(e,t){if(!Object(r.h)())return t;var n=Object(r.c)(),a=Object(r.b)();return e>=60-a?Object(d.h)(t,a):Object(d.h)(t,n)}function I(e,t,n,r){return Object(d.Hb)(t,r)?f(e,t,n,r):c(n,r)}function p(e,t,n,r){return Object(d.Hb)(e,n)?O(e,t,n,r):u(n,r)}function g(e,t,n,r){return{start:p(e,t,n,r),end:I(e,t,n,r)}}!function(e){e[e.None=0]="None",e[e.ShortToLong=1]="ShortToLong",e[e.LongToShort=2]="LongToShort",e[e.ZeroToShort=3]="ZeroToShort",e[e.ZeroToLong=4]="ZeroToLong",e[e.ShortToZero=5]="ShortToZero",e[e.LongToZero=6]="LongToZero"}(l||(l={})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return O})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return j})),n.d(t,"h",(function(){return g}))},789:function(e,t,n){"use strict";var r=n(0),a=n(175),o=n(290),i=n(30),l=n(475),d=n(56);function c(e,t,n){var c,u={},s={},b={},O={},f={},j=n?[n]:[Object(i.a)().SessionSettings.LogonEmailAddress],I=Object(o.d)(n);return e.forEach((function(e){f[e.ItemId.Id]=e.ItemId.ChangeKey;var n=Object(r.__assign)(Object(r.__assign)({},e),{id:{id:e.GroupId,mailboxInfo:I}}),o=Object(a.s)(I.userIdentity,e.GroupId);O[o]=n,e.Calendars.forEach((function(e){if(function(e,t){if(7==e.CalendarFolderType)return!1;if(Object(l.e)(e)){var n=e;if(n.IsOwnerEmailAddressInvalid)return d.g.info("[getCalendarsService] Ommitting shared calendar with IsOwnerEmailAddressInvalid flag on, OwnerEmailAddress: {1}: "+n.OwnerEmailAddress),!1;var r=n.IsGeneralScheduleCalendar?n.OwnerEmailAddress:n.SharedFolderId?n.SharedFolderId.Id:null;if(!r)return d.g.info("[getCalendarsService] Ommitting linked calendar with null SharedFolderId, Id: {1}: "+e.ItemId.Id),!1;if(t.includes(r))return d.g.info("[getCalendarsService] Ommitting duplicate shared calendar from Calendar folder list. DuplicateKey: {1}: "+r),!1;if(t.push(r),n.OwnerEmailAddress=n.OwnerEmailAddress.toLowerCase(),n.IsGroupMailboxCalendar)return!1}return!0}(e,j)){var n=e.ItemId.Id,o=Object(a.h)(e).Id,i=Object(r.__assign)(Object(r.__assign)({},e),{id:{id:n,mailboxInfo:I}});if(1==e.CalendarFolderType){var s=t&&t.filter((function(e){return e.FolderId.Id===o}))[0];c={id:{id:n,mailboxInfo:I},calculatedFolderId:o,displayName:s?s.DisplayName:e.CalendarName,colorScheme:null},i.CalendarName=c.displayName}!u[n]&&(u[n]=i),!b[o]&&(b[o]={id:e.ItemId.Id,mailboxInfo:I}),!f[n]&&(f[n]=e.ItemId.ChangeKey)}}))})),t.forEach((function(e){var t=b[e.FolderId.Id];t&&(s[t.id]=e)})),{defaultCalendar:c,calendarEntryMapping:u,calendarFolderMapping:s,folderIdMapping:b,calendarGroupMapping:O,calendarIdToChangeKeyMapping:f}}var u=n(798),s=n(317),b=n(806),O=n(96),f=n(443),j=n(566);function I(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=null,n=null,e&&!Object(O.t)(e)||(t=Object(b.a)()),t)return[3,6];n=Object(f.a)(Object(o.d)(e)),r.label=1;case 1:return r.trys.push([1,3,,6]),[4,Object(u.a)({Header:Object(s.b)()},n)];case 2:return t=r.sent(),[3,6];case 3:return r.sent(),Object(j.a)()?[4,j.d.importAndExecute(e)]:[3,5];case 4:t=r.sent(),r.label=5;case 5:return[3,6];case 6:return t&&Object(j.a)()?(n||(n=Object(f.a)(Object(o.d)(e))),[4,j.b.importAndExecute({userIdentity:e,options:n},t)]):[3,8];case 7:r.sent(),r.label=8;case 8:return[2,t]}}))}))}var p=n(760),g=n(799);function v(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=Object(f.a)({type:"GroupMailbox",userIdentity:n,mailboxSmtpAddress:t}),i=Object(a.o)(e.Id),l=i&&(i.IsGeneralScheduleCalendar||i.IsGroupMailboxCalendar)?Object(p.a)({Id:"calendar",Mailbox:{EmailAddress:t}}):5==i.CalendarFolderType?i.SharedFolderId:e,[4,Object(g.a)({request:{FolderId:l}},o)];case 1:return[2,r.sent()]}}))}))}var h=n(554),m=n(266),S=n(3),y=Object(S.action)("calendarFolderIdUpdated"),T=Object(S.action)("setCalendarLoadState",(function(e,t){return{calendarId:e,loadState:t}}));function C(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),T(e,"Loading"),[4,F(e)];case 1:return n.sent(),[3,3];case 2:return(t=n.sent()).message&&(t.message.indexOf("ErrorApiQuarantined")>=0||t.message.indexOf("ErrorTooManyObjectsOpened")>=0)?T(e,"Throttled"):T(e,"Failed"),[3,3];case 3:return[2]}}))}))}function F(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,l,d,c,u,s,b,f,j;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!(t=Object(a.m)(e)))throw new Error("Unable to get calendar entry for calendar "+e);n=Object(a.x)(e),i=Object(a.i)(e),l=Object(a.u)(n),d=l?l.mailboxInfo:Object(o.d)(),c=Object(a.L)(t),f=Object(a.t)().filter((function(e){return e.GroupId==t.ParentGroupId})),b=f?f[0].id.mailboxInfo.userIdentity:Object(o.d)().userIdentity,5==t.CalendarFolderType&&Object(O.h)().SessionSettings.DefaultPublicFolderMailbox?u=Object(O.h)().SessionSettings.DefaultPublicFolderMailbox:(j=function(e,t){return e||(t?t.userIdentity:null)}(t.OwnerEmailAddress,d),u=c?Object(a.f)(j):j),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,v(Object(h.a)({Id:i}),u,b)];case 2:return s=r.sent(),[3,4];case 3:return r.sent(),Object(m.q)("getCalendarFolderConfigurationServiceFailed"),Object(a.P)(t),[2];case 4:if(!s)throw new Error("Unable to get folder for calendar "+e);return(Object(a.P)(t),5==t.CalendarFolderType?function(e,t,n){var r=e.CalendarFolder;if(r){t.CalendarFolderId||(t.CalendarFolderId=e.CalendarFolder.FolderId);var i=r.ReplicaList[0];Object(a.b)(t,r,(l=i,{type:"PublicMailbox",userIdentity:Object(o.d)().userIdentity,mailboxSmtpAddress:l}))}var l}(s,t):function(e,t,n,r,o){var i,l,d=e.CalendarFolder;o&&(null===(i=null==d?void 0:d.FolderId)||void 0===i?void 0:i.Id)&&(d.FolderId.Id=Object(a.O)(d.FolderId.Id,r));(null===(l=null==d?void 0:d.EffectiveRights)||void 0===l?void 0:l.Read)&&(e.MasterList&&(t.RemoteCategories=e.MasterList),(r==t.OwnerEmailAddress||t.ItemId&&r==t.ItemId.Id)&&(Object(a.e)(r,{id:{id:t.ItemId.Id,mailboxInfo:n},calculatedFolderId:d.FolderId.Id}),Object(a.R)(r),Object(a.b)(t,d,n)))}(s,t,d,e,c),y(),[2])}}))}))}var w=n(389);function E(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,I(e)];case 1:if(null==(t=r.sent())||!t.WasSuccessful)throw i=new Error("[getCalendarFoldersFromServer] Failed to load calendars from server"),t?i.fetchErrorType="ServerFailure":i.networkError=!0,Object(d.d)(i),i;return n=c(t.CalendarGroups,t.CalendarFolders,e),l=t.CalendarGroups.length,o=l<1?{lowerBoundResultSize:null,upperBoundResultSize:0}:l<=3?{lowerBoundResultSize:1,upperBoundResultSize:3}:l<=6?{lowerBoundResultSize:4,upperBoundResultSize:6}:{lowerBoundResultSize:7,upperBoundResultSize:null},Object(m.q)("CalendarGroupsPerAccount",{connectedAccount_1:Object(w.r)(e),calendarGroupCount:t.CalendarGroups.length,calendarGroupCount_2:o.lowerBoundResultSize+" - "+o.upperBoundResultSize}),Object(a.E)(n.defaultCalendar,n.calendarEntryMapping,n.calendarFolderMapping,n.calendarGroupMapping,n.folderIdMapping,n.calendarIdToChangeKeyMapping),[2]}var l}))}))}var _=n(20),M=Object(S.createStore)("OwaCalendarsApiStore",{calendarIdsLoadState:new _.ObservableMap});function x(e){return M().calendarIdsLoadState.get(e)}Object(S.mutator)(T,(function(e){var t=e.calendarId,n=e.loadState;M().calendarIdsLoadState.set(t,n)})),Object(S.mutator)(a.Q,(function(e){var t=e.calendar;M().calendarIdsLoadState.delete(t.id.id)})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return I})),n.d(t,"c",(function(){return C})),n.d(t,"f",(function(){return E})),n.d(t,"a",(function(){return y})),n.d(t,"d",(function(){return x}))},798:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(29);function a(e,t){return Object(r.a)("GetCalendarFolders",e,t)}},799:function(e,t,n){"use strict";var r=n(29),a=n(0);function o(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(a.__assign)({__type:"GetCalendarFolderConfigurationRequest:#Exchange"},n))),Object(r.a)("GetCalendarFolderConfiguration",e,t)}n.d(t,"a",(function(){return o}))}}]);
//# sourceMappingURL=owa.145.js.map
self.scriptsLoaded['owa.145.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.145.js'] = (new Date()).getTime();