self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailOptin~ReadingPane.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[259],{1307:function(e,n,t){"use strict";function r(e){if(!e)return null;var n=e.lastIndexOf(".");return n>0?e.substr(n).toLowerCase():null}function i(e){var n=r(e);return n?n.replace(".",""):null}function o(e){var n;return(null===(n=i(e))||void 0===n?void 0:n.substring(0,4))||""}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return o}))},1314:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1345:function(e,n,t){"use strict";var r=t(1307),i=t(1584),o=t(11);function u(e){var n;return e>=1073741824?(e/=1073741824,n=Object(o.b)(i.b)):e>=1048576?(e/=1048576,n=Object(o.b)(i.d)):e>=1024?(e/=1024,n=Object(o.b)(i.c)):n=Object(o.b)(i.a),Object(o.c)(n,Math.round(e))}var a,c=t(1408),d=t(77),s=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function f(e){if(!Object(d.i)("doc-attachment-documentThumbnail"))return!1;var n=Object(r.a)(e);return!!n&&s.indexOf(n.toLowerCase())>=0}function l(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return a.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return a.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return a.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(a||(a={}));var m=t(1362);t.d(n,"b",(function(){return r.a})),t.d(n,"c",(function(){return r.b})),t.d(n,"d",(function(){return r.c})),t.d(n,"i",(function(){return u})),t.d(n,"g",(function(){return c.a})),t.d(n,"h",(function(){return f})),t.d(n,"f",(function(){return l})),t.d(n,"e",(function(){return m.b})),t.d(n,"a",(function(){return a}))},1362:function(e,n,t){"use strict";function r(e){return n=e||"",(t=o.exec(n))&&t.length>1&&i[t[1].toLowerCase()];var n,t}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return u}));var i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},o=/^\s*([^;\s]*)(?:;|\s|$)/;function u(e){var n="";return Object.entries(i).forEach((function(t){t[1]===e&&(n=t[0])})),n}},1408:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return d}));var r=t(1307),i=t(1362),o=t(67),u=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],a=[".tiff",".tif"];function c(e,n,t){return void 0===t&&(t=!0),d(Object(r.a)(e)||Object(i.a)(n),t)}function d(e,n){return void 0===n&&(n=!0),!!e&&(u.indexOf(e.toLowerCase())>=0||n&&a.indexOf(e.toLowerCase())>=0&&(Object(o.e)()||Object(o.d)()||Object(o.h)()||Object(o.g)()&&!Object(o.l)()))}},1434:function(e,n,t){"use strict";var r=t(1314),i=t(1345);function o(e){return e.map((function(e){return{fileType:r.a.Uri,name:e.name,type:Object(i.b)(e.url)||"",size:0,uri:e.url}}))}var u=t(56);function a(e,n,t){if(e.length!=n.length)return u.d("The sizes of subjects and latestItemIds are different"),null;for(var i=[],o=0;o<e.length;o++){var a={fileType:r.a.MailItem,name:e[o],size:(null==t?void 0:t[o])||0,itemId:n[o]};i.push(a)}return i}function c(e,n,t){var i=[],o={fileType:r.a.MailItem,name:e,size:t||0,mimeContent:n};return i.push(o),i}function d(e){if(!e)return null;for(var n=[],t=0;t<e.length;t++){var i=e[t],o={fileType:r.a.Local,name:i.name,size:i.size,type:i.type,fileObject:i};n.push(o)}return n}function s(e){if(!e)return null;for(var n=[],t=0;t<e.length;t++){var r=e[t],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};n.push(i)}return n}function f(e){var n,t;return null===e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(n=e.Thumbnail)||void 0===n?void 0:n.Url)||"",previewUrl:(null===(t=e.Preview)||void 0===t?void 0:t.Url)||"",type:e.MimeType}}function l(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var m={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function p(e){switch(e?e.toLowerCase():null){case m.ONE_DRIVE_PRO.toLowerCase():return 0;case m.GDRIVE.toLowerCase():return 5;case m.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case m.DROPBOX.toLowerCase():return 2;case m.BOX.toLowerCase():return 3;case m.WOPI_BOX.toLowerCase():return 7;case m.WOPI_EGNYTE.toLowerCase():return 8;case m.MAILBOX.toLowerCase():return 4;case m.FACEBOOK.toLowerCase():return 6;default:return null}}t.d(n,"i",(function(){return o})),t.d(n,"h",(function(){return a})),t.d(n,"g",(function(){return c})),t.d(n,"f",(function(){return d})),t.d(n,"d",(function(){return s})),t.d(n,"e",(function(){return f})),t.d(n,"c",(function(){return l})),t.d(n,"b",(function(){return p})),t.d(n,"a",(function(){return r.a}))},1460:function(e,n,t){"use strict";t.d(n,"q",(function(){return o})),t.d(n,"z",(function(){return u})),t.d(n,"d",(function(){return a})),t.d(n,"u",(function(){return c})),t.d(n,"x",(function(){return d})),t.d(n,"y",(function(){return s})),t.d(n,"w",(function(){return f})),t.d(n,"v",(function(){return l})),t.d(n,"e",(function(){return m})),t.d(n,"f",(function(){return p})),t.d(n,"h",(function(){return b})),t.d(n,"m",(function(){return v})),t.d(n,"A",(function(){return g})),t.d(n,"r",(function(){return O})),t.d(n,"j",(function(){return w})),t.d(n,"s",(function(){return h})),t.d(n,"t",(function(){return I})),t.d(n,"a",(function(){return C})),t.d(n,"l",(function(){return x})),t.d(n,"p",(function(){return E})),t.d(n,"i",(function(){return j})),t.d(n,"b",(function(){return A})),t.d(n,"n",(function(){return y})),t.d(n,"c",(function(){return P})),t.d(n,"g",(function(){return T})),t.d(n,"o",(function(){return S})),t.d(n,"k",(function(){return R}));var r=t(74),i=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(6),t.e(8),t.e(18),t.e(21),t.e(24),t.e(28),t.e(41),t.e(62),t.e(79),t.e(121),t.e(116),t.e(120),t.e(208),t.e(207),t.e(472)]).then(t.bind(null,3562))})),o=new r.b(i,(function(e){return e.removeExtensibilityNotification})),u=new r.b(i,(function(e){return e.updatePersistentNotifications})),a=new r.b(i,(function(e){return e.closeTaskPaneAddinCommand})),c=new r.b(i,(function(e){return e.triggerAppointmentTimeChangedEvent})),d=new r.b(i,(function(e){return e.triggerRecipientsChangedEvent})),s=new r.b(i,(function(e){return e.triggerRecurrenceChangedEvent})),f=new r.b(i,(function(e){return e.triggerLocationsChangedEvent})),l=new r.b(i,(function(e){return e.triggerAttachmentsChangedEvent})),m=new r.b(i,(function(e){return e.deinitializeAddinsForItem})),p=new r.b(i,(function(e){return e.initializeAddinsForItem})),b=new r.a(i,(function(e){return e.initializeExtensibilityContext})),v=new r.b(i,(function(e){return e.onHostItemChanged})),g=new r.b(i,(function(e){return e.whenItemHasContextualAddinKeywords})),O=new r.b(i,(function(e){return e.runContextualEvaluationAndUpdate})),w=new r.b(i,(function(e){return e.launchTranslateCommand})),h=new r.b(i,(function(e){return e.setPersistedAddin})),I=new r.b(i,(function(e){return e.shouldForceOnSendCompliantBehavior})),C=(Object(r.d)(i,(function(e){return e.AddinBarView})),Object(r.d)(i,(function(e){return e.TaskPaneCollection}))),x=new r.b(i,(function(e){return e.onComposeClose})),E=new r.b(i,(function(e){return e.openContextualCallout})),j=new r.b(i,(function(e){return e.launchAddinCommand})),A=new r.b(i,(function(e){return e.observeAddinCommandSurfaceItems})),y=new r.b(i,(function(e){return e.onItemNavigation})),P=new r.b(i,(function(e){return e.allowItemSendEvent})),T=new r.a(i,(function(e){return e.ExecuteEntryPoint})),S=new r.a(i,(function(e){return e.onLaunchEventTriggered})),R=new r.a(i,(function(e){return e.logAppTeachingUICalloutTelemetry}))},1584:function(e){e.exports=JSON.parse('{"b":"Psb","d":"Qsb","c":"Rsb","a":"Ssb"}')},3714:function(e,n,t){"use strict";var r=t(1356),i=t(74),o=t(8390),u=t(11),a=t(6480);var c=t(2222);function d(e){if(!e)return!1;if(function(e){return null!=e.RightsManagementLicenseData}(e))return!1;if(e.IsDraft)return!1;if(Object(c.a)()&&e.MailboxInfo&&"GroupMailbox"===e.MailboxInfo.type)return!1;var n=e.ItemClass.toLowerCase();return!function(e){return 0==e.indexOf("ipm.note.smime")&&-1==e.indexOf("ipm.note.smime.multipartsigned")}(n)&&!function(e){return 0==e.indexOf("report")}(n)}var s=t(319),f=t(361),l=t(266),m=t(1299),p="ows/api/beta/Addins/PinAddins";function b(){var e=Object(f.a)(),n=new l.b("ExtPinRequest");Object(s.d)(p,{correlationId:e,defaults:Object(m.c)()[m.a.SurfaceActions]},e,!0).then((function(t){n.addCustomData([e,t.status]),200==t.status&&t.text().then((function(e){m.e.importAndExecute(m.a.SurfaceActions,JSON.parse(e))})),n.end()})).catch((function(){n.end()}))}var v,g,O=t(0),w=t(1499),h=t(30);!function(e){e[e.None=0]="None",e[e.Compose=1]="Compose",e[e.Read=2]="Read"}(g||(g={}));var I=((v={})[g.None]="NoAddins",v[g.Compose]="ComposeAddinOnly",v[g.Read]="ReadAddinOnly",v[g.Compose|g.Read]="BothAddins",v);function C(e){var n=JSON.parse(e);return{addinId:n.id,commandId:n.controlId}}function x(){return Object(O.__awaiter)(this,void 0,void 0,(function(){var e,n,t,i,o,u,a;return Object(O.__generator)(this,(function(c){switch(c.label){case 0:return e=Object(h.a)().ViewStateConfiguration,[4,r.I.import()];case 1:return n=c.sent(),t=g.None,(i=e.PinnedComposeAddin)&&(o=C(i),n(w.a.MessageCompose,o),t|=g.Compose),(u=e.PinnedReadAddin)&&(a=C(u),n(w.a.MessageRead,a),t|=g.Read),Object(l.q)("ExtPersistedAddinMigration",[I[t]]),[2]}}))}))}var E=t(318);function j(e,n){return void 0===n&&(n=null),Object(O.__awaiter)(this,void 0,void 0,(function(){return Object(O.__generator)(this,(function(t){switch(t.label){case 0:return!Object(E.a)()?[4,r.D.import()]:[3,2];case 1:t.sent()(e,n),t.label=2;case 2:return[2]}}))}))}var A=t(1411);function y(){Object(A.f)()?j(r.h.NotSupported):j(r.h.Empty)}t.d(n,"b",(function(){return T})),t.d(n,"a",(function(){return S})),t.d(n,"e",(function(){return d})),t.d(n,"c",(function(){return b})),t.d(n,"d",(function(){return x})),t.d(n,"f",(function(){return j})),t.d(n,"g",(function(){return y}));var P=new i.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(6),t.e(8),t.e(18),t.e(21),t.e(24),t.e(28),t.e(41),t.e(62),t.e(79),t.e(121),t.e(116),t.e(120),t.e(208),t.e(207),t.e(472)]).then(t.bind(null,17156))})),T=new i.b(P,(function(e){return e.createMailReadAdapter})),S=new i.b(P,(function(e){return e.createMailComposeAdapter}));r.i.sendFeedback=function(){var e=[{Name:Object(u.b)(o.a),EmailAddress:"outlookinclientstorefeedback@service.microsoft.com"}];a.a(e,[],[],Object(u.b)(o.c),Object(u.b)(o.b),[])}},5612:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(0),i=t(1356),o=t(1434),u=t(1345);function a(e){var n,t,a=[];try{for(var c=Object(r.__values)(e),d=c.next();!d.done;d=c.next()){var s=d.value,f=null;s.attachmentType==i.a.Item?f={fileType:o.a.MailItem,name:s.name,size:s.size,itemId:s.id}:s.attachmentType==i.a.File&&(f={fileType:o.a.Uri,name:s.name,size:s.size,uri:s.id,type:Object(u.b)(s.id)}),f&&a.push({file:f,isInline:s.isInline})}}catch(e){n={error:e}}finally{try{d&&!d.done&&(t=c.return)&&t.call(c)}finally{if(n)throw n.error}}return a}},6480:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(5612),i=t(1502);function o(e,n,t,o,u,a){var c={operation:0,bodyType:"HTML",subject:o,newContent:u,to:e,cc:n,bcc:t,preferAsyncSend:!0,attachmentFilesToUpload:Object(r.a)(a)};i.m.importAndExecute(c,2)}},8390:function(e){e.exports=JSON.parse('{"a":"Mgc","c":"Ngc","b":"Ogc"}')}}]);
//# sourceMappingURL=owa.MailBoot~MailOptin~ReadingPane.js.map
self.scriptsLoaded['owa.MailBoot~MailOptin~ReadingPane.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailOptin~ReadingPane.js'] = (new Date()).getTime();