self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GroupAddMemberV2~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[169],{1347:function(e,t,n){"use strict";n.d(t,"l",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"i",(function(){return O})),n.d(t,"h",(function(){return v})),n.d(t,"f",(function(){return p})),n.d(t,"j",(function(){return F})),n.d(t,"k",(function(){return j})),n.d(t,"g",(function(){return S}));var r,o,i=n(33),a=n(30),u=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],c=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],s={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function d(){return Object(a.a)().SessionSettings.IsPremiumConsumerMailbox}function l(){return Object(a.a)().IsConsumerChild}function f(){return Object(a.a)().SessionSettings.IsShadowMailbox}function b(){return void 0!==o?o:o=function(){var e=Object(a.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return u.indexOf(n)>-1?n:s[n.split("-")[1]]||n}()}function O(e){return null!=e?e.toUpperCase().split("-"):[]}function v(e){return O(e)[1]||"US"}function p(){return Object(i.a)("ANON")}function F(){return Object(i.a)("MUID")}function j(){return!!Object(i.a)("TOptOut")}function S(){return r||(r="https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}},1435:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1830),o=n(1719);function i(e){return Object(o.b)().scenarioStores.get(Object(r.a)(e))||Object(o.a)()}},1505:function(e,t,n){"use strict";n.d(t,"q",(function(){return d})),n.d(t,"t",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"i",(function(){return O})),n.d(t,"o",(function(){return v})),n.d(t,"b",(function(){return p})),n.d(t,"m",(function(){return F})),n.d(t,"f",(function(){return j})),n.d(t,"p",(function(){return S})),n.d(t,"s",(function(){return m})),n.d(t,"r",(function(){return h})),n.d(t,"g",(function(){return g})),n.d(t,"j",(function(){return w})),n.d(t,"k",(function(){return I})),n.d(t,"n",(function(){return y})),n.d(t,"d",(function(){return E})),n.d(t,"c",(function(){return P})),n.d(t,"h",(function(){return T})),n.d(t,"l",(function(){return A}));var r=n(0),o=n(72),i=n(1290),a=n(1305),u=n(3),c=n(1407),s=n(30),d=Object(u.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(_(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(u.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(_(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(u.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,o){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:o}})),b=Object(u.action)("EXPAND_ROW_FIRST_LEVEL",(function(e,t){return{rowKey:e,latestItemIdsInForks:t}})),O=Object(u.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),v=Object(u.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",(function(e){return{rowKey:e}})),p=Object(u.action)("ITEM_PART_SELECTED",(function(e,t,n,r,o){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:o}})),F=Object(u.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),j=Object(u.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),S=Object(u.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r,o){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r,currentSelectedNodeIds:o}})),m=Object(u.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),h=Object(u.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),g=Object(u.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),w=Object(u.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),I=Object(u.action)("RESET_SELECTION",(function(e){return{tableView:e}})),y=Object(u.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(o.c)(_(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),E=Object(u.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),P=Object(u.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),T=Object(u.action)("RESET_BUS_STOP_STATE_MAP"),A=Object(u.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}}));function _(e,t,n,o){return{name:function(e,t,n,o){return!(function(e){return e===a.b.MailListItemRichPreview||e===a.b.KeyboardShiftEnter||e===a.b.MailListItemBodyDoubleClick}(e)||Object(c.c)()&&!function(e){var t;return e===a.b.KeyboardEnter||e===a.b.MailListItemBody||e===a.b.RouteHandler||e===a.b.CommandBarArrows||e===a.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(s.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,o){if(Object(c.c)())return!1;if(e===a.b.KeyboardUpDown){var u=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==u&&1===t.selectedRowKeys.size){var s=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return o===i.d.Next?s===u+1||s===t.rowKeys.length-1&&u===t.rowKeys.length-1:s===u-1||0===s&&0===u}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,o))}(e,t,n,o)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},1572:function(e,t,n){"use strict";var r=n(74),o=n(2180),i=n(3),a=n(1291),u=Object(i.mutatorAction)("loadPopoutDataToFolderStore",(function(e){var t=e.folderId,n=e.treeType,r=e.permission,o=e.principalSMTPAddress,i=Object(a.o)();if(!i.get(t)){var u={FolderId:{Id:t},treeType:n,PermissionSet:{Permissions:[r]},principalSMTPAddress:o};i.set(t,u)}})),c=n(3259),s=Object(i.mutatorAction)("loadPopoutDataToPublicFolderFavoriteStore",(function(e){var t=e.folderId,n=e.treeType,r=e.replicaItem,o=c.b.folderTable;if(!o.get(t)){var i={FolderId:{Id:t},treeType:n,ReplicaList:[r]};o.set(t,i)}})),d=n(2062),l=n(1301),f=n(1318),b=n(1305),O=n(281),v=Object(O.action)("selectFolderWithFallbackInFolderForest")((function(e,t){var n=Object(l.a)(e)||e;Object(b.r)(n)?Object(f.isFolderInFavorites)(n)?Object(d.a)(n,"favorites",t):Object(d.a)(n,"primaryFolderTree",t):Object(o.a)(t)})),p=n(1378);function F(e,t){var n=Object(p.c)();return(null==n?void 0:n.id)&&n.treeType==t&&e.toLowerCase()==n.id.toLowerCase()}var j=n(2855),S=n(3286),m=n(3287),h=n(3437);Object(i.orchestrator)(h.a,(function(e){v("notes",e.actionSource)}));n.d(t,"c",(function(){return w})),n.d(t,"l",(function(){return I})),n.d(t,"h",(function(){return y})),n.d(t,"g",(function(){return E})),n.d(t,"i",(function(){return P})),n.d(t,"f",(function(){return T})),n.d(t,"j",(function(){return A})),n.d(t,"k",(function(){return _})),n.d(t,"e",(function(){return C})),n.d(t,"b",(function(){return R})),n.d(t,"d",(function(){return L})),n.d(t,"p",(function(){return o.a})),n.d(t,"m",(function(){return u})),n.d(t,"n",(function(){return s})),n.d(t,"q",(function(){return d.a})),n.d(t,"r",(function(){return v})),n.d(t,"a",(function(){return F})),n.d(t,"o",(function(){return j.a}));var g=new r.c((function(){return Promise.all([n.e(18),n.e(42),n.e(570)]).then(n.bind(null,17195))})),w=new r.a(g,(function(e){return e.loadDumpster})),I=new r.a(g,(function(e){return e.toggleFavoriteFolder})),y=new r.a(g,(function(e){return e.selectFolderNode})),E=new r.a(g,(function(e){return e.selectFavoriteSearch})),P=new r.a(g,(function(e){return e.selectGroup})),T=new r.a(g,(function(e){return e.selectFavoriteCategory})),A=new r.a(g,(function(e){return e.selectPersona})),_=new r.a(g,(function(e){return e.selectPrivateDistributionList})),C=new r.a(g,(function(e){return e.prefetchFrequentlyUsedFolders})),R=new r.a(g,(function(e){return e.deleteFolderInFolderForest})),L=new r.a(g,(function(e){return e.logConsumerDeletedRetentionPolicy}));Object(r.f)(S.a,g,(function(e){return e.selectPreviousNodeOrchestrator})),Object(r.f)(m.a,g,(function(e){return e.validateDumpsterQuotaOrchestrator}))},1576:function(e,t,n){"use strict";function r(){return{isBeingDragged:!1}}n.d(t,"a",(function(){return r}))},1626:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(77),o=n(96);function i(){return Object(r.i)("mail-oneView")&&Object(o.r)()}},1651:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Mail=1]="Mail",e[e.Calendar=2]="Calendar",e[e.FilesHub=3]="FilesHub",e[e.FilesPicker=4]="FilesPicker",e[e.Spaces=5]="Spaces",e[e.FileSuggestions=6]="FileSuggestions"}(r||(r={})),t.b=r},1671:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(20),o=n(3),i={mailFavoritesViewState:{contextMenuState:null,shouldShowFindFavoritesPicker:!1},favoritePersonasRootFolderId:void 0,isFavoritingInProgress:new r.ObservableMap({}),favoriteNodeViewStates:new r.ObservableMap({})},a=Object(o.createStore)("mailFavorites",i);t.a=a()},1672:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,o=t%n;return(((e-=r)/n&(t-=o)/n)>>>0)*n+((r&o)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},1719:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(20),o=n(3),i=function(){return{alteredQuery:"",alterationProviderId:null,answerPlaceholderId:null,currentSearchQueryId:null,currentSuggestions:null,displayedQFRequestTime:null,flaggedTokens:[],isAnswerRendered:!1,isLastKeyPressedDeletion:!1,isSuggestionsCalloutClickable:!1,isSuggestionsDropdownVisible:!1,isUsing3S:null,latestQFRequestId:null,latestRenderedQFTraceId:null,latestQFTraceId:null,latestTraceId:null,nextSearchQueryId:null,recourseQuery:"",searchBoxHasFocus:!1,searchBoxWidth:null,searchSessionGuid:null,searchText:"",searchTextForSuggestion:"",selectedPillIndex:-1,selectedSuggestionIndex:-1,showRefiners:!1,showSearchBoxInCompactMode:!1,suggestedSearchTerm:"",suggestedSearchTermReferenceId:"",suggestionPillIds:[],suggestionPills:new r.ObservableMap,queryAlterationType:null,queryActionSource:null,queryAlterationLogicalId:null,traceIdToLogicalIdMap:new r.ObservableMap,tableViewId:null,isScopePickerVisible:!1}},a={scenarioStores:new r.ObservableMap},u=Object(o.createStore)("commonSearchStore",a);t.b=u},1811:function(e,t,n){"use strict";var r=n(1626),o=n(77),i=n(1347),a=n(681);function u(){return Object(o.i)("auth-cloudCache")&&(Object(i.b)()||Object(i.c)())&&Object(a.a)()||Object(r.a)()}n.d(t,"a",(function(){return u}))},1817:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"m",(function(){return u})),n.d(t,"l",(function(){return c})),n.d(t,"n",(function(){return s})),n.d(t,"o",(function(){return d})),n.d(t,"p",(function(){return l})),n.d(t,"r",(function(){return f})),n.d(t,"q",(function(){return b})),n.d(t,"u",(function(){return O})),n.d(t,"s",(function(){return v})),n.d(t,"t",(function(){return p})),n.d(t,"b",(function(){return F})),n.d(t,"c",(function(){return j})),n.d(t,"e",(function(){return S})),n.d(t,"a",(function(){return m})),n.d(t,"d",(function(){return h})),n.d(t,"h",(function(){return g})),n.d(t,"i",(function(){return w})),n.d(t,"j",(function(){return I})),n.d(t,"k",(function(){return y}));var r=n(74),o=new r.c((function(){return Promise.all([n.e(3),n.e(5),n.e(6),n.e(8),n.e(15),n.e(17),n.e(21),n.e(23),n.e(30),n.e(52),n.e(267),n.e(727)]).then(n.bind(null,2653))})),i=new r.b(o,(function(e){return e.clearSearchBox})),a=new r.b(o,(function(e){return e.endSearchSession})),u=new r.b(o,(function(e){return e.onDownArrowPressedSearchInput})),c=new r.b(o,(function(e){return e.onBackspacePressedSearchInput})),s=new r.b(o,(function(e){return e.onLeftArrowPressedSearchInput})),d=(new r.b(o,(function(e){return e.onRightArrowPressedSearchInput})),new r.b(o,(function(e){return e.onUpArrowPressedSearchInput}))),l=new r.b(o,(function(e){return e.removeSuggestionPillFromSearchBox})),f=new r.b(o,(function(e){return e.setLatestQFRequestId})),b=new r.b(o,(function(e){return e.setIsSuggestionsDropdownVisible})),O=new r.b(o,(function(e){return e.updateIsSuggestionSetComplete})),v=new r.b(o,(function(e){return e.setShowSearchBoxInCompactMode})),p=new r.a(o,(function(e){return e.setSpellerData})),F=(Object(r.d)(o,(function(e){return e.PersonaPill})),Object(r.d)(o,(function(e){return e.PrivateDistributionListPill})),Object(r.d)(o,(function(e){return e.SearchBoxDropdown}))),j=Object(r.d)(o,(function(e){return e.SearchBoxPillWell})),S=Object(r.d)(o,(function(e){return e.SuggestionsCallout})),m=Object(r.d)(o,(function(e){return e.CompactSearchBox})),h=Object(r.d)(o,(function(e){return e.SearchScopePicker})),g=new r.b(o,(function(e){return e.getSuggestionAtIndex})),w=new r.b(o,(function(e){return e.isInSearchMode})),I=new r.b(o,(function(e){return e.isQFRequestIdEqualToLatest})),y=new r.b(o,(function(e){return e.isSearchBoxEmpty}))},1818:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=1,o=16},1825:function(e,t,n){"use strict";n.r(t);var r=n(74),o=n(0),i=n(266),a=n(675),u=n(361),c=n(30),s=n(3),d=n(2856),l=n(1318);Object(s.orchestrator)(l.migrateOutlookFavorites,(function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r,s,O,v,p,F,j,S,m,h;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return e=function(){var e=Object(c.a)().UserOptions.FavoriteNodes;if(!e)return{owsFavoritesData:[],clientFavoritesData:[]};var t=[],n=[];return e.forEach((function(e){var r=Object(l.parseFavoriteNode)(e);switch(r.type){case 1:var o=r;if(!Object(l.isPersonaInFavorites)(o.personaId,o.mainEmailAddress)){var i=function(e,t,n){return{treeType:"favorites",type:"persona",favoriteId:e,displayName:t.displayName,searchFolderId:t.searchFolderId,client:n?"Migration":"OWA",allEmailAddresses:t.allEmailAddresses,personaId:t.personaId,mainEmailAddress:t.mainEmailAddress,isSearchFolderPopulated:!!t.searchFolderId,isSyncUpdateDone:!0}}(f=Object(u.a)(),o,!0),c=function(e){var t=[],n=[],r=e.displayName||e.mainEmailAddress;if(r){if(e.mainEmailAddress){t.push({Key:"MainEmailAddress",Value:e.mainEmailAddress}),e.searchFolderId&&t.push({Key:"SearchFolderId",Value:Object(l.convertEWSFolderIdToRestFolderId)(e.searchFolderId)});var o=e.allEmailAddresses&&e.allEmailAddresses.filter((function(e){return!!e}));o.length>0?n.push({Key:"EmailAddresses",Values:o}):n.push({Key:"EmailAddresses",Values:[e.mainEmailAddress]})}if(e.personaId&&t.push({Key:"PersonaId",Value:Object(l.convertEWSFolderIdToRestFolderId)(e.personaId)}),0!==t.length)return{Type:"persona",DisplayName:r,SingleValueSettings:t,MultiValueSettings:n,Client:"Migration"}}}(o);c&&(t.push(c),n.push(i))}break;case 4:var s=r.id,d=Object(a.o)().filter((function(e){return e.Id===s}))[0];if(d&&!Object(l.isCategoryInFavorites)(s)){var f=Object(u.a)(),b=Object(l.createClientFavoriteCategoryData)(f,d,!0),O=Object(l.createOwsFavoriteCategoryData)(d,!0);t.push(O),n.push(b)}}})),{owsFavoritesData:t,clientFavoritesData:n}}(),t=e.owsFavoritesData,n=e.clientFavoritesData,0===t.length?(b(),[2]):[4,l.lazyAddMultipleFavoritesToStore.import()];case 1:o.sent()(n),(r=n.filter((function(e){return"persona"===e.type}))).length>0&&Object(d.a)(r),s=Math.ceil(t.length/20),O=!1,(v=new i.b("MigrateOutlookFavoriteService",{isCore:!0})).addCustomProperty("totalBatchCount",s),p=0,F=0,o.label=2;case 2:return p<s?(j=t.slice(F,F+20),(S=new i.b("MigrateOutlookFavoriteSingleBatchService",{isCore:!0})).addCustomProperty("favoritesCount",j.length),m=n.slice(F,F+20),[4,f(j,m,S)]):[3,5];case 3:O=o.sent(),o.label=4;case 4:return p++,F+=20,[3,2];case 5:return O?v.endWithError("ServerError"):v.end(),(h=!Object(l.getIsBitEnabled)(8))?(l.lazySetOutlookFavoritesBitFlag.importAndExecute(8),O||b()):b(),Object(i.q)(h?"FirstAttemptMigrationCompleted":"SecondAttemptMigrationCompleted",[O],{isCore:!0}),[2]}}))}))}));function f(e,t,n){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i,a,u,c,s;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,Object(l.createMultipleOutlookFavoritesService)(e)];case 1:return r=o.sent(),[3,3];case 2:return i=o.sent(),n.endWithError("ServerError",i),[2,!0];case 3:return o.trys.push([3,5,,6]),a=(r.value||[]).map((function(e){return Object(l.convertServiceResponseToFavoriteData)(e,e.Type.toLowerCase())})),[4,l.lazyAddMultipleFavoritesCompleted.import()];case 4:return o.sent()(t,a),u=a.filter((function(e){return"persona"===e.type})),c=a.filter((function(e){return"category"===e.type})),n.addCustomProperty("migratedPersonasCount",u.length),n.addCustomProperty("migratedCategoriesCount",c.length),n.end(),[3,6];case 5:return s=o.sent(),n.endWithError("ClientError",s),[2,!0];case 6:return[2,!1]}}))}))}function b(){l.lazySetOutlookFavoritesBitFlag.importAndExecute(16)}var O=n(1671),v=n(1576),p=n(1337),F=Object(s.mutatorAction)("setFavoriteNodeViewStateMutator",(function(e,t){Object(O.b)().favoriteNodeViewStates.set(e,t)}));function j(e){return Object(O.b)().favoriteNodeViewStates.has(e)||F(e,{drag:Object(v.a)(),drop:Object(p.a)()}),Object(O.b)().favoriteNodeViewStates.get(e)}var S=n(281),m=Object(S.action)("showFindFavoritesPicker")((function(e){O.a.mailFavoritesViewState.shouldShowFindFavoritesPicker=e})),h=n(2365);n.d(t,"lazyModule",(function(){return g})),n.d(t,"lazyToggleFavoritesTreeExpansion",(function(){return w})),n.d(t,"lazyRemoveFavoriteSearch",(function(){return I})),n.d(t,"lazyRemoveFavoritePersona",(function(){return y})),n.d(t,"lazyOnSelectedPersonaNodeChanged",(function(){return E})),n.d(t,"lazyHandleToggleFavoritePersonaError",(function(){return P})),n.d(t,"lazyMarkFavoritePersonaNodeAsAdded",(function(){return T})),n.d(t,"lazyOnFavoritePersonaSelected",(function(){return A})),n.d(t,"lazyAddFavoriteFolder",(function(){return _})),n.d(t,"lazyRemoveFavoriteFolder",(function(){return C})),n.d(t,"lazyAddFavoriteFolderV1",(function(){return R})),n.d(t,"lazyRemoveFavoriteFolderV1",(function(){return L})),n.d(t,"lazyOnFavoritePersonaUpdated",(function(){return N})),n.d(t,"lazyAddFavoritePersona",(function(){return D})),n.d(t,"lazyInitializeFavoritePersonas",(function(){return k})),n.d(t,"lazyOutlookFavoritePersonasLoaded",(function(){return M})),n.d(t,"getFavoriteNodeViewStateFromId",(function(){return j})),n.d(t,"getStore",(function(){return O.b})),n.d(t,"showFindFavoritesPicker",(function(){return m})),n.d(t,"isFavoritingInProgress",(function(){return h.a}));var g=new r.c((function(){return Promise.all([n.e(41),n.e(58),n.e(61),n.e(76),n.e(254),n.e(633)]).then(n.bind(null,17179))})),w=new r.a(g,(function(e){return e.toggleFavoritesTreeExpansion})),I=new r.a(g,(function(e){return e.removeFavoriteSearch})),y=new r.a(g,(function(e){return e.removeFavoritePersona})),E=new r.a(g,(function(e){return e.onSelectedPersonaNodeChanged})),P=new r.a(g,(function(e){return e.handleToggleFavoritePersonaError})),T=new r.a(g,(function(e){return e.markFavoritePersonaNodeAsAdded})),A=new r.a(g,(function(e){return e.onFavoritePersonaSelected})),_=new r.b(g,(function(e){return e.addFavoriteFolder})),C=new r.b(g,(function(e){return e.removeFavoriteFolder})),R=new r.a(g,(function(e){return e.addFavoriteFolderV1})),L=new r.a(g,(function(e){return e.removeFavoriteFolderV1})),N=new r.a(g,(function(e){return e.onFavoritePersonaUpdated})),D=new r.a(g,(function(e){return e.addFavoritePersona})),k=new r.a(g,(function(e){return e.initializeFavoritePersonas})),M=new r.a(g,(function(e){return e.outlookFavoritePersonasLoaded}))},1830:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1651);function o(e){switch(e){case r.b.Mail:return"Mail";case r.b.Calendar:return"Calendar";case r.b.FilesHub:return"FilesHub";case r.b.FilesPicker:return"FilesPicker";case r.b.Spaces:return"Spaces";case r.b.FileSuggestions:return"FileSuggestions";default:throw Error("Unknown SearchScenarioId value!")}}},2008:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("setShowFolderPane",(function(e){return{showFolderPane:e}}))},2062:function(e,t,n){"use strict";var r=n(1572),o=n(3126),i=n(3265),a=n(1291),u=n(2407),c=n(2468),s=n(1564),d=n(1378),l=n(3399),f=n(2409),b=n(1290),O=n(1305),v=n(1351),p=n(1301),F=n(72),j=n(1306),S=n(3),m=n(1407),h=n(1859),g=n(1899),w=n(1513),I=n(11),y=n(3770),E=n(1455);var P=Object(S.action)("selectFolder",(function(e,t,n,r){var o=Object(d.c)().id;return Object(F.c)({name:"SwitchMailFolder",options:{variant:3},customData:[Object(v.a)(e),o?Object(v.a)(o):"",t,n,Object(b.B)(Object(b.A)(e))]},{folderId:e,treeType:t,previousFolderId:o,actionSource:n,folderNodeType:r,isNewFolderSameAsPreviousFolder:e==o})}));t.a=P,Object(S.orchestrator)(P,(function(e){var t,n=e.folderId,d=e.treeType,F=e.previousFolderId,S=e.actionSource,P=e.folderNodeType,T=e.isNewFolderSameAsPreviousFolder,A=Object(g.a)(),_=a.d.folderTable.get(n);6===P&&(_=w.a.folderTable.get(n));var C=Promise.resolve(),R=Object(b.G)(),L=R&&1==R.tableQuery.type;T&&R&&(Object(m.c)()&&Object(h.a)()||Object(f.a)(R));var N=R&&Object(b.O)(R);if(!T||N&&"All"!==N||"spotlight"==(null===(t=null==R?void 0:R.tableQuery)||void 0===t?void 0:t.scenarioType)){C=function(e,t,n,r){var o;e&&(o=Object(p.a)(e));var a=o||e;return Object(i.a)({id:a,type:null!=r?r:0,treeType:t},n)}(n,d,S,P);var D=Object(v.a)(n);Object(u.a)(n),Object(a.G)(_)&&"inbox"!==D&&D!==j.h&&Object(l.b)(n),D===j.g?r.c.importAndExecute(j.h):D===j.a&&r.c.importAndExecute(j.b)}return s.b.importAndExecute(),Object(o.a)(S),"ResetInbox"===S&&O.s.importAndExecute(Object(I.b)(y.a),"assertive"),C.then((function(){Object(c.a)(n,F,L,null==R?void 0:R.id,E.a.Auto,A,S)})),C})),Object(S.mutator)(P,(function(e){e.isNewFolderSameAsPreviousFolder&&(d.a.selectedNode.treeType=e.treeType),b.X.rowInfoForVLV.clear(),b.X.scrollTop=0}))},2088:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i}));var r=350,o=270,i=418},2148:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1453),o=n(1407);function i(){var e=Object(r.c)();return Object(o.a)()?e<=541:e<=918}},2180:function(e,t,n){"use strict";var r=n(1301);var o=n(2062),i=n(1318);function a(e){var t=Object(r.a)("inbox"),n=Object(i.isFolderInFavorites)(t)?"favorites":"primaryFolderTree";Object(o.a)(t,n,e)}n.d(t,"a",(function(){return a}))},2191:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1468);function o(){return Object(r.a)().showFolderPane}},2307:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("LOAD_FAVORITES");t.a=o},2308:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(74),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(1394)]).then(n.bind(null,2838))})),i=Object(r.d)(o,(function(e){return e.StarCharm}))},2310:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1383),o=n(77);function i(){return Object(o.i)("tri-spotlight2")&&!Object(r.a)(2048)}},2364:function(e,t,n){"use strict";var r=n(361),o=n(77);t.a={RemoveFavoritePersonaAction:{name:"RemoveFavoritePersonaAction",customData:function(e,t){return[t]}},AddFavoriteSearch:{name:"AddFavoriteSearch",customData:function(e,t){return[t,Object(o.i)("tri-favorites-roaming")]}},RemoveFavoriteSearch:{name:"RemoveFavoriteSearch",customData:function(e,t){return[t,Object(o.i)("tri-favorites-roaming")]}},AddFavoritePersonaAction:{name:"AddFavoritePersonaAction",customData:function(e,t,n,r,o,i){return[r]}},ValidateAndUpdateFavorite:{name:"ValidateAndUpdateFavorite",customData:function(e,t,n){return Object(r.b)(e)?[e]:null}},DeleteFolderFailure:{name:"DeleteFolderFailure",customData:function(e){return[e]}},OnFavoritePersonaSelectedAction:{name:"OnFavoritePersonaSelectedAction"},OnFavoritePersonaUpdatedAction:{name:"OnFavoritePersonaUpdatedAction"},InitializeFavoritePersonasAction:{name:"InitializeFavoritePersonasAction"},OneOffAddressUsedForFavorite:"OneOffAddressUsedForFavorite",OutlookFavoritePersonasLoaded:{name:"OutlookFavoritePersonasLoaded"}}},2365:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1671),o=n(1318),i=n(77);function a(e){return Object(i.i)("tri-favorites-roaming")?Object(o.isOutlookFavoritingInProgress)(e):!0===Object(r.b)().isFavoritingInProgress.get(e)}},2412:function(e,t,n){"use strict";var r=n(3),o=Object(r.createStore)("spotlightStore",{spotlightItems:[],rollupDismissed:!1,logicalId:null,requestStartTime:null});t.a=o},2414:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return d}));var r=n(74),o=new r.c((function(){return Promise.all([n.e(18),n.e(44),n.e(75),n.e(246),n.e(588)]).then(n.bind(null,5794))})),i=new r.a(o,(function(e){return e.loadGroups})),a=new r.a(o,(function(e){return e.loadGroupsFromSessionData})),u=new r.a(o,(function(e){return e.removeGroupFromLeftNav})),c=new r.a(o,(function(e){return e.toggleGroupTreeExpansion})),s=new r.a(o,(function(e){return e.unsubscribeFromUnreadNotifications})),d=new r.a(o,(function(e){return e.setGroupLastVisitedTime}))},2592:function(e,t,n){"use strict";var r=n(74),o=n(2412);function i(e){var t=e.itemId,n=e.conversationId,r=e.rowKey;return Object(o.a)().spotlightItems.some((function(e){return t&&e.itemId===t||n&&e.conversationId===n||r&&e.rowKey===r}))}var a=n(2310);n.d(t,"i",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"h",(function(){return l})),n.d(t,"m",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"g",(function(){return O})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return F})),n.d(t,"a",(function(){return j})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a.a}));var u=new r.c((function(){return Promise.all([n.e(3),n.e(48),n.e(55),n.e(58),n.e(61),n.e(76),n.e(749)]).then(n.bind(null,17175))})),c=new r.a(u,(function(e){return e.initializeSpotlight})),s=new r.b(u,(function(e){return e.getSpotlightLogicalId})),d=new r.b(u,(function(e){return e.getSpotlightItem})),l=new r.b(u,(function(e){return e.getUnacknowledgedSpotlightCount})),f=new r.a(u,(function(e){return e.onSpotlightDismissedFromRP})),b=new r.a(u,(function(e){return e.getSpotlightDonationJson})),O=new r.a(u,(function(e){return e.getSpotlightReasonString})),v=new r.a(u,(function(e){return e.loadImportantTable})),p=new r.a(u,(function(e){return e.logSpotlightItemClicked})),F=new r.a(u,(function(e){return e.logSpotlightResultsRendered})),j=Object(r.d)(u,(function(e){return e.SpotlightIconTeachingMoment}))},2739:function(e,t,n){"use strict";var r=n(3),o=n(20),i=n(3602);Object(r.mutator)(i.a,(function(e){u().prefetchedFolderIds.set(e.folderId,!0)}));n.d(t,"b",(function(){return u}));var a={frequentlyUsedFolders:[],isInitialized:!1,prefetchedFolderIds:new o.ObservableMap({})},u=Object(r.createStore)("frequentlyUsedFoldersStore",a),c=u();t.a=c},2855:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("onNewsSearchExit",(function(e){return{treeType:e}}))},2856:function(e,t,n){"use strict";var r=n(3),o=n(72),i=n(2364);t.a=Object(r.action)("outlookFavoritePersonasLoaded",(function(e){return Object(o.c)(i.a.OutlookFavoritePersonasLoaded,{personas:e})}))},2858:function(e,t,n){"use strict";var r=n(281),o=n(2259);t.a=Object(r.action)("commandBarAction")((function(e){o.a.navigationButtonSelected=e}))},2859:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="#"},2924:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(273);function o(){return Object(r.a)().favorites}},2927:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("POPULATE_PUBLIC_FOLDER_OUTLOOK_FAVORITE_STORE")},2928:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("POPULATE_PUBLIC_FOLDER_FAVORITE_STORE_V1")},2929:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ADD_PUBLIC_FOLDER_TO_STORE",(function(e,t){return{state:e,item:t}}))},3022:function(e,t,n){"use strict";var r=n(1290),o=n(1911);function i(e,t){var n;switch(t){case 0:n=o.a;break;case 1:n=Object(o.f)()}return{categoryName:null,folderId:e,focusedViewFilter:-1,listViewType:t,viewFilter:"All",sortBy:r.c.getDefaultSortBy(),requestShapeName:n,type:2,shouldTryToUseSessionDataResponse:!1,scenarioType:"group"}}var a=n(30);function u(){var e=Object(a.a)().UserOptions.GlobalListViewTypeReact;return null==e?0:e}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u}))},3035:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("REMOVE_FAVORITE_FROM_PUBLIC_FOLDER_STORE",(function(e){return{folderId:e}}))},3126:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(0),o=n(3598),i=n(1707),a=n(1817),u=n(1435),c=n(1651),s=n(672),d=n(2148),l=n(2191),f=n(2008);function b(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,i.b()];case 1:return t.sent(),s.c.import().then((function(e){e("MailModuleNotificationBarHost")})),Object(u.a)(c.a.Mail).searchSessionGuid?[4,a.g.import()]:[3,3];case 2:t.sent()(c.a.Mail,e),t.label=3;case 3:return Object(l.a)()&&Object(d.a)()&&Object(f.a)(!1),Object(o.a)(),[2]}}))}))}},3259:function(e,t,n){"use strict";var r=n(2927),o=n(2928),i=n(74),a=n(2307),u=n(0),c=n(2929),s=n(3),d=n(2344),l=n(1604),f=n(30),b=(Object(s.mutator)(c.a,(function(e){var t=e.state,n=e.item,r=n.FolderId.Id,o=Object(f.a)().SessionSettings.DefaultPublicFolderMailbox,i=Object(l.a)(o);if(!t.folderTable.has(r)){var a=Object(u.__assign)({},Object(d.c)(n,i));t.folderTable.set(r,a)}})),n(3035)),O=n(1513);Object(s.mutator)(b.a,(function(e){var t=e.folderId;O.a.folderTable.has(t)&&O.a.folderTable.delete(t)}));n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return O.a}));var v=new i.c((function(){return Promise.all([n.e(21),n.e(45),n.e(886)]).then(n.bind(null,17370))}));Object(i.f)(a.a,v,(function(e){return e.loadPublicFolderFavoritesOchestrator})),Object(i.f)(r.a,v,(function(e){return e.populatePublicFolderOutlookFavoriteStoreOrchestrator})),Object(i.f)(o.a,v,(function(e){return e.populatePublicFolderFavoriteStoreV1Orchestrator}));var p=Object(i.d)(v,(function(e){return e.PostedToLine}))},3265:function(e,t,n){"use strict";var r=n(0),o=n(675),i=n(3022),a=n(1825),u=n(1878),c=n(1290),s=n(3016),d=n(1318),l=n(1420),f=n(3292),b=n(1938);var O=n(2858),v=n(1972),p=n(2414),F=n(1411),j=n(3),S=n(1378);function m(e,t){var n=Object(S.d)();if(1===n.selectedNode.type&&a.lazyOnSelectedPersonaNodeChanged.importAndExecute(n.selectedNode),2===n.selectedNode.type){if("DeleteGroup"!=t){var j=Object(c.G)();j&&p.d.importAndExecute(Object(F.b)(j.tableQuery))}2!==e.type&&Object(O.a)(v.a.Email)}var m=Object(r.__assign)({},e);return h(m),function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,O,v,p,F;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(e.type){case 0:return[3,1];case 4:return[3,2];case 1:return[3,6];case 5:return[3,10];case 2:return[3,14];case 6:return[3,15]}return[3,16];case 1:return O=Object(u.a)(e.id),n=Object(b.a)(e.id,Object(c.A)(e.id),"mail",null,null,null,{sortColumn:O.sortColumn,sortDirection:O.sortOrder}),[3,17];case 2:return Object(a.isFavoritingInProgress)(e.id)?(v=Object(o.k)(e.id,Object(o.o)()),[4,l.e.import()]):[3,4];case 3:return n=r.sent()(v,Object(c.A)(e.id)),[3,5];case 4:n=Object(f.a)(e.id),r.label=5;case 5:return[3,17];case 6:return(p=e).isSearchFolderPopulated?[3,8]:[4,l.f.import()];case 7:return n=r.sent()(p.displayName,p.allEmailAddresses,Object(c.A)(e.id)),[3,9];case 8:n=Object(b.a)(p.searchFolderId,Object(c.A)(p.searchFolderId),"persona"),r.label=9;case 9:return[3,17];case 10:return(F=d.favoritesStore.outlookFavorites.get(e.id)).isSearchFolderPopulated?[3,12]:[4,l.g.import()];case 11:return n=r.sent()(F.displayName,F.members,F.pdlId,F.owsPersonaId,Object(c.A)(e.id)),[3,13];case 12:n=Object(b.a)(F.searchFolderId,Object(c.A)(F.searchFolderId),"privatedistributionlist"),r.label=13;case 13:return[3,17];case 14:return n=Object(i.a)(e.id,Object(i.b)()),[3,17];case 15:return n=Object(b.a)(e.id,1,"mail"),[3,17];case 16:return[3,17];case 17:return[2,Object(s.a)(n,null,t)]}}))}))}(m,t)}n.d(t,"a",(function(){return m}));var h=Object(j.mutatorAction)("setSelectedFolderNode",(function(e){Object(S.d)().selectedNode=e}))},3286:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("SELECT_PREVIOUS_NODE",(function(e){return{actionSource:e}}))},3287:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("TRY_VALIDATE_DUMPSTER_QUOTA",(function(e){return{folderId:e}}))},3292:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1938),o=n(675),i=n(1290),a=n(1301);function u(e){var t=Object(o.k)(e,Object(o.o)());return Object(r.a)(Object(a.a)("msgfolderroot"),Object(i.A)(null),"category",-1,"UserCategory",t)}},3399:function(e,t,n){"use strict";var r=n(3601),o=n(2739),i=n(281),a=Object(i.action)("sortFolders")((function(){var e=Object(o.b)(),t=e.frequentlyUsedFolders.sort((function(e,t){return e.Weight==t.Weight?Math.abs(Date.parse(t.lvt)-Date.parse(e.lvt)):t.Weight-e.Weight}));e.frequentlyUsedFolders=t})),u=Object(i.action)("addFrequentlyUsedFolder")((function(e){var t=!1,n=Object(o.b)();if(n.isInitialized){for(var i=n.frequentlyUsedFolders.length-1;i>=0;i--){var u=n.frequentlyUsedFolders[i];if(u.FolderId==e)u.Weight+=5,u.Weight=Math.min(u.Weight,20),u.lvt=(new Date).toISOString(),t=!0;else if(u.Weight--,u.Weight=Math.max(u.Weight,0),u.Weight<=0){var c=Math.abs(Date.now()-Date.parse(u.lvt));c<6048e5&&c>=0||n.frequentlyUsedFolders.splice(i,1)}}t||n.frequentlyUsedFolders.push({FolderId:e,Weight:10,lvt:(new Date).toISOString()}),a(),n.frequentlyUsedFolders.splice(10),Object(r.a)()}})),c=n(2859);n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c.a}))},3437:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("OPEN_NOTES_FOLDER",(function(e){return{actionSource:e}}))},3598:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1970),o=n(1502),i=n(1504),a=n(1899),u=n(1407),c=n(627);function s(){null===i.a.primaryComposeId||Object(c.v)()?Object(u.c)()&&Object(a.a)()&&Object(r.a)("FolderNodeClick"):o.r.importAndExecute(null)}},3601:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(367),o=n(2739),i=n(56);function a(){var e=[];Object(o.b)().frequentlyUsedFolders.forEach((function(t){e.push(JSON.stringify(t))})),Object(r.a)((function(t){t.UserOptions.FrequentlyUsedFolders=e}),[{key:"FrequentlyUsedFolders",valuetype:"StringArray",value:e}]).catch((function(e){i.g.warn("saveFrequentlyUsedFolders: "+e)}))}},3602:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("folderPrefetchedAction",(function(e){return{folderId:e}}))},3770:function(e){e.exports=JSON.parse('{"a":"jaa"}')},681:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(24),o=n(48);function i(){var e,t=null===(e=Object(r.a)())||void 0===e?void 0:e.pathname;if(t){var n=t.split("/"+Object(o.a)()+"/")[1];if(n){var i=n.split("/")[0];if(i&&!isNaN(parseInt(i)))return!0}}return!1}}}]);
//# sourceMappingURL=owa.MailBoot~GroupAddMemberV2~MailFolderTreesParent~PublicFolderPickerModule.js.map
self.scriptsLoaded['owa.MailBoot~GroupAddMemberV2~MailFolderTreesParent~PublicFolderPickerModule.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GroupAddMemberV2~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();