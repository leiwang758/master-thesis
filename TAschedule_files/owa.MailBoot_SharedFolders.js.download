self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SharedFolders.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[738],{12939:function(e){e.exports=JSON.parse('{"a":"oyb"}')},12940:function(e){e.exports=JSON.parse('{"a":"tyb"}')},1365:function(e,r,t){"use strict";var n,a;t.d(r,"b",(function(){return n})),t.d(r,"a",(function(){return a})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(a||(a={}))},3521:function(e){e.exports=JSON.parse('{"a":"nyb"}')},4120:function(e){e.exports=JSON.parse('{"a":"myb"}')},4423:function(e){e.exports=JSON.parse('{"a":"lyb"}')},443:function(e,r,t){"use strict";var n=t(0);function a(e,r){return e?Object(n.__assign)({mailboxInfo:e},r):null!=r?r:void 0}t.d(r,"a",(function(){return a}))},4583:function(e,r,t){"use strict";t.d(r,"a",(function(){return o}));var n=t(1291),a=t(96);function o(e){return e||(e=Object(a.b)()),Object(n.u)(e).sharedFolderUserEmails}},5228:function(e,r,t){"use strict";t.d(r,"a",(function(){return o})),t.d(r,"b",(function(){return i}));var n=t(7),a=new n.b((function(){return t.e(870).then(t.bind(null,9178))})),o=new n.c(a,(function(e){return e.FolderHierarchyDocument})),i=new n.c(a,(function(e){return e.PrimaryFolderHierarchyDocument}))},5789:function(e,r,t){"use strict";t.r(r);var n=t(0),a=t(47),o=t(12939),i=t(4423),s=t(11),c=t(9671),d=t(1),u=t(6488),l=t(12940),b=t(3),f=Object(b.action)("ADD_SHARED_FOLDER_USER_EMAIL",(function(e,r){return{sharedUserMailboxSmtpAddress:e,userIdentity:r}})),O=Object(b.action)("ON_ADD_SHARED_FOLDER_SUCCESS",(function(e,r,t){return{sharedUserMailboxSmtpAddress:e,folder:r,userIdentity:t}})),h=t(29);function p(e,r){return t={displayName:e,primarySMTPAddress:r},Object(h.a)("AddSharedFolders",t,n);var t,n}var j=t(266),S=t(1309),v=t(1306),_=t(3521),y=t(56),g=t(96);function m(e,r,t,a){return void 0===t&&(t=!1),void 0===a&&(a=Object(g.b)()),Object(n.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),t?[3,2]:[4,p(e,r)];case 1:if(!n.sent())return[2];n.label=2;case 2:return[3,4];case 3:return o=n.sent(),Object(S.b)(Object(s.b)(_.a),Object(s.b)(l.a),!1,{hideCancelButton:!0}),y.d("Add shared folder API returned error "+o),[2];case 4:return i={FolderId:{Id:r},DisplayName:e,treeType:v.k,principalSMTPAddress:r,UnreadCount:0,TotalCount:0,DistinguishedFolderId:void 0},O(r,i,a),f(r,a),t||Object(j.q)("Triage_SharedFolders_AddFolder"),[2]}}))}))}var M=Object(b.action)("showAddSharedFolderDialog",(function(e){return{showDialogMessageFlag:e}})),x=Object(a.a)((function(){return u.a.showPeoplePickerDialog&&d.createElement(c.a,{title:Object(s.b)(i.a),subTitle:Object(s.b)(o.a),addCallback:A,cancelCallback:F})}));function A(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(r){return m(e.Name,e.EmailAddress),[2]}))}))}function F(){M(!1)}var I=Object(b.action)("REMOVE_SHARED_FOLDER_USER",(function(e,r){return r||(r=Object(g.b)()),{sharedUserMailboxSmtpAddress:e,userIdentity:r}})),R=t(4583),D=Object(b.action)("REMOVE_SHARED_FOLDER_USER_EMAIL",(function(e,r){return{sharedUserMailboxSmtpAddress:e,userIdentity:r}})),E=(Object(b.mutator)(D,(function(e){var r=Object(R.a)(e.userIdentity),t=r.indexOf(e.sharedUserMailboxSmtpAddress);-1!==t?r.splice(t,1):y.d("Trying to remove a non-existent shared folder user : "+e.sharedUserMailboxSmtpAddress)})),Object(b.mutator)(f,(function(e){var r=Object(R.a)(e.userIdentity);-1==r.indexOf(e.sharedUserMailboxSmtpAddress)&&r.push(e.sharedUserMailboxSmtpAddress)})),Object(b.mutator)(M,(function(e){Object(u.b)().showPeoplePickerDialog=e.showDialogMessageFlag})),t(1291));Object(b.orchestrator)(O,(function(e){var r={};r[e.sharedUserMailboxSmtpAddress]=e.folder,Object(E.b)(r),Object(E.X)(e.sharedUserMailboxSmtpAddress,e.folder,E.a.Uninitialized,!0,0,e.userIdentity)}));var P=Object(b.action)("ON_SHARED_FOLDER_FETCH_FAILED",(function(e,r){return{sharedUserMailboxSmtpAddress:e,actionSource:r}})),w=t(72),T=t(7237),U=t(340),C=t(5228),N=Object(b.action)("INITIALIZE_SHARED_FOLDER_RETENTION_POLICY_TAGS",(function(e,r){return{sharedUserMailboxSmtpAddress:e,userIdentity:r}}));Object(b.orchestrator)(T.a,(function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var r,t,a,o,i,s,c,d,u,l,b,f,O;return Object(n.__generator)(this,(function(h){switch(h.label){case 0:if(r=e.userIdentity,t=e.sharedUserMailboxSmtpAddress,a=e.actionSource,o=e.isLoadingMore,(i=Object(E.r)(t,r))===E.a.Loading||i===E.a.Loaded&&!o)return[2];Object(E.Y)(t,E.a.Loading,r),c=Object(E.p)(t,r),h.label=1;case 1:return h.trys.push([1,4,,5]),[4,Promise.all([Object(U.a)(),C.a.import()])];case 2:return d=n.__read.apply(void 0,[h.sent(),2]),u=d[0],l=d[1],[4,u.query({query:l,variables:{baseFolderDistinguishedIds:[v.l,"inbox"],indexedPageOffset:c,mailboxInfo:{userIdentity:r,mailboxSmtpAddress:t,type:"SharedMailbox"},shouldPopulateChildFolderIds:!1}})];case 3:return b=h.sent(),s=b.data.folderHierarchy,[3,5];case 4:return f=h.sent(),Object(j.q)("SharedFolders_FetchFailed",[f.ResponseCode,f.diagnosticInfo],{isCore:!0}),P(t,a),Object(E.Y)(t,E.a.ErrorLoading,r),[2];case 5:return O=Object(E.y)(t).DisplayName,Object(E.T)(s.RootFolder,s.Folders,v.l,v.k,t,O,t,r,s.IncludesLastItemInRange,s.IndexedPagingOffset),0===c&&N(t,r),p=s.TotalItemsInView,Object(j.q)("Triage_SharedFolders_OpenFolder",[Object(w.e)({value:p})]),[2]}var p}))}))}));var L=t(4120),k=t(2176),H=t(2608);function q(e){return r={primarySMTPAddress:e},Object(h.a)("RemoveSharedFolders",r,t);var r,t}Object(b.orchestrator)(P,(function(e){Object(k.k)(Object(s.b)(_.a),Object(s.b)(L.a)),"folderPane"===e.actionSource&&Object(H.a)(e.sharedUserMailboxSmtpAddress,!1)}));Object(b.orchestrator)(I,(function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var r,t,a,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:r=e.sharedUserMailboxSmtpAddress,t=e.userIdentity,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,q(r)];case 2:return a=n.sent(),[3,4];case 3:return o=n.sent(),y.d("Remove shared folders server call failed with error "+o),[3,4];case 4:return a?(D(r,t),Object(E.W)(r,t),Object(j.q)("Triage_SharedFolders_RemoveFolder")):y.d("Remove shared folders server call returned false"),[2]}}))}))}));function z(e,r){var t;return void 0===e||e.__type||(t=e,e=Object(n.__assign)({__type:"GetUserRetentionPolicyTagsJsonRequest:#Exchange"},t)),Object(h.a)("GetUserRetentionPolicyTags",e,r)}var J=t(317),W=t(443);var B=Object(b.mutatorAction)("setPolicyTags",(function(e,r){Object(u.b)().retentionPolicyTags.set(e,r)}));function G(){return e={},Object(h.a)("GetOtherMailboxConfiguration",e,r);var e,r}Object(b.orchestrator)(N,(function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var r,t,a,o,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:r=e.sharedUserMailboxSmtpAddress,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,(s=r,c={type:"SharedMailbox",userIdentity:Object(g.b)(),mailboxSmtpAddress:s},d=Object(W.a)(c),z({Header:Object(J.b)(),Body:{}},d))];case 2:return t=n.sent(),"Success"===(null===(o=null==t?void 0:t.Body)||void 0===o?void 0:o.ResponseClass)?B(r,t.Body.RetentionPolicyTags):y.d("Initialize shared folders policy tags server call failed with error "+(null===(i=null==t?void 0:t.Body)||void 0===i?void 0:i.MessageText)),[3,4];case 3:return a=n.sent(),y.d("Initialize shared folders policy tags server call failed with error "+a),[3,4];case 4:return[2]}var s,c,d}))}))}));var V=t(74),Y=Object(V.e)(E.C,"initializeSharedFolderRootsOrchestratorClone",(function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var e,r;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,G()];case 1:return e=t.sent(),(r=null==e?void 0:e.OtherMailboxEntries)?r.length>0&&(r.forEach((function(e){m(e.DisplayName,e.PrincipalSMTPAddress,!0)})),n=r.length,Object(j.q)("Triage_SharedFolders_LoadList",[Object(w.e)({value:n})])):y.d("initializeSharedFolderRoots failed with getOtherMailboxConfiguration response as : "+e),[2]}var n}))}))}));t.d(r,"SharedFolderPeoplePicker",(function(){return x})),t.d(r,"showSharedFolderPeoplePickerDialog",(function(){return M})),t.d(r,"removeSharedFolderUser",(function(){return I})),t.d(r,"initializeSharedFolderRootsOrchestrator",(function(){return Y}))},6488:function(e,r,t){"use strict";t.d(r,"b",(function(){return o}));var n=t(3),a={showPeoplePickerDialog:!1,retentionPolicyTags:new(t(20).ObservableMap)({})},o=Object(n.createStore)("sharedFolderState",a),i=o();r.a=i},7237:function(e,r,t){"use strict";t.d(r,"a",(function(){return o}));var n=t(3),a=t(96),o=Object(n.action)("GET_SHARED_FOLDERS",(function(e,r,t,n){return n||(n=Object(a.b)()),{sharedUserMailboxSmtpAddress:e,actionSource:r,isLoadingMore:t,userIdentity:n}}))},7307:function(e,r,t){"use strict";t.d(r,"b",(function(){return a})),t.d(r,"a",(function(){return o}));var n=t(3),a=Object(n.action)("populateUserMailboxInfo",(function(e){return{userMailboxWrapper:e}})),o=Object(n.action)("ON_DISMISSED")},7308:function(e,r,t){"use strict";t.d(r,"b",(function(){return i}));var n=t(1365),a=t(3),o={userMailboxWrapper:null,findControlViewState:{queryString:"",findResultSet:[],findResultType:n.b.None,isSearching:!1,directorySearchType:n.a.None,findPeopleFeedbackManager:null,numberOfCacheResults:0}},i=Object(a.createStore)("peoplePickerDialogStore",o);r.a=i()},9671:function(e,r,t){"use strict";var n=t(7307),a=t(7308),o=t(1365),i=t(3),s=(Object(i.mutator)(n.b,(function(e){Object(a.b)().userMailboxWrapper=e.userMailboxWrapper})),Object(i.mutator)(n.a,(function(){var e=Object(a.b)();e.userMailboxWrapper=null,e.findControlViewState={queryString:"",findResultSet:[],findResultType:o.b.None,isSearching:!1,directorySearchType:o.a.None,findPeopleFeedbackManager:null,numberOfCacheResults:0}})),t(74));t.d(r,"a",(function(){return d}));var c=new s.c((function(){return Promise.all([t.e(4),t.e(6),t.e(13),t.e(33),t.e(56),t.e(66),t.e(691)]).then(t.bind(null,17482))})),d=Object(s.d)(c,(function(e){return e.PeoplePickerDialog}))}}]);
//# sourceMappingURL=owa.MailBoot~SharedFolders.js.map
self.scriptsLoaded['owa.MailBoot~SharedFolders.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SharedFolders.js'] = (new Date()).getTime();