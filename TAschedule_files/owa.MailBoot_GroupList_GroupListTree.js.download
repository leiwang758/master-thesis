self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GroupList~GroupListTree.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[246],{1363:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(3),o=n(20),u=Object(r.createStore)("groupsStore",{groups:new o.ObservableMap})},1381:function(t,e,n){"use strict";var r=n(3),o=n(20),u=(Object(r.createStore)("personaPhotoStore",{personaPhotoUrls:new o.ObservableMap})(),n(1568),n(1474),n(1363)),i=n(1390),a=n(1392);function c(t){var e=Object(u.a)().groups.get(t.toLowerCase());return!!e&&!e.groupDetailsError}var s=n(1506),p=n(1533),f=function(){return Object(p.a)().smtpAddress},d=n(1464),l=Object(r.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(t,e,n,r){if(2==e){var o=Object(a.a)(t);Object(s.a)(o,"Site")[0].Url=n,Object(s.a)(o,"Files")[0].Url=r}})),b=n(1627);function g(t){return t=t.toLocaleLowerCase(),Object(d.a)().groupSiteStatus.has(t)?Object(d.a)().groupSiteStatus.get(t):0}var v=function(t){var e="string"==typeof t?Object(a.a)(t):t;return e?e.ExternalDirectoryObjectId:null},h=(n(1409),n(1621),n(1605),n(1628),n(1622),n(1947)),O=n(1948),S=n(1976),m=n(1922),j=n(1923),C=n(11);function N(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(C.b)(m.a);if(3===e)return Object(C.b)(j.a)}return""}function w(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(C.b)(S.b);if(3===e)return Object(C.b)(S.c)}return""}function D(t){var e=0;return t.members?e=t.members.totalCount:t.groupDetails&&(e=t.groupDetails.MemberCount),e?e>1?Object(C.c)(Object(C.b)(O.a),e.toString()):Object(C.c)(Object(C.b)(h.a),e.toString()):Object(C.b)(S.a)}n.d(e,"j",(function(){return u.a})),n.d(e,"l",(function(){return i.a})),n.d(e,"d",(function(){return a.a})),n.d(e,"m",(function(){return c})),n.d(e,"f",(function(){return s.a})),n.d(e,"g",(function(){return s.b})),n.d(e,"c",(function(){return f})),n.d(e,"i",(function(){return d.a})),n.d(e,"o",(function(){return l})),n.d(e,"n",(function(){return b.b})),n.d(e,"h",(function(){return g})),n.d(e,"e",(function(){return v})),n.d(e,"a",(function(){return N})),n.d(e,"b",(function(){return w})),n.d(e,"k",(function(){return D}))},1390:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(3),o=n(1474),u=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:o.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},1392:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1363);function o(t){var e=Object(r.a)().groups.get(t.toLowerCase());return e?e.groupDetails:null}},1409:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Executing=1]="Executing",t[t.Succeed=2]="Succeed",t[t.FailureNotice=3]="FailureNotice",t[t.FailureRetry=4]="FailureRetry"}(r||(r={})),e.a=r},1464:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(3),o=n(20),u=Object(r.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new o.ObservableMap})},1474:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Private=0]="Private",t[t.Public=1]="Public"}(r||(r={}))},1506:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u}));var r=n(1392),o=function(t,e){var n="string"==typeof t?Object(r.a)(t):t;if(!n||!n.GroupResources)return null;var o=n.GroupResources.filter((function(t){return t.Name===e}));return!o||o.length<1?null:o},u=function(t,e){var n=o(t,e);return n&&0!=n.length?n[0].Url:null}},1568:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(77),o=n(1390),u=n(96);function i(){return(Object(r.i)("grp-shareable-crud")||Object(o.a)().isSensitivityLabelsEnabled)&&!Object(u.s)()}},1605:function(t,e,n){"use strict";var r=n(3),o=n(1691),u=Object(r.mutatorAction)("setJoinButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=u},1621:function(t,e,n){"use strict";var r=n(3),o=n(1690),u=Object(r.mutatorAction)("setFollowButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=u},1622:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1409),o=n(1691);function u(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},1627:function(t,e,n){"use strict";n.d(e,"b",(function(){return u}));var r=n(3),o=n(1464),u=Object(r.mutatorAction)("setGroupSiteStatus",(function(t,e){t=t.toLocaleLowerCase(),Object(o.a)().groupSiteStatus.has(t)&&e==Object(o.a)().groupSiteStatus.get(t)||Object(o.a)().groupSiteStatus.set(t,e)}));e.a=u},1628:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1409),o=n(1690);function u(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},1690:function(t,e,n){"use strict";var r=n(3),o=n(20);e.a=Object(r.createStore)("followButtonStore",{groupActionState:new o.ObservableMap})()},1691:function(t,e,n){"use strict";var r=n(3),o=n(20);e.a=Object(r.createStore)("joinButtonStore",{groupActionState:new o.ObservableMap})()},1754:function(t,e,n){"use strict";var r,o,u,i,a,c,s,p,f,d,l,b,g,v,h;var O;n(11);function S(t,e){e,O=t}function m(){return O}n.d(e,"o",(function(){return r})),n.d(e,"n",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"g",(function(){return c})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return p})),n.d(e,"l",(function(){return f})),n.d(e,"m",(function(){return d})),n.d(e,"q",(function(){return l})),n.d(e,"r",(function(){return b})),n.d(e,"h",(function(){return g})),n.d(e,"j",(function(){return v})),n.d(e,"e",(function(){return h})),n.d(e,"p",(function(){})),n.d(e,"k",(function(){return S})),n.d(e,"i",(function(){return m}))},1922:function(t){t.exports=JSON.parse('{"a":"Ctb"}')},1923:function(t){t.exports=JSON.parse('{"a":"Btb"}')},1947:function(t){t.exports=JSON.parse('{"a":"Atb"}')},1948:function(t){t.exports=JSON.parse('{"a":"Gtb"}')},1976:function(t){t.exports=JSON.parse('{"b":"Dtb","c":"Etb","a":"Ftb"}')},2398:function(t,e,n){"use strict";var r=n(1514),o=n(3),u=Object(o.mutatorAction)("toggleIsShowingAllGroups",(function(){Object(r.b)().shouldShowAllGroups=!Object(r.b)().shouldShowAllGroups})),i=n(0),a=n(47),c=n(2987),s=n(11),p=n(2932),f=n(729),d=n(270),Droppable=n(1372),l=n(1381),b=n(1),g=n(1324),v=n(2917),h=n(1318),O=n(77),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onContextMenu=function(t,n){var r=e.props,o=r.onContextMenu,u=r.groupId;if(o){t.stopPropagation(),t.preventDefault();var i=u.toLowerCase(),a=Object(l.j)().groups;if(a.has(i))o(t,a.get(i))}},e.onDrop=function(t){e.props.onListNodeDrop&&e.props.onListNodeDrop(t,e.props.groupId)},e}return Object(i.__extends)(e,t),e.prototype.shouldComponentUpdate=function(t,e){return!Object(d.f)(this.props,t)},e.prototype.render=function(){var t=Object(v.a)(this.props.groupId);return b.createElement(Droppable.b,{dropViewState:t.drop,onDrop:this.onDrop,canDrop:this.props.canDropOnListNode},b.createElement(p.a,{selectGroup:this.props.selectGroup,isSelected:this.props.isSelected,renderRightCharm:this.props.renderRightCharm,renderRightCharmHover:this.props.renderRightCharmHover,chevronProps:null,customIcon:null,displayName:this.props.displayName,groupId:this.props.groupId,isDroppedOver:t.drop.isDragOver,onContextMenu:this.onContextMenu,renderCustomTreeNodeDisplay:null,customData:this.props.customData,showHoverStateOnDroppedOver:t.drop.draggableItemType==g.a.MailListRow||t.drop.draggableItemType==g.a.MultiMailListMessageRows,isFavorited:Object(O.i)("mon-tri-leftNavChanges")&&Object(h.isGroupInFavorites)(this.props.groupId)}))},e=Object(i.__decorate)([f.observer],e)}(b.Component),m=n(2720),j=n(1338),C=n(266),N=n(1709),w=n(1337),D=Object(l.j)(),A=Object(r.b)(),G=Object(a.a)((function(t){var e,n,o,a=b.useRef(!1),p=function(e){return b.createElement(S,{selectGroup:t.selectGroup,isSelected:t.isSelected,renderRightCharm:t.renderRightCharm,renderRightCharmHover:t.renderRightCharmHover,displayName:e.DisplayName,groupId:e.SmtpAddress,key:e.SmtpAddress,onContextMenu:t.onChildNodeContextMenuOpened,customData:t.customData,onListNodeDrop:t.onListNodeDrop,canDropOnListNode:t.canDropOnListNode})},f=function(e){e.stopPropagation(),t.toggleGroupTreeExpansion()},d=function(e){var n=t.onRootNodeContextMenuOpened;n&&(e.stopPropagation(),e.preventDefault(),n(e))},l=function(e){return!(A.shouldShowAllGroups||!t.canDropOnListNode)&&t.canDropOnListNode(e)},g=function(t){a.current=!0,setTimeout((function(){a.current&&!Object(r.b)().shouldShowAllGroups&&O()}),1e3)},v=function(){a.current=!1},h=function(t){t.stopPropagation(),O()},O=function(){var e=A.myOrgGroups.length;Object(C.q)("GroupList_ToggleShouldShowAllGroups",{isShowMore:!A.shouldShowAllGroups,joinedGroupCount:e>=21?"21+":e}),t.onShowMoreEvent&&t.onShowMoreEvent(),u()},G=A.myOrgGroups,x={role:j.a.tree},E=t.isGroupsTreeCollapsed;return b.createElement("div",Object(i.__assign)({style:t.style,className:t.className},Object(j.b)(x)),function(e){var n={isExpanded:!e,onClick:f};return b.createElement(N.a,{chevronProps:n,depth:0,displayName:Object(s.b)(c.a),isRootNode:!0,key:"Groups_root",onClick:n.onClick,onContextMenu:d,renderRightCharm:t.renderRootNodeRightCharm,renderRightCharmHover:t.renderRootNodeRightCharmHover,setSize:t.setSize,positionInSet:t.positionInSet})}(E),function(t,e){var n=[];if(e)return n;if(A.shouldShowAllGroups){var r=[];t.forEach((function(t){var e=D.groups.get(t);r.push(e)})),r.sort((function(t,e){return t.basicInformation.DisplayName.localeCompare(e.basicInformation.DisplayName)})).forEach((function(t){n.push(p(t.basicInformation))}))}else t.slice(0,m.a).forEach((function(t){var e=D.groups.get(t);n.push(p(e.basicInformation))}));return n}(G,E),A.withContextMenuGroup&&(A.withContextMenuGroup.isRootNode?null===(e=t.renderRootNodeContextMenu)||void 0===e?void 0:e.call(t,A.withContextMenuGroup):null===(n=t.renderChildNodeContextMenu)||void 0===n?void 0:n.call(t,A.withContextMenuGroup)),G.length>m.a&&function(e){if(e)return null;var n=A.shouldShowAllGroups?Object(s.b)(c.b):Object(s.b)(c.c),r=Object(w.a)();return b.createElement(Droppable.b,{dropViewState:r,onDrop:y,canDrop:l,onDragOver:g,onDragLeave:v},b.createElement(N.a,{displayName:n,isCustomActionNode:!0,isRootNode:!1,key:"groupsCollapseExpandNode",onClick:h,onContextMenu:M,onMouseEnter:t.onMouseEnterShowMoreButton}))}(E),null===(o=t.renderGroupListCustomNodes)||void 0===o?void 0:o.call(t))}));function y(){}function M(t){t.stopPropagation(),t.preventDefault()}n.d(e,"c",(function(){return r.a})),n.d(e,"b",(function(){return r.b})),n.d(e,"a",(function(){return G}))},2720:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var r=5,o=100},2917:function(t,e,n){"use strict";var r=n(1514),o=n(1576),u=n(1337),i=n(3),a=Object(i.mutatorAction)("setGroupNodeViewStateMutator",(function(t,e){Object(r.b)().groupNodeViewStates.set(t,e)}));function c(t){return Object(r.b)().groupNodeViewStates.has(t)||a(t,{drag:Object(o.a)(),drop:Object(u.a)(),isDroppingMessage:!1}),Object(r.b)().groupNodeViewStates.get(t)}n.d(e,"a",(function(){return c}))},2987:function(t){t.exports=JSON.parse('{"a":"xtb","b":"ytb","c":"ztb"}')},5557:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function o(t){return Object(r.__assign)({__type:"SubscriptionParameters:#Exchange"},t)}},6505:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a}));var r=n(74),o=new r.c((function(){return n.e(429).then(n.bind(null,10623))})),u=new r.b(o,(function(t){return t.addMarkAsReadDiagnostics})),i=new r.b(o,(function(t){return t.addUnreadCountNotificationDiagnostics})),a=new r.b(o,(function(t){return t.addUnreadCountSubscriptionDiagnostics}))},6962:function(t,e,n){"use strict";var r=n(6505),o=n(5557),u=n(1437),i=n(266),a=n(1318),c=n(77),s=n(2398),p=n(2720),f=n(3),d=n(1363),l=Object(f.mutatorAction)("UPDATE_GROUP_UNREAD_COUNT",(function(t,e){var n=Object(d.a)().groups.get(t.toLowerCase());n&&(n.unreadMessageCount=e)}));n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return S}));var b={};function g(t){var e=t.id.replace("UnreadCountNotification_","");if(r.b.import().then((function(n){return n(e,t)})),"0"==t.EventType.toString()){var n=b[e];n&&(l(e.toLowerCase(),t.UnreadCount),n.firstNotificationReceived||(n.unreadCountDataPoint.end(),n.unreadCountDataPoint=null,n.firstNotificationReceived=!0))}}function v(){Object(c.i)("grp-unreadCountTop5AndFavorites")?s.c.myOrgGroups.filter((function(t,e){return e<p.a||Object(a.isGroupInFavorites)(t)})).forEach((function(t){O(t)})):h()}function h(){s.c.myOrgGroups.forEach((function(t){O(t)}))}function O(t){(function(t){return!b[t]})(t=t.toLowerCase())&&u.b.import().then((function(e){var n=Object(o.a)({NotificationType:"UnreadCountNotification",ChannelId:e(),MailboxId:t}),a={subscriptionId:m(t),requiresExplicitSubscribe:!0,subscriptionParameters:n};u.f.importAndExecute(a,g);var c={notificationSubscription:a,firstNotificationReceived:!1,unreadCountDataPoint:new i.b("UnreadCountNotification")};b[t]=c,r.c.import().then((function(e){return e(t,a,!1)}))}))}function S(t){t=t.toLowerCase();var e=b[t];if(e){var n=e.notificationSubscription;n&&(u.g.importAndExecute(n,g),delete b[t],r.c.import().then((function(e){return e(t,n,!0)})))}}function m(t){return"UnreadCountNotification_"+t}}}]);
//# sourceMappingURL=owa.MailBoot~GroupList~GroupListTree.js.map
self.scriptsLoaded['owa.MailBoot~GroupList~GroupListTree.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GroupList~GroupListTree.js'] = (new Date()).getTime();