self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SubstrateSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[752],{1331:function(t,n,e){"use strict";function r(t,n){Object.keys(n).forEach((function(e){return t.set(e,n[e])}))}function c(t){var n=null!=t?t:{headers:new Headers};return n.datapoint=n.datapoint||{},n.datapoint.mailbox="Default",n}e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return c}))},1333:function(t,n,e){"use strict";var r=e(0),c=e(1394),o=e(389),u=e(669),i=e(266),a=e(10),s="X-AnchorMailbox",d="Authorization",b="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";function l(t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,l,O,j,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(e={},l=Object(o.k)(t)){if(l.accountState==o.b.AccessRevoked)return[2,null];if(l.accountState==o.b.AccountDeprovisioned||l.accountState==o.b.AccountNotFound)return Object(o.c)(l.accountState,l.accountProviderType),[2,null]}return n?(e[s]=n,e[f]=n):l&&(e[s]=l.anchorMailbox),l?(O=l.token,!(j=Object(u.g)(l.tokenExpiry))&&O?[3,2]:(Object(i.q)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(l.tokenExpiry,Object(a.Pb)()),isTokenExpired_1:j,isTokenInvalid_2:!O},{isCore:!0}),[4,c.a.importAndExecute(l.accountId,t,O)])):[3,3];case 1:(O=r.sent())||(O=""),r.label=2;case 2:p=void 0,"Outlook"==l.accountProviderType?(p='MSAuth1.0 usertoken="'+O+'", type="MSACT"',e[b]=1..toString()):"Google"!=l.accountProviderType&&"ICloud"!=l.accountProviderType||(p="Bearer "+O,e[b]=2..toString()),e[d]=p,r.label=3;case 3:return[2,e]}}))}))}var O=e(1331),j=e(56);function p(t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(O.a)(),c=e,[4,v(t,n)];case 1:return c.headers=r.sent(),e.authNeededOnUnAuthorized=!1,e.datapoint=e.datapoint||{},e.datapoint.mailbox="Connected",[2,e]}}))}))}function v(t,n){var e;return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=n&&(null===(e=t.headers)||void 0===e?void 0:e.set)?new Headers(t.headers):new Headers,[4,l(t.mailboxInfo.userIdentity,h(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return o=r.sent(),Object(O.b)(c,o),[2,c]}}))}))}function h(t,n){var e="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return e&&null==n&&j.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),e}e.d(n,"a",(function(){return l})),e.d(n,"b",(function(){return p})),e.d(n,"c",(function(){return h}))},1334:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(3),c=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1394:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(74),c=e(1334);e.d(n,"b",(function(){return c.a}));var o=new r.c((function(){return e.e(1356).then(e.bind(null,1689))})),u=new r.a(o,(function(t){return t.getAndUpdateAccessToken}))},1600:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(77);function c(){return Object(r.i)("rp-peopleSuggestionsTrie")&&Object(r.i)("rp-peopleSuggestionsCacheFirst")||Object(r.i)("rp-cacheFirstPeopleTrieSize300")||Object(r.i)("rp-cacheFirstPeopleTrieSize500")||Object(r.i)("rp-cacheFirstPeopleTrieSize700")||Object(r.i)("rp-peopleTrieOnTimeoutLow")||Object(r.i)("rp-peopleTrieOnTimeoutMed")||Object(r.i)("rp-peopleTrieOnTimeoutHigh")}},17547:function(t,n,e){"use strict";e.r(n);var r=e(2704),c=e(281),o=e(290),u=Object(c.action)("execute3SPrimeCall")((function(){Object(r.b)(Object(o.d)().userIdentity,null,!1)}));e.d(n,"execute3SPrimeCall",(function(){return u}))},2055:function(t,n,e){"use strict";var r=e(0),c=e(444);var o=e(77),u=e(4);e.d(n,"a",(function(){return s}));var i=null,a="searchtesthook";function s(t){void 0===t&&(t={});var n,e=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},t),function(){if(!i){i={};var t=Object(u.a)(a),n=decodeURIComponent(t||"").trim();if(Object(o.i)("sea-debugHook")&&n.length>0){var e=n.split("&");i=e.reduce((function(t,n){var e=Object(r.__read)(n.split("="),2),c=e[0],o=e[1];return t[c]=o,t}),{})}}return i}()),Object(c.a)("includePartnerIn3SRequest")?((n={}).partner="exchangeshared",n):null);return Object.keys(e).filter((function(t){return null!==e[t]})).reduce((function(t,n){var c;return Object(r.__assign)(Object(r.__assign)({},t),((c={})[n]=e[n],c))}),{})}},2704:function(t,n,e){"use strict";e.d(n,"a",(function(){return _})),e.d(n,"b",(function(){return I})),e.d(n,"c",(function(){return P}));var r=e(0),c=e(389),o=e(1333),u=e(77),i=e(361),a=e(336),s=e(319),d=e(2055),b=e(318),f=e(1600),l=e(56),O=e(2705),j="/search/api/v1/init?",p="/search/api/v1/suggestions?",v="owa.react.compose",h=["PandaServingCompose","PandaServingComposeZeroQuery"],S="AppendFreshContactsToTopN",y="ContextAwareServing",A="20",g="5",T="CSRClientEnabled",m="CSRCounterFactual",_="owa.projectMoca.peopleCard";function I(t,n,e,c,o,u,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,b,f,O,j;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return d=a||v,null!=n?[3,1]:[2,k(d)];case 1:return[4,w(n,e,u,d)];case 2:return b=r.sent(),f=function(t,n,e){return{AppName:"OWA",Scenario:{Name:e},Cvid:n||Object(i.a)(),EntityRequests:[t]}}(b,null==o?void 0:o.conversationId,d),O=s.d,j=[p+P(d,n),f,c,!1],[4,C(t,null==o?void 0:o.clientSessionId)];case 3:return[2,O.apply(void 0,j.concat([r.sent(),!0,!0,!1])).then((function(t){return t})).catch((function(t){return l.g.info(t),null}))]}}))}))}function k(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,e;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=s.b,e=[j+P(t),void 0,!0],[4,C(null)];case 1:return[2,n.apply(void 0,e.concat([r.sent(),!0,!1])).then((function(t){return Object(a.a)(t.status)?t.json():null})).catch((function(t){return t.networkError=!0,l.d(t),null}))]}}))}))}function w(t,n,e,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){return o={Query:{QueryString:t},EntityType:"People",Provenances:x(n),Size:n?A:g},e&&e.length>0&&(o.Context=function(t){var n={};t&&(n.RecipientsTo=t.toString());return n}(e)),o.Fields=c===_?Object(O.a)(2):Object(O.a)(1),[2,o]}))}))}function x(t){var n=["Mailbox"];return t&&!Object(b.a)()&&n.push("Directory"),n}function P(t,n){var e=Object(r.__assign)({scenario:t},Object(d.a)()),c=[],o=Object(f.a)();return(o||Object(u.i)("rp-cacheFirstPeopleTrieSize500cf"))&&(c.push.apply(c,Object(r.__spread)(h)),o&&Object(u.i)("rp-EnableFreshContactsForZeroQuery")&&c.push(S),c.push(T),c.push(m)),Object(u.i)("rp-contextualZeroQuery")&&""==n&&c.push(y),c.length>0&&(e.setflight=c.join(",")),Object.keys(e).map((function(t){return t+"="+e[t]})).join("&")}function C(t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(r){return e={},n&&(e["client-session-id"]=n),t&&Object(c.r)(t)?[2,Object(o.a)(t).then((function(t){return Object.keys(t).forEach((function(n){return e[n]=t[n]})),e}))]:[2,e]}))}))}},2705:function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var r=e(1600),c=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"],o=c.concat(["FeatureData","GivenName","Surname","Alias"]),u=c.concat(["FeatureData"]),i=c.concat(["Phones","OfficeLocation","Department"]);function a(t){return 2===t?i:Object(r.a)()?0==t?o:u:c}},336:function(t,n,e){"use strict";var r=e(732);e.d(n,"a",(function(){return r.a}))},389:function(t,n,e){"use strict";var r,c=e(3);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var o,u=e(72),i=Object(c.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),a=Object(c.action)("removeAccount",(function(t){return{userIdentity:t}})),s=Object(c.action)("updateAccount",(function(t,n,e){return{userIdentity:t,accountToken:n,accountTokenExpiresIn:e}})),d=Object(c.action)("updateOWAConnectedAccountStatus",(function(t,n){return{userIdentity:t,accountState:n}})),b=Object(c.action)("accountIsInErrorState",(function(t,n){return Object(u.c)({name:"accountIsInErrorState",options:{isCore:!0},customData:{accountState_1:r[t],accountProvider_2:n}},{accountState:t})})),f=Object(c.action)("retryAccountUpdateToken",(function(t,n,e,c,o,i){return Object(u.c)({name:"retryAccountUpdateToken",customData:{currentAccountState_1:r[c],localAccountState_2:r[o],previousAccountState_3:r[i]}},{accountId:t,userIdentity:n,currentToken:e})})),l=Object(c.action)("connectedAccountsListRequested",(function(t){return Object(u.c)({name:"connectedAccountsGetResponse",options:{isCore:!0},customData:{isSuccess_1:t}},{isSuccess:t})})),O=Object(c.action)("setAccountsStoreState",(function(t){return{state:t}})),j=e(0),p=e(20);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(o||(o={}));var v=Object(c.createStore)("OWAAccountsStore",{accountsMap:new p.ObservableMap({}),accountsLoadedState:o.None}),h=e(267),S=e(96);function y(t){return t!=Object(S.b)()&&void 0!==g(t)}function A(){return Object(j.__spread)(v().accountsMap.values())}function g(t){return v().accountsMap.get(t)}function T(){var t;return(null===(t=A())||void 0===t?void 0:t.length)>0?A()[0]:null}function m(){return A().filter((function(t){return t.accountState!=r.Valid}))}function _(t){return A().filter((function(n){return t.includes(n.accountState)}))}function I(t){return A().filter((function(n){return n.accountProviderType==t}))}function k(t){return y(t)?g(t).accountProviderType:null}function w(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(h.a)(t.accountProviderType)}function x(t,n){return function(e){var r=g(e);return r?r[t]:n}}x("accountUniqueId","0");var P=x("accountState",r.Valid),C=function(){return A().some((function(t){return!F(t.userIdentity)}))},E=x("accountProviderType",null),M=function(t){return"Outlook"==E(t)},F=function(t){return P(t)==r.Valid},L=function(){return A().length>0};function D(){return v().accountsLoadedState}var N=e(10),z=e(266);Object(c.mutator)(i,(function(t){var n=t.account;Object(z.q)("owaAccountAdded",{accountStatus_1:r[n.accountState]}),v().accountsMap.set(n.userIdentity,n)})),Object(c.mutator)(a,(function(t){var n=t.userIdentity;v().accountsMap.delete(n)})),Object(c.mutator)(s,(function(t){var n=t.userIdentity,e=t.accountToken,r=t.accountTokenExpiresIn,c=v().accountsMap.get(n);c.token=e,c.tokenExpiry=Object(N.j)(Object(N.Pb)(),parseInt(r))})),Object(c.mutator)(d,(function(t){var n=t.userIdentity,e=t.accountState,c=v().accountsMap.get(n);c.accountState==r.Valid&&e!=r.Valid&&Object(z.q)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[e]}),c.accountState=e})),Object(c.mutator)(l,(function(t){var n=t.isSuccess?o.AccountsLoadSuccessful:o.AccountsLoadError;v().accountsLoadedState=n})),Object(c.mutator)(O,(function(t){v().accountsLoadedState=t.state})),e.d(n,"d",(function(){return i})),e.d(n,"u",(function(){return a})),e.d(n,"y",(function(){return s})),e.d(n,"x",(function(){return d})),e.d(n,"c",(function(){return b})),e.d(n,"v",(function(){return f})),e.d(n,"e",(function(){return l})),e.d(n,"w",(function(){return O})),e.d(n,"n",(function(){return A})),e.d(n,"k",(function(){return g})),e.d(n,"i",(function(){return T})),e.d(n,"f",(function(){return m})),e.d(n,"g",(function(){return _})),e.d(n,"o",(function(){return I})),e.d(n,"j",(function(){return k})),e.d(n,"m",(function(){return w})),e.d(n,"l",(function(){return P})),e.d(n,"q",(function(){return C})),e.d(n,"t",(function(){return M})),e.d(n,"s",(function(){return F})),e.d(n,"p",(function(){return L})),e.d(n,"h",(function(){return D})),e.d(n,"r",(function(){return y})),e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return o}))},669:function(t,n,e){"use strict";var r=e(3),c=Object(r.action)("initializeOwaObservableDateTime"),o=Object(r.action)("observableNowChanged"),u=Object(r.action)("observableTodayChanged"),i=e(10),a=e(20),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(a.computed)((function(){return Object(i.lc)(s().now)})),b=function(){return d.get()},f=Object(a.computed)((function(){return Object(i.lc)(s().today)})),l=function(){return f.get()},O=function(t){return Object(i.Gb)(t,b())},j=function(t){return Object(i.Eb)(t,b())},p=function(t){return h(t,i.Gb)},v=function(t){return h(t,i.Hb)},h=function(t,n){return n(Object(i.Wb)(Object(i.lc)(t)),l())};function S(t){if(!t)return"";var n=Object(i.lc)(t);return function(t,n){var e=Object(i.Wb)(t);if(Object(i.Ib)(e,n))return i.Z;var r=function(t){return Object(i.Mb)(e,Object(i.e)(n,-t),n)};if(r(3))return i.hb;if(r(30))return i.gb;return i.X}(n,l())(n)}function y(t){if(!t)return"";var n=Object(i.lc)(t);return function(t,n){var e=Object(i.Wb)(t);if(Object(i.Ib)(e,n))return i.S;return i.T}(n,l())(n)}function A(t){return t?function(t,n){var e=Object(i.Wb)(t);return Object(i.Ib)(e,n)?Object(i.Z)(t):g(e,n,2)?Object(i.kb)(t):g(e,n,7)?Object(i.H)(Object(i.ab)(t),Object(i.Z)(t)):Object(i.H)(Object(i.J)(t),Object(i.Z)(t))}(Object(i.lc)(t),l()):""}function g(t,n,e){return Object(i.Mb)(t,Object(i.e)(n,-e),n)}var T=Object(r.action)("updateTimes"),m=Object(r.action)("setNow"),_=Object(r.action)("setToday",(function(t){return{today:t}}));Object(r.mutator)(m,(function(){s().now=Object(i.jc)()})),Object(r.mutator)(_,(function(t){var n=t.today;s().today=n}));var I=e(34),k=e(127);Object(r.orchestrator)(c,(function(){T();var t=Object(i.Pb)(),n=Object(i.Yb)(Object(i.h)(t,1)),e=Object(i.w)(n,t);setTimeout((function(){return setInterval(T,I.g)}),e)})),Object(r.orchestrator)(k.l,(function(){T()})),Object(r.orchestrator)(T,(function(){m();var t=Object(i.zb)(Object(i.kc)()),n=s().today!=t;n&&_(t),o(),n&&u()})),e.d(n,"d",(function(){return c})),e.d(n,"j",(function(){return o})),e.d(n,"l",(function(){return u})),e.d(n,"i",(function(){return b})),e.d(n,"k",(function(){return l})),e.d(n,"g",(function(){return O})),e.d(n,"e",(function(){return j})),e.d(n,"f",(function(){return p})),e.d(n,"h",(function(){return v})),e.d(n,"a",(function(){return S})),e.d(n,"b",(function(){return y})),e.d(n,"c",(function(){return A}))},732:function(t,n,e){"use strict";function r(t){return t>=200&&t<300}e.d(n,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.MailBoot~SubstrateSuggestions.js.map
self.scriptsLoaded['owa.MailBoot~SubstrateSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SubstrateSuggestions.js'] = (new Date()).getTime();