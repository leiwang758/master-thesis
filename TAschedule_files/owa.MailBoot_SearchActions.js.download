self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SearchActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[728],{1338:function(e,t,r){"use strict";var n={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"},o=0;function a(e){return void 0===e&&(e="id"),""+e+o++}function i(e){return Array.isArray(e)?e.join(" "):e}function c(e){if(!e)return null;for(var t={},r=Object.keys(e),n=0;n<r.length;n++){switch(r[n]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=i(e.controls);break;case"describedBy":t["aria-describedby"]=i(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=i(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=i(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=i(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=i(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=i(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return c}))},1419:function(e,t,r){"use strict";var n=r(0),o=r(20),a=r(3),i=r(2555);function c(e){return Math.floor(Math.random()*e+1)}var u=r(2556);r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return h}));var s=4,l=8,d={toDate:null,fromDate:null,includeAttachments:!1,initialSearchScope:null,isSearchHistoryDirty:!1,isAnswerInitialized:!1,isAnswerLocalizationCompleted:!1,isUnread:!1,previousNode:null,searchNumber:0,staticSearchScope:null,staticSearchScopeList:null,shouldShowAdvancedSearch:!1,shouldShowTimeFilterCallout:!1,advancedSearchViewState:Object(i.a)(),initialAdvancedSearchViewState:Object(i.a)(),legacySuggestions:new o.ObservableMap({}),recipientForPersonalizedGhostTextIndex:c(u.a-1),generalizedGhostTextBankIndex:c(s-1),personalizedGhostTextBankIndex:c(l-1),usePersonalGhostText:!1,isAnswerAvailable:!1},b=Object(n.__assign)({},d),h=Object(a.createStore)("mailSearchStore",b),p=h();t.c=p},1741:function(e,t,r){"use strict";var n=r(74),o=r(2114),a=r(1419),i=r(1537);function c(e){var t=e.tableQuery;return 0===t.type?t.folderId:function(e){if(1!=e.type)return!1;var t=e.searchScope;return["PrimaryMailbox","ArchiveMailbox","SharedFolders"].indexOf(t.kind)>-1}(t)?t.searchScope.folderId:null}var u=r(2060),s=r(2061),l=r(1420);r.d(t,"a",(function(){return b})),r.d(t,"m",(function(){return h})),r.d(t,"c",(function(){return o.b})),r.d(t,"q",(function(){return a.c})),r.d(t,"i",(function(){return a.e})),r.d(t,"f",(function(){return i.a})),r.d(t,"s",(function(){return i.f})),r.d(t,"r",(function(){return i.e})),r.d(t,"g",(function(){return c})),r.d(t,"j",(function(){return u.a})),r.d(t,"h",(function(){return s.a})),r.d(t,"n",(function(){return l.k})),r.d(t,"e",(function(){return l.d})),r.d(t,"d",(function(){return l.c})),r.d(t,"b",(function(){return l.b})),r.d(t,"o",(function(){return l.l})),r.d(t,"p",(function(){return l.n})),r.d(t,"k",(function(){return l.h})),r.d(t,"l",(function(){return l.j}));var d=new n.c((function(){return Promise.all([r.e(3),r.e(5),r.e(6),r.e(7),r.e(8),r.e(11),r.e(13),r.e(15),r.e(17),r.e(18),r.e(21),r.e(22),r.e(25),r.e(24),r.e(27),r.e(29),r.e(31),r.e(33),r.e(34),r.e(42),r.e(43),r.e(48),r.e(49),r.e(47),r.e(844)]).then(r.bind(null,3560))})),b=Object(n.d)(d,(function(e){return e.AnswersContainer})),h=new n.a(d,(function(e){return e.initializeAndWarmupAnswers}))},1924:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"Constant:#Exchange"},e)}},1925:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"FieldURIOrConstantType:#Exchange"},e)}},1926:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"RestrictionType:#Exchange"},e)}},2060:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(77),o=r(2149),a=r(369);function i(){return Object(o.a)()&&(Object(n.i)("sea-fetchPeople2")||Object(n.i)("sea-fetchEvents2")||Object(n.i)("sea-calendarTriggerControl2")||Object(n.i)("sea-fetchFlights2")||Object(n.i)("sea-flightTriggerControl2")||Object(n.i)("sea-fetchFiles4")||Object(n.i)("sea-fileTriggerControl4")||Object(n.i)("sea-peopleTriggerControl2"))||Object(o.a)()&&Object(a.a)()&&(Object(n.i)("sea-fetchBookmarks2")||Object(n.i)("sea-bookmarkTriggerControl2")||Object(n.i)("sea-fetchAcronyms2")||Object(n.i)("sea-fetchLinks2")||Object(n.i)("sea-linkTriggerControl2")||Object(n.i)("sea-acronymTriggerControl2"))}},2061:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(1419),o=r(77),a=r(2149),i=r(96),c=r(1306),u=r(1351);function s(){var e=Object(n.e)().staticSearchScope,t=null==e?void 0:e.kind;if(Object(i.h)().SessionSettings.IsExplicitLogon)return"ArchiveMailbox"===t?2:Object(o.i)("sea-3s-explicitLogon")&&Object(a.a)()?0:1;if("PrimaryMailbox"===t)return Object(a.a)()?0:1;if("ArchiveMailbox"===t){var r=Object(u.a)(e.folderId);return Object(o.i)("sea-archive-mailbox-3S")&&Object(a.a)()&&r==c.d?0:1}return"Group"===t?1:"SharedFolders"===t?2:null}},2114:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return a}));var n=r(1776),o=[n.b.File,n.b.People,n.b.Keywords],a=[n.b.File,n.b.People,n.b.Keywords,n.b.Message,n.b.Event,n.b.Category,n.b.TrySuggestion,n.b.Setting]},2220:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3),o=Object(n.action)("setShowListPane",(function(e){return{showListPane:e}}))},2221:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3),o=Object(n.action)("setShowReadingPane",(function(e){return{showReadingPane:e}}))},2269:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"And:#Exchange"},e)}},2555:function(e,t,r){"use strict";function n(){return{selectedSearchScope:null,subjectFieldText:"",keywordsFieldText:"",fromDate:null,toDate:null,hasAttachments:null,fromPeopleSuggestions:[],toPeopleSuggestions:[],ccPeopleSuggestions:[]}}r.d(t,"a",(function(){return n}))},2556:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=10},2604:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3),o=Object(n.action)("onClientReadingPanePositionChange")},2851:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1468);function o(){return Object(n.a)().showListPane}},2980:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3),o=Object(n.action)("__DIAGNOSTICS_ADD_E2E_TIME_TO_DIAGNOSTICS_STORE",(function(e,t){return{jsEndToEndTime:e,jsRenderingTime:t}}))},3723:function(e,t,r){"use strict";var n=r(2980),o=r(74),a=new o.c((function(){return Promise.all([r.e(3),r.e(11),r.e(14),r.e(37),r.e(48),r.e(53),r.e(108),r.e(127),r.e(731)]).then(r.bind(null,17559))})),i=new o.b(a,(function(e){return e.addSearchRequestInstrumentation})),c=new o.b(a,(function(e){return e.addResourceTimingEntry})),u=new o.b(a,(function(e){return e.searchDiagnostics})),s=function(){var e=u.tryImportForRender(),t=e?e.getIfInitialized():null;return t?t.searchInstrumentationList:[]};r.d(t,"a",(function(){return n.a})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return c}))},400:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return u}));var n=r(0),o=r(14),a=r(342),i=function(){return{position:"absolute",width:1,right:31,top:8,bottom:8}};function c(e){var t,r,a,c,u,s=e.semanticColors,l=e.palette,d=s.buttonBackground,b=s.buttonBackgroundPressed,h=s.buttonBackgroundHovered,p=s.buttonText,f=s.buttonTextHovered,g=s.buttonTextChecked,m=s.buttonTextCheckedHovered;return{root:{backgroundColor:d,color:p},rootHovered:{backgroundColor:h,color:f,selectors:(t={},t[o.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:b,color:g},rootExpanded:{backgroundColor:b,color:g},rootChecked:{backgroundColor:b,color:g},rootCheckedHovered:{backgroundColor:b,color:m},rootDisabled:{selectors:(r={},r[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},r)},splitButtonContainer:{selectors:(a={},a[o.HighContrastSelector]={border:"none"},a)},splitButtonMenuButton:{color:l.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:l.neutralLight,selectors:(c={},c[o.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:s.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:s.buttonBackgroundDisabled}}},splitButtonDivider:Object(n.__assign)(Object(n.__assign)({},i()),{backgroundColor:l.neutralTertiaryAlt,selectors:(u={},u[o.HighContrastSelector]={backgroundColor:"WindowText"},u)}),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:s.buttonText},splitButtonMenuIconDisabled:{color:s.buttonTextDisabled}}}function u(e){var t,r,c,u,s,l,d,b,h,p=e.palette,f=e.semanticColors;return{root:{backgroundColor:f.primaryButtonBackground,border:"1px solid "+f.primaryButtonBackground,color:f.primaryButtonText,selectors:(t={},t[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},t["."+a.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:p.white}}},t)},rootHovered:{backgroundColor:f.primaryButtonBackgroundHovered,border:"1px solid "+f.primaryButtonBackgroundHovered,color:f.primaryButtonTextHovered,selectors:(r={},r[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},r)},rootPressed:{backgroundColor:f.primaryButtonBackgroundPressed,border:"1px solid "+f.primaryButtonBackgroundPressed,color:f.primaryButtonTextPressed,selectors:(c={},c[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},c)},rootExpanded:{backgroundColor:f.primaryButtonBackgroundPressed,color:f.primaryButtonTextPressed},rootChecked:{backgroundColor:f.primaryButtonBackgroundPressed,color:f.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:f.primaryButtonBackgroundPressed,color:f.primaryButtonTextPressed},rootDisabled:{selectors:(u={},u[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},u)},splitButtonContainer:{selectors:(s={},s[o.HighContrastSelector]={border:"none"},s)},splitButtonDivider:Object(n.__assign)(Object(n.__assign)({},i()),{backgroundColor:p.white,selectors:(l={},l[o.HighContrastSelector]={backgroundColor:"Window"},l)}),splitButtonMenuButton:{backgroundColor:f.primaryButtonBackground,color:f.primaryButtonText,selectors:(d={},d[o.HighContrastSelector]={backgroundColor:"WindowText"},d[":hover"]={backgroundColor:f.primaryButtonBackgroundHovered,selectors:(b={},b[o.HighContrastSelector]={color:"Highlight"},b)},d)},splitButtonMenuButtonDisabled:{backgroundColor:f.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:f.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:f.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:f.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:f.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:f.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:f.primaryButtonText},splitButtonMenuIconDisabled:{color:p.neutralTertiary,selectors:(h={},h[o.HighContrastSelector]={color:"GrayText"},h)}}}},443:function(e,t,r){"use strict";var n=r(0);function o(e,t){return e?Object(n.__assign)({mailboxInfo:e},t):null!=t?t:void 0}r.d(t,"a",(function(){return o}))},444:function(e,t,r){"use strict";var n=r(2),o={showOwaBranding:{default:!0,native:!1},includePartnerIn3SRequest:{default:!1,native:!0},loadThemeFromHostApp:{default:!1,opx:!0},opxDeeplink:{default:!1,opx:!0},authRedirectOnSessionTimeout:{default:!0,native:!1,opx:!1},opxComponentLifecycle:{default:!1,opx:!0},surfaceJoin:{default:!1,teams:!0},opxReadingPaneActions:{default:!1,opx:!0},readingPaneModal:{default:!0,teams:!1},readingPaneHeaderTitleAndJoinLink:{default:!0,teams:!1},opxComposeForm:{default:!1,teams:!0},opxServiceWorker:{default:!1,opx:!0},opxStaticUrl:{default:!1,opx:!0},opxAddCalendar:{default:!1,opx:!0},teamsChannelOptions:{default:!1,teams:!0},liveNotifications:{default:!1,macoutlook:!0},teamsCalendarPicker:{default:!1,teams:!0},joinTeamsMeeting:{default:!1,opx:!0},calendarPaneHeaderWeather:{default:!0,teams:!1},use3SPeopleSuggestions:{default:!0,macoutlook:!1},joinButtonInSurfaceEvents:{default:!1,teams:!0},defaultCalendarColor:{default:!1,opx:!0},opxRoomSelection:{default:!1,opx:!0},opxInboxRules:{default:!1,opx:!0},moduleNameFromWindow:{default:!0,opx:!1},showArchiveUnreadCount:{default:!1,native:!0}},a=r(124);r.d(t,"a",(function(){return i}));var i=function(e){var t=function(e){return o[e]}(e);if(t){var r=Object(n.w)();return Object(n.G)()&&n.d in t?t[n.d]:Object(a.d)()&&n.g in t?t[n.g]:r&&r in t?t[r]:!r||r!==n.f&&r!==n.c&&r!==n.b&&r!==n.a&&r!==n.g&&r!==n.e?t.default:t.opx}return!1}},463:function(e,t,r){"use strict";var n=r(0),o=r(1),a=r(394),i=r(461),c=r(460),u=r(14),s=r(234),l=r(395),d=r(428),b=r(400),h=Object(s.c)((function(e,t,r){var n=Object(l.a)(e),o=Object(d.a)(e),a={root:{minWidth:"80px",height:"32px"},label:{fontWeight:u.FontWeights.semibold}};return Object(u.concatStyleSets)(n,a,r?Object(b.a)(e):Object(b.b)(e),o,t)}));r.d(t,"a",(function(){return p}));var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,r=void 0!==t&&t,c=e.styles,u=e.theme;return o.createElement(a.a,Object(n.__assign)({},this.props,{variantClassName:r?"ms-Button--primary":"ms-Button--default",styles:h(u,c,r),onRenderDescription:i.b}))},t=Object(n.__decorate)([Object(c.a)("DefaultButton",["theme","styles"],!0)],t)}(o.Component)},505:function(e,t,r){var n;
/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n))e.push(o.apply(null,n));else if("object"===a)for(var i in n)r.call(n,i)&&n[i]&&e.push(i)}}return e.join(" ")}e.exports?e.exports=o:void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},523:function(e,t,r){"use strict";var n,o=r(0),a=r(1),i=r(729),c=r(56);!function(e){e[e.Full=0]="Full",e[e.Simple=1]="Simple",e[e.None=2]="None"}(n||(n={}));var u=function(e){function t(t){var r=e.call(this,t)||this;return r.state={},r}return Object(o.__extends)(t,e),t.prototype.componentDidCatch=function(e,t){var r,n;null===(n=(r=this.props).onError)||void 0===n||n.call(r,e,t),this.props.suppressErrorReport||(e.component=!0,e.diagnosticInfo=(e.diagnosticInfo||"")+t.componentStack,Object(c.d)(e)),this.setState({error:e})},t.prototype.render=function(){var e=this.state.error,t=this.props,r=t.children,i=t.type,c=t.windowIcons;if(e){if(i==n.None)return null;if(i==n.Simple||!this.props.fullErrorComponent)return a.createElement("div",null,e);var u=this.props.fullErrorComponent;return a.createElement(u,Object(o.__assign)({error:e,windowIcons:c},this.props.fullErrorComponentProps))}return r},t=Object(o.__decorate)([i.observer],t)}(a.Component);r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return n}))},5792:function(e,t,r){"use strict";r.r(t);var n=r(1501),o=r(2249),a=r(281),i=Object(a.select)({tableViews:function(){return n.a.tableViews}})(Object(a.action)("cleanSearchTableState")((function(e,t,r){var n=e.id;t&&t.addCheckmark("cleanSearchTable_s"),o.a.clear(e,null),r.tableViews.delete(n),t&&t.addCheckmark("cleanSearchTable_e")}))),c=r(0),u=r(1707),s=r(1528),l=r(263),d=r(361),b=r(1290),h=r(1741),p=r(7700),f=r(266),g=r(3723),m=r(1486),v=r(1853),S=r(1319),y=r(77);function O(e){switch(e.tableQuery.listViewType){case 0:return"MailConversations";case 1:return"MailItems";default:return null}}var j=r(5900),k=r(2833),C=function(e){var t=[],r=1,n=Object(S.o)(S.e.Mail);if(n.alteredQuery){var o={type:"Group",name:"QueryAlterationSuggestion",position:r,layoutType:"Vertical",resultsView:[{name:"Suggestion",position:1,type:"Entity",entityType:n.queryAlterationType,referenceId:n.suggestedSearchTermReferenceId,providerId:n.alterationProviderId,placementType:"Visible"}]};t.push(o),r++}if(n.isAnswerRendered){var a={type:"Entity",entityType:"AnswerBlock",position:r,placementType:"Visible",placeHolderId:n.answerPlaceholderId,referenceId:"00000000-0000-0000-0000-000000000000",providerId:"00000000-0000-0000-0000-000000000000"};t.push(a),r++}var i=[];return null==e||e.rowKeys.forEach((function(t){var r=Object(k.getInstrumentationContext)(t,e);i.push({type:"Entity",name:"Mail",referenceId:r.referenceKey,providerId:r.traceId,position:r.index+1,entityType:"Email",placementType:"Visible"})})),i.length>0&&t.push({type:"Group",name:"Message",position:r,layoutType:"Vertical",resultsView:i}),t},w=r(3),T=Object(w.action)("FIND_ITEM_SEARCH",(function(e,t,r,n,o){return{offset:e,tableView:t,actionSource:r,onLoadInitialRowsSucceeded:n,onInitialTableLoadComplete:o}})),x=Object(w.action)("SET_HIGHLIGHT_TERMS",(function(e){return{highlightTerms:e}})),I=Object(w.action)("SET_IS_ANSWER_RENDERED",(function(e){return{value:e}})),_=Object(w.action)("SET_TABLE_VIEW_ID",(function(e){return{tableViewId:e}})),B=Object(w.action)("SET_ANSWER_PLACEHOLDER_ID",(function(e){return{placeholderId:e}}));var E=Object(a.action)("onExecuteSearchCompleted")((function(e,t,r,n,o,a,i,u,l){return Object(c.__awaiter)(this,void 0,void 0,(function(){var b,h,g,O,j,k,w;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:switch(o){case"MailConversations":b=r.Conversations;break;case"MailItems":b=r.Items}if(b){for(h=0;h<b.length;h++)(g=b[h]).ReferenceKey=g.InstanceKey,g.InstanceKey=Object(d.a)();Object(s.c)(t,b,(T={pageNumber:e.pageNumber,resultsCount:b.length,rowsInTableCount:t.rowKeys.length},x=T.pageNumber,I=T.resultsCount,B=T.rowsInTableCount+I,7===x?B:I===Object(m.r)(x).resultRowCount?B+1:B),"AppendOnSearch",l,u)}return b?(Object(S.u)()&&Object(y.i)("sea-instv2")&&(_(t.id),0===(O=C(t)).length&&b.length>0&&Object(f.q)("Search_Empty_ResultsView",[b.length],{isCore:!0}),O.length>0&&v.e.importAndExecute(m.a.Mail,null,null,u,l,"Vertical",O,e.pageNumber)),r.SearchTerms&&!t.highlightTerms&&Object(p.a)(t.tableQuery).shouldHighlight&&(t.highlightTerms=Object(S.n)(r)),t.currentLoadedIndex=t.rowKeys.length,0==e.pageNumber&&(t.tableQuery.lastIndexFetched=t.rowKeys.length-1),j=t.tableQuery.searchScope,k=j?j.kind:null,(w=Object(m.q)(e,r,k))?[4,R(w,t,null,null,o,a,u,i,n)]:[3,2]):[2];case 1:c.sent(),c.label=2;case 2:return[2]}var T,x,I,B}))}))})),R=Object(a.action)("performExecuteSearch")((function(e,t,r,n,o,a,i,u,s){return void 0===s&&(s=0),Object(c.__awaiter)(this,void 0,void 0,(function(){var d,p,O,j,k,C,w,T;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:switch(d=Object(h.i)(),p=t.tableQuery,O="ExecuteSearch",j=0==Object(h.h)()&&1==p.searchProvider?1:Object(h.h)()){case 0:O="SubstrateSearch";break;case 1:default:O="ExecuteSearch"}return k=Object(y.i)("sea-hybridSearchSupported")||1!==j?null:"DateTime",C=Object(S.I)(S.e.Mail)||"persona"===p.scenarioType||void 0!==p.viewFilter&&"All"!==p.viewFilter,w={},0!=j||"ArchiveMailbox"!=p.searchScope.kind?[3,2]:[4,P("https://outlook.office.com"==window.location.origin?"https://outlook.office365.com":"https://outlook.office.com")];case 1:T=c.sent(),w.Authorization="Bearer "+T,c.label=2;case 2:return[2,Object(m.m)(e,p.queryString,a,i,p.searchScope,d.searchNumber,o,n,u,O,m.a.Mail,s,p.includeAttachments,p.fromDate,p.toDate,null,null,k,C,Object(S.t)(S.e.Mail),w).then((function(c){var h;if(!c)return n&&n.endWithError("ServerError",Error("Unexpected client-side error")),void r(t,!1,"UnexpectedClientError",!1);var p=c[1];g.d.import().then((function(e){return e(p)}));var j=p.ClientHttpStatus,k=200==j&&null!=(null===(h=c[0])||void 0===h?void 0:h.SearchResults),C=0==e.pageNumber,w=f.j.importAndExecute(c[2]);if(w.then((function(e){setTimeout((function(){g.c.import().then((function(t){if(t(e,p,n),Object(y.i)("sea-instv2")&&C){var r=p.ClientJSEndToEndTime+p.ClientJSRenderingTime;k&&v.m.importAndExecute(m.a.Mail,p.SearchQueryId,p.SearchTraceID,r)}}))}),0)})),Object(b.w)()&&t.tableQuery.searchNumber==d.searchNumber){var T;if(Object(S.u)()&&(w.then((function(e){var t=e?e.RpE:p.ClientNetworkTime;Object(y.i)("sea-instv2")&&v.k.importAndExecute(m.a.Mail,p.SearchTraceID,t,p.ClientHttpStatus),v.j.importAndExecute(p.SearchTraceID,t,p.ClientHttpStatus,new Date),k?v.l.importAndExecute(p.SearchTraceID,new Date,m.a.Mail):v.i.importAndExecute(p.SearchTraceID,m.a.Mail)})),Object(S.R)(p.SearchTraceID,S.e.Mail,!1)),C&&(T=new f.b("TnS_SearchClientTime")).addCustomData([k,o]),k){var x=c[0],I=x.querySuggestionData;if(I&&C){var _=I.flaggedTokens&&I.flaggedTokens.map((function(e){return{Length:e.Length,Offset:e.Offset||0,Suggestion:e.Suggestion}}));S.E.importAndExecute(I.alteredQuery,I.suggestedSearchTerm,I.suggestedSearchTermReferenceId,_,I.recourseQuery,S.e.Mail,I.queryAlterationType,p.SearchTraceID,p.SearchQueryId)}E(e,t,x.SearchResults,s,o,a,u,i,p.SearchTraceID)}if(C){if(!r)throw new Error("onInitialTableLoadComplete callback should always be set when page number is 0");n&&k&&n.addCustomData({resultCount:c[0].SearchResults.SearchResultsCount}),r(t,k,j.toString(),!1),function(e,t,r){t.ClientResponseProcessTime=e.addCheckmark("ProcessResponseTime"),r&&(t.ClientJSEndToEndTime=r.addCheckmark("ClientJSEndToEndTime")),requestAnimationFrame((function(){return Promise.resolve().then((function(){e.end(),r&&(t.ClientJSRenderingTime=r.getData(l.a.e2eTimeElapsed)-r.waterfallTimings.ClientJSEndToEndTime)}))}))}(T,p,n)}k||(n&&n.endWithError("ServerError",Error(c[1].SearchErrorContent)),"SubstrateSearch"===O&&Object(y.i)("sea-autoFallback")&&C&&(Object(S.U)("SearchErrorFallback",S.e.Mail,!0,[],1),Object(f.q)("SearchFallback",{TraceId:p.SearchTraceID,ResponseCode:j,BETarget:p.SearchBETarget})))}}))]}}))}))}));function D(e,t,r,n,o,a,i){u.b();var c=O(e);return c?R(Object(m.r)(0),e,t,r,c,n,o,i,a):Promise.resolve()}function M(e,t,r,n,o){return void 0===o&&(o=0),Object(c.__awaiter)(this,void 0,void 0,(function(){var a;return Object(c.__generator)(this,(function(i){return a=Object(S.o)(S.e.Mail),Object(S.j)(S.e.Mail),[2,D(e,t,r,a.searchSessionGuid,a.currentSearchQueryId,o,n)]}))}))}function A(e,t,r,n,o){return void 0===o&&(o=0),Object(c.__awaiter)(this,void 0,void 0,(function(){var a,i;return Object(c.__generator)(this,(function(c){return a=Object(h.i)(),i=e.tableQuery,a.searchNumber++,i.searchNumber=a.searchNumber,a.staticSearchScope=i.searchScope,[2,D(e,t,r,Object(d.a)(),Object(d.a)(),o,n)]}))}))}function P(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){return Object(c.__generator)(this,(function(t){switch(t.label){case 0:return[4,j.a.importAndExecute(e)];case 1:return[2,t.sent()]}}))}))}var H=r(1301),F=r(30),N=r(1318),L=r(1378),V=r(1586);function Q(){return Object(V.s)()?5:3}var q=Object(a.select)({folderForestStore:function(){return L.a}})(Object(a.action)("loadSearchTable")((function(e,t,r,n,o,a){return Object(c.__awaiter)(this,void 0,void 0,(function(){var i,u,s,l,d,b,p;return Object(c.__generator)(this,(function(f){if(1!=e.tableQuery.type)throw new Error("loadSearchTable should only be called for search table types");return i=a.folderForestStore.selectedNode,(u=Object(h.i)()).previousNode||(3==i.type?(s=Object(H.a)("inbox"),l=Object(N.isFolderInFavorites)(s)?"favorites":"primaryFolderTree",u.previousNode={id:s,treeType:l,type:0}):u.previousNode=Object(c.__assign)({},i)),d=e.tableQuery,b=d.scenarioType,p="persona"===b||"category"===b||"privateDistributionList"===b,3==i.type||p||(a.folderForestStore.selectedNode.id=null),"messageSuggestion"===b?(t(e,!0,"",!0),[2,Promise.resolve()]):"SharedFolders"===d.searchScope.kind||"ArchiveMailbox"===d.searchScope.kind&&Object(F.a)().SessionSettings.IsExplicitLogon||"PublicFolder"===d.searchScope.kind?(T(0,e,n,r,t),[2,Promise.resolve()]):p?[2,A(e,t,o,n,Q())]:[2,M(e,t,o,n,Q())]}))}))}))),W=Object(w.action)("LOAD_MORE_FIND_ITEM_SEARCH",(function(e,t,r,n,o){return{offset:e,tableView:t,actionSource:r,onLoadMoreRowsSucceeded:n,onLoadMoreRowsFailed:o}})),G=Object(w.action)("loadMoreSubstrateSearch",(function(e,t,r,n,o){return{offset:e,tableView:t,actionSource:r,onLoadMoreRowsSucceeded:n,onLoadMoreRowsFailed:o}})),z=r(805),K=r(804),U=r(317),J=r(629);var $=r(554);function X(e,t,r,n,o,a,i,u,s){var l=function(e,t,r,n,o,a,i,u){return Object(z.a)({ParentFolderIds:[Object($.a)({Id:e})],ItemShape:Object(J.a)({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:i,Paging:r,FocusedViewFilter:a,ViewFilter:n,SortOrder:o,IsWarmUpSearch:!1,QueryString:(s=t,Object(c.__assign)({__type:"QueryStringType:#Exchange"},s)),RefinerRestriction:u,SearchFolderIdentity:Object(d.a)()});var s}(e,t,r,n,o,a,u,s);return Object(K.a)({Header:Object(U.b)(),Body:l},i).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var Y=r(56),Z=r(1438),ee=r(1479),te=r(1308),re=r(1834),ne=r(443),oe=50;function ae(e,t){var r=e.tableQuery,n=e.tableQuery,o={Value:n.queryString,MaxResultsCount:oe,ResetCache:!0,ReturnDeletedItems:!0,ReturnHighlightTerms:!0,WaitForSearchComplete:!0},a=Object(ee.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:oe}),i=Object(Z.d)(r),c=Object(ne.a)(i),u=[];return u.push(Object(re.a)({Order:"Descending",Path:Object(te.a)({FieldURI:"DateTimeReceived"})})),{queryStringData:o,paging:a,requestInit:c,sortByResults:u,folderId:n.searchScope.folderId,refinerRestriction:Object(m.t)(n.fromDate,n.toDate,null,null)}}Object(w.orchestrator)(T,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,r,n,o,a,i,u,s,l,d,f,g,m,v;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:t=e.tableView,r=e.onInitialTableLoadComplete,n=e.onLoadInitialRowsSucceeded,o=e.offset,a=ae(t,o),i=a.queryStringData,u=a.paging,s=a.requestInit,l=a.sortByResults,d=a.folderId,f=a.refinerRestriction,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,X(d,i,u,"All",l,-1,s,"Shallow",f)];case 2:return g=c.sent(),[3,4];case 3:return m=c.sent(),Y.d("Find item search call failed "+m),[2,Promise.resolve(null)];case 4:return g&&(Object(b.w)()&&t.tableQuery.searchNumber===h.q.searchNumber)?((v="Success"===g.ResponseClass)&&(n(t,g.RootFolder.Items,g.RootFolder.TotalItemsInView,g.SearchFolderId,null),g.HighlightTerms&&!t.highlightTerms&&Object(p.a)(t.tableQuery).shouldHighlight&&x(g.HighlightTerms.map((function(e){return e.Value})))),r(t,v,g.ResponseCode,!1),[2]):[2]}}))}))})),Object(w.orchestrator)(W,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,r,n,o,a,i,u,l,d,p,f,g,m;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:t=e.tableView,r=e.onLoadMoreRowsSucceeded,n=e.onLoadMoreRowsFailed,o=e.offset,a=ae(t,o),i=a.queryStringData,u=a.paging,l=a.requestInit,d=a.sortByResults,p=a.folderId,f=a.refinerRestriction,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,X(p,i,u,"All",d,-1,l,"Shallow",f)];case 2:return g=c.sent(),[3,4];case 3:return m=c.sent(),Y.d("Load more Find item search call failed "+m),[2,Promise.resolve(null)];case 4:return g&&(Object(b.w)()&&t.tableQuery.searchNumber===h.q.searchNumber)?("Success"===g.ResponseClass?r(t,g.RootFolder.Items,g.RootFolder.TotalItemsInView,s.b):n(t,g.ResponseCode),[2]):[2]}}))}))})),Object(w.orchestrator)(G,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,r,n,o,a,i,u;return Object(c.__generator)(this,(function(c){return t=e.offset,r=e.tableView,n=e.actionSource,o=Object(S.o)(S.e.Mail),a=o.searchSessionGuid,i=o.currentSearchQueryId,(u=Object(m.s)(t))?(R(u,r,null,null,O(r),a,i,n,3),[2]):[2]}))}))})),Object(w.orchestrator)(h.r,(function(e){I(!0),function(){if(Object(y.i)("sea-instv2")){var e=Object(S.o)(S.e.Mail),t=e.currentSearchQueryId,r=e.tableViewId,n=b.X.tableViews.get(r),o=C(n);v.e.importAndExecute(m.a.Mail,null,null,t,t,"Vertical",o)}}(),Object(f.q)("Search_Answers_AnswerRendered")}));Object(w.mutator)(x,(function(e){var t=Object(b.G)();t&&(t.highlightTerms=e.highlightTerms)})),Object(w.mutator)(I,(function(e){Object(S.o)(S.e.Mail).isAnswerRendered=e.value})),Object(w.mutator)(B,(function(e){Object(S.o)(S.e.Mail).answerPlaceholderId=e.placeholderId})),Object(w.mutator)(_,(function(e){Object(S.o)(S.e.Mail).tableViewId=e.tableViewId})),r.d(t,"cleanSearchTableState",(function(){return i})),r.d(t,"executeSearch",(function(){return M})),r.d(t,"loadSearchTable",(function(){return q})),r.d(t,"loadMoreFindItemSearch",(function(){return W})),r.d(t,"loadMoreSubstrateSearch",(function(){return G}))},5900:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(74),o=new n.c((function(){return r.e(942).then(r.bind(null,8063))})),a=new n.a(o,(function(e){return e.getAccessTokenforResource}))},674:function(e,t,r){"use strict";var n=r(0),o=r(1),a=r(394),i=r(461),c=r(460),u=r(14),s=r(234),l=r(395),d=r(428),b=Object(s.c)((function(e,t){var r,n=Object(l.a)(e),o=Object(d.a)(e),a=e.palette,i={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",color:e.semanticColors.link},rootHovered:{color:a.themeDarkAlt,backgroundColor:a.neutralLighter,selectors:(r={},r[u.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},r)},rootHasMenu:{width:"auto"},rootPressed:{color:a.themeDark,backgroundColor:a.neutralLight},rootExpanded:{color:a.themeDark,backgroundColor:a.neutralLight},rootChecked:{color:a.themeDark,backgroundColor:a.neutralLight},rootCheckedHovered:{color:a.themeDark,backgroundColor:a.neutralQuaternaryAlt},rootDisabled:{color:a.neutralTertiaryAlt}};return Object(u.concatStyleSets)(n,i,o,t)}));r.d(t,"a",(function(){return h}));var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,r=e.theme;return o.createElement(a.a,Object(n.__assign)({},this.props,{variantClassName:"ms-Button--icon",styles:b(r,t),onRenderText:i.b,onRenderDescription:i.b}))},t=Object(n.__decorate)([Object(c.a)("IconButton",["theme","styles"],!0)],t)}(o.Component)},7700:function(e,t,r){"use strict";var n=r(267);function o(e){switch(e.type){case 1:return function(e){switch(e.scenarioType){case"mail":case"messageSuggestion":return{shouldHighlight:!0,headerGeneratorType:"RelevanceHybrid"};case"persona":case"privateDistributionList":case"category":return{shouldHighlight:!1,headerGeneratorType:"DateTime"};default:return Object(n.a)(e.scenarioType)}}(e);case 0:case 2:return function(e){var t;switch(0==e.type&&e.sortBy.sortColumn){case 3:t="Sender";break;case 7:t="Size";break;case 5:t="Importance";break;case 8:t="Subject";break;case 1:default:t="DateTime"}return{shouldHighlight:!0,headerGeneratorType:t}}(e);default:return Object(n.a)(e.type)}}r.d(t,"a",(function(){return o}))}}]);
//# sourceMappingURL=owa.MailBoot~SearchActions.js.map
self.scriptsLoaded['owa.MailBoot~SearchActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SearchActions.js'] = (new Date()).getTime();