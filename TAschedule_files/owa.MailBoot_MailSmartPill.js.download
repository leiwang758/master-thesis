self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailSmartPill.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[646],{10655:function(t){t.exports=JSON.parse('{"a":"_kc","b":"$kc","c":"alc"}')},10656:function(t){t.exports=JSON.parse('{"d":"glc","e":"hlc","c":"ilc","a":"jlc","b":"klc"}')},1507:function(t,e,n){"use strict";var r=n(3),o=n(20),i=n(1624),a={providers:new o.ObservableMap,loadState:i.a.NotLoaded,removalPending:new o.ObservableMap},c=Object(r.createStore)("fileProviderStore",a);e.a=c},1508:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return a}));var r=n(3),o=Object(r.action)("FILE_PROVIDER_ADDED",(function(t){return{providerViewState:t}})),i=Object(r.action)("FILE_PROVIDER_REMOVED",(function(t){return{providerType:t}})),a=Object(r.action)("PROVIDERS_LOADED",(function(t){return{providers:t}}))},15445:function(t){t.exports=JSON.parse('{"b":"blc","c":"clc","a":"dlc"}')},15446:function(t,e,n){var r=n(15447),o=n(130);"string"==typeof r&&(r=[[t.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(t.exports=r.locals)},15447:function(t,e,n){(e=t.exports=n(129)(!1)).push([t.i,'._3Jtu3QV20_qLz8g_h0KpQb{position:relative;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;color:inherit;width:100%;height:48px;line-height:32px;display:block;cursor:pointer;outline:transparent}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb{background-color:transparent;padding-top:0;padding-bottom:0;border-width:initial;border-style:none;border-color:initial;-o-border-image:initial;border-image:initial}html[dir=ltr] ._3Jtu3QV20_qLz8g_h0KpQb{padding-right:12px;padding-left:12px;text-align:left}html[dir=rtl] ._3Jtu3QV20_qLz8g_h0KpQb{padding-left:12px;padding-right:12px;text-align:right}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb:active{background-color:"[theme:neutralLight, default:#eaeaea]"}._1v60Zw1heoE7AYHV2rZARo{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}.Nf0DroQfbZfcaaSjQ53MC{display:inline-block;color:"[theme:themePrimary, default:#0078D4]";height:32px;width:32px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}html[dir=ltr] .Nf0DroQfbZfcaaSjQ53MC{margin-right:8px}html[dir=rtl] .Nf0DroQfbZfcaaSjQ53MC{margin-left:8px}._1V-pZ1TukzFi3FL2_U4Y5X{max-width:216px;width:100%;height:100%}._3TAbxFid2sTMSQ8v8sIeQH{font-size:14px;color:"[theme:neutralPrimary, default:#333333]";line-height:19px;max-width:100%}._3TAbxFid2sTMSQ8v8sIeQH,._1XRoVhbyaxndQhy7cIo11E{font-weight:400;display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}._1XRoVhbyaxndQhy7cIo11E{font-size:11px;color:"[theme:neutralSecondary, default:#666666]";line-height:15px;width:216px}html[dir] ._1XRoVhbyaxndQhy7cIo11E{padding-top:1px}._1LIdXVeATDTlAL3Wafn6_V{position:absolute;top:20px}html[dir=ltr] ._1LIdXVeATDTlAL3Wafn6_V{left:24px}html[dir=rtl] ._1LIdXVeATDTlAL3Wafn6_V{right:24px}html[dir] ._16x5oaOekVnuCtNTMKxz1I{margin:0}',""]),e.locals={attachmentSuggestionButton:"_3Jtu3QV20_qLz8g_h0KpQb",attachmentSuggestionButtonContent:"_1v60Zw1heoE7AYHV2rZARo",attachmentSuggestionButtonImageContainer:"Nf0DroQfbZfcaaSjQ53MC",attachmentSuggestionButtonTextContainer:"_1V-pZ1TukzFi3FL2_U4Y5X",attachmentSuggestionPrimaryText:"_3TAbxFid2sTMSQ8v8sIeQH",attachmentSuggestionSecondaryText:"_1XRoVhbyaxndQhy7cIo11E",fileIcon:"_1LIdXVeATDTlAL3Wafn6_V",cloudyIcon:"_16x5oaOekVnuCtNTMKxz1I"}},15448:function(t,e,n){var r=n(15449),o=n(130);"string"==typeof r&&(r=[[t.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(t.exports=r.locals)},15449:function(t,e,n){(e=t.exports=n(129)(!1)).push([t.i,'._10Wqk-jLsMonGEHBVbj5cP{position:relative;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;color:inherit;width:100%;height:48px;line-height:32px;display:block;cursor:pointer;outline:transparent}html[dir] ._10Wqk-jLsMonGEHBVbj5cP{background-color:transparent;padding-top:0;padding-bottom:0;border-width:initial;border-style:none;border-color:initial;-o-border-image:initial;border-image:initial}html[dir=ltr] ._10Wqk-jLsMonGEHBVbj5cP{padding-right:12px;padding-left:12px;text-align:left}html[dir=rtl] ._10Wqk-jLsMonGEHBVbj5cP{padding-left:12px;padding-right:12px;text-align:right}html[dir] ._10Wqk-jLsMonGEHBVbj5cP:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._10Wqk-jLsMonGEHBVbj5cP:active{background-color:"[theme:neutralLight, default:#eaeaea]"}._3JeDFTJ3xdeMl09fLnBdDf{width:280px}._2BZ4VACg11pKrXUPK6KPZI{font-size:12px;font-weight:400;font-weight:600;color:"[theme:themePrimary, default:#0078D4]";max-width:280px}html[dir=ltr] ._2BZ4VACg11pKrXUPK6KPZI{margin-left:1px}html[dir=rtl] ._2BZ4VACg11pKrXUPK6KPZI{margin-right:1px}._1-XgaiCZX8v0t7SQi_ioKl{font-size:16px;height:16px;line-height:31px;width:16px;color:"[theme:neutralSecondary, default:#666666]"!important}html[dir=ltr] ._1-XgaiCZX8v0t7SQi_ioKl{margin-left:16px;margin-right:12px}html[dir=rtl] ._1-XgaiCZX8v0t7SQi_ioKl{margin-right:16px;margin-left:12px}html[dir] ._2JVEtFeqc7Qfi1U140m4t1{padding-bottom:16px}html[dir] ._2vktARVhhq-4yqVPWNwm4Q{padding-bottom:14px}html[dir] ._3OS-O1SA6lAPPKXCdnExMV{padding-bottom:16px}html[dir] ._1r7Jlygmjk0ZDdxQRHy9ZR{margin-bottom:3px;margin-top:3px}html[dir=ltr] ._1r7Jlygmjk0ZDdxQRHy9ZR{margin-right:10px}html[dir=rtl] ._1r7Jlygmjk0ZDdxQRHy9ZR{margin-left:10px}',""]),e.locals={attachmentSuggestionButton:"_10Wqk-jLsMonGEHBVbj5cP",attachmentSuggestionButtonRoot:"_3JeDFTJ3xdeMl09fLnBdDf",replyWithHeaderForBottomBar:"_2BZ4VACg11pKrXUPK6KPZI",iconRoot:"_1-XgaiCZX8v0t7SQi_ioKl",iconRootComputer:"_2JVEtFeqc7Qfi1U140m4t1",iconRootCloud:"_2vktARVhhq-4yqVPWNwm4Q",iconRootUploadAndShare:"_3OS-O1SA6lAPPKXCdnExMV",loadingSpinner:"_1r7Jlygmjk0ZDdxQRHy9ZR"}},15450:function(t){t.exports=JSON.parse('{"a":"elc","b":"flc"}')},15451:function(t,e,n){var r=n(15452),o=n(130);"string"==typeof r&&(r=[[t.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(t.exports=r.locals)},15452:function(t,e,n){(e=t.exports=n(129)(!1)).push([t.i,"._3YAl0KkiE16JbPH0r6SRWf{font-size:12px}",""]),e.locals={menuButton:"_3YAl0KkiE16JbPH0r6SRWf"}},15453:function(t){t.exports=JSON.parse('{"f":"Gkc","t":"Hkc","n":"Ikc","g":"Jkc","h":"Kkc","i":"Lkc","j":"Mkc","k":"Nkc","l":"Okc","m":"Pkc","o":"Qkc","p":"Rkc","q":"Skc","r":"Tkc","s":"Ukc","a":"Vkc","b":"Wkc","c":"Xkc","d":"Ykc","e":"Zkc"}')},15454:function(t,e,n){var r=n(15455),o=n(130);"string"==typeof r&&(r=[[t.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(t.exports=r.locals)},15455:function(t,e,n){(e=t.exports=n(129)(!1)).push([t.i,"html[dir] ._1BIi6rH1j5rnLh1OlF1NvI{padding-top:10px}html[dir=ltr] ._1BIi6rH1j5rnLh1OlF1NvI{margin-left:52px}html[dir=rtl] ._1BIi6rH1j5rnLh1OlF1NvI{margin-right:52px}",""]),e.locals={bar:"_1BIi6rH1j5rnLh1OlF1NvI"}},1547:function(t,e,n){"use strict";n.d(e,"l",(function(){return g})),n.d(e,"n",(function(){return f})),n.d(e,"k",(function(){return b})),n.d(e,"m",(function(){return p}));var r=n(74),o=n(1782);n.d(e,"b",(function(){return o.a}));var i=n(1728);n.d(e,"i",(function(){return i.a}));n(1507);var a=n(1508);n.d(e,"d",(function(){return a.a})),n.d(e,"e",(function(){return a.b})),n.d(e,"o",(function(){return a.c}));var c=n(1729);n.d(e,"a",(function(){return c.b}));var u=n(1585);n.d(e,"g",(function(){return u.a})),n.d(e,"h",(function(){return u.b}));var l=n(1720);n.d(e,"j",(function(){return l.a}));var s=n(1624);n.d(e,"c",(function(){return s.a}));var d=n(1715);n.d(e,"f",(function(){return d.b}));var m=new r.c((function(){return Promise.all([n.e(3),n.e(561)]).then(n.bind(null,3101))})),g=new r.b(m,(function(t){return t.loadProviders})),f=new r.b(m,(function(t){return t.removeFileProvider})),b=new r.b(m,(function(t){return t.addFileProvider})),p=new r.b(m,(function(t){return t.removeAndAddFileProvider}))},1585:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a}));var r=n(0),o=n(1507),i=function(){return Object(r.__spread)(Object(o.a)().providers.values())},a=function(t){return Object(o.a)().providers.get(t)||null}},1624:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Loaded=0]="Loaded",t[t.Loading=1]="Loading",t[t.NotLoaded=2]="NotLoaded",t[t.Throttled=3]="Throttled"}(r||(r={}))},17136:function(t,e,n){"use strict";n.r(e);var r=n(3),o=Object(r.action)("setSmartPillBlockVisibility",(function(t,e){return{viewState:t,smartPillBlockVisible:e}})),i=Object(r.action)("setSmartPillFeedbackSubmitted",(function(t,e){return{item:t,smartPillFeedbackSubmitted:e}})),a=(Object(r.mutator)(o,(function(t){t.viewState.smartPillBlockVisible=t.smartPillBlockVisible})),Object(r.mutator)(i,(function(t){t.item.smartPillFeedbackSubmitted=t.smartPillFeedbackSubmitted})),Object(r.action)("updateItemLanguageAction",(function(t){return{item:t}}))),c=n(56),u=n(5735);function l(t){var e=function(t){var e=t.ExtendedProperty;if(e){var n=e.filter((function(t){return t.ExtendedFieldURI.PropertyName===u.a}));if(n.length>0)return n[0]}return null}(t),n=void 0,r=void 0,o=0,i=void 0;try{if(e){var a=JSON.parse(e.Value)[0],l=a[u.c],s=a[u.d];i=a[u.b],r=Object.keys(s)[0],n=(null==l?void 0:l[u.e])&&l[u.e].toLowerCase(),o=parseInt(Object.values(s)[0])}}catch(t){c.g.info("[getStampedLanguage] Failed to parse property, error: "+t.message)}return{locale:n,language:r,confidenceScore:o,entityId:i}}Object(r.mutator)(a,(function(t){var e=t.item;e.stampedLanguage=l(e)}));var s=n(0),d=n(47),m=n(749),g=n(77);function f(t){var e=t.featureName;return"SmartReply"===e?Object(g.i)("mc-smartReply"):"SmartTime"===e?Object(g.i)("mc-smartReplyWithCustomMeeting"):"SmartDoc"===e?Object(g.i)("mc-smartReplyWithDoc"):(c.g.info("[isPillTypeEnabled] Unknown pill type: "+e),!1)}function b(t){if(t){if("SmartDoc"===t.featureName)return!0;null==t.confidenceScore&&c.g.info("[isConfidenceScoreAcceptable] confidence score is null. Feature: "+t.featureName+" EntityId: "+t.logData.mainPayload.EID);var e=t.confidenceScore;if(e>0){if(Object(g.i)("mc-smartPillConfidenceLevel_LOW"))return!0;if(Object(g.i)("mc-smartPillConfidenceLevel_MID"))switch(t.featureName){case"SmartTime":return e>=70;default:return!0}else switch(t.featureName){case"SmartTime":return e>=90;default:return!0}}}return!1}function p(){var t=Object(g.i)("mc-smartReplyWithTextPositionThird");return[{aggregation:{SmartReply:2,SmartTime:1},arrangement:t?["SmartTime","SmartReply"]:["SmartReply","SmartTime"]},{aggregation:{SmartTime:1},arrangement:["SmartTime"]},{aggregation:{SmartReply:2,SmartDoc:1},arrangement:t?["SmartDoc","SmartReply"]:["SmartReply","SmartDoc"]},{aggregation:{SmartDoc:1},arrangement:["SmartDoc"]},{aggregation:{SmartReply:3},arrangement:["SmartReply"]}]}function h(t){if(t)for(var e=function(t){var e,n,r={};try{for(var o=Object(s.__values)(t),i=o.next();!i.done;i=o.next()){var a=i.value;r[a.featureName]=void 0===r[a.featureName]?1:r[a.featureName]+1}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}(t),n=p(),r=0;r<n.length;r++){for(var o=!0,i=n[r],a=0;a<i.arrangement.length;a++){if(i.aggregation[i.arrangement[a]]>(void 0===e[i.arrangement[a]]?0:e[i.arrangement[a]])){o=!1;break}}if(o)return i}return null}var S={selectPills:function(t){return function(t,e){var n=[];return e&&t.length>0&&e.arrangement.forEach((function(r){n.push.apply(n,Object(s.__spread)(function(t,e,n){return t.filter((function(t){return t.featureName===e})).slice(0,n)}(t,r,e.aggregation[r])))})),n}(t,h(t))}};function v(t,e,n,r){var o=[];return t.forEach((function(t){n(t)?o.push(t):(t.logData.mainPayload.renderStory|=r,e.push(t))})),o}var O={arbitratePills:function(t){var e=[],n=[];if(t){var r=v(t,n,f,1),o=v(r,n,b,4);if(o.length>0){var i=S;e.push.apply(e,Object(s.__spread)(i.selectPills(o)));for(var a=function(t){var r=o[t];e.some((function(t){return t===r}))||(r.logData.mainPayload.renderStory|=2,n.push(r))},c=0;c<o.length;c++)a(c)}}return{pillsToShow:e,pillsToHide:n,arbitratorId:"complexArbitrator"}}};var y=Object(r.action)("createMessageWithAttachmentAction",(function(t,e,n){return{item:t,attachment:e,option:n}})),j=n(1434),P=n(1547);function k(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return n=null,Object(P.j)()!==P.c.NotLoaded?[3,2]:[4,P.l.import()];case 1:return r.sent()((function(r){n=I(Object(P.h)(),t),e(n)})),[3,3];case 2:n=I(Object(P.h)(),t),e(n),r.label=3;case 3:return[2]}}))}))}function I(t,e){var n=function(t){for(var e=0;e<t.length;e++)if(0===t[e].type)return t[e].model.Id;return c.g.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(t);return{fileType:j.a.CloudSuggestion,name:e.FileName,size:null,providerId:n,providerType:0,location:e.Url,providerEndpointUrl:null,isFolder:!1,fileId:e.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}var x=n(2210),C=n(1502);function _(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return(n=Object(x.a)(t.ConversationId.Id))?[3,3]:[4,C.p.import()];case 1:return[4,r.sent()({referenceItemOrId:t,isReplyAll:!0,useFullCompose:!1,instrumentationContexts:null,conversationId:t.ConversationId.Id,body:null,smartDocOption:e})];case 2:n=r.sent(),r.label=3;case 3:return[2,n]}}))}))}var w=n(3220),T=n(266);Object(r.orchestrator)(y,(function(t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,n,r,o,i=this;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return e=t.item,n=t.attachment,r=t.option,n?[3,2]:[4,_(e,r)];case 1:return a.sent(),[3,5];case 2:return a.trys.push([2,4,,5]),[4,k(n,(function(t){return Object(s.__awaiter)(i,void 0,void 0,(function(){return Object(s.__generator)(this,(function(n){return function(t,e,n){Object(s.__awaiter)(this,void 0,void 0,(function(){var r;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return e?[4,_(t,n)]:[3,3];case 1:return r=o.sent(),[4,C.c.import()];case 2:o.sent()([e],r,{isInline:!1,isHiddenInline:!1,shouldShare:!0,isAddedFromSmartDoc:!0},(function(){return function(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(n){return Object(T.q)("SmartDocAttachmentsAdded",{smartDocExtractionId:t.SmartDocData.EntityId},{isCore:!0,isCosmosDatapoint:!0}),e.smartPillViewState.smartDocOption=w.a.None,[2]}))}))}(t,r)}),null,null,null),o.label=3;case 3:return[2]}}))}))}(e,t,r),[2]}))}))}))];case 3:return a.sent(),[3,5];case 4:return o=a.sent(),c.d("[createMessageWithAttachmentOrchestrator] Error when creating cloud file: "+o.message),[3,5];case 5:return[2]}}))}))}));var E=Object(r.action)("cacheSmartDocDataAction",(function(t,e,n){return{item:t,validPropertyExists:e,entityId:n}})),R=(Object(r.mutator)(E,(function(t){var e={EntityId:void 0},n=t.item,r=t.validPropertyExists,o=t.entityId;r&&(e.EntityId=o),n.SmartDocData=e})),n(1)),D=n(2637);var F=n(472),A=n(2202),M=n(3716),N=Object(r.createStore)("smartDocStatusAndSuggestionStore",{status:0,suggestions:[]}),B=N,L=Object(r.mutatorAction)("SET_SMART_DOC_SUGGESTION_STATUS",(function(t){N().status=t})),U=Object(r.mutatorAction)("SET_SMART_DOC_SUGGESTIONS",(function(t,e){N().suggestions=t,N().status=e})),V="application/json;charset=utf-8",H="/search/api/v1/recommendations";function G(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,a,u,l,d;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:n=null,r="",L(1),s.label=1;case 1:return s.trys.push([1,7,8,9]),[4,W()];case 2:return o=s.sent(),i=function(t,e){var n={};n.headers=new Headers,n.headers.set("Authorization","Bearer "+t),n.headers.set("Content-Type",V),n.method="POST";var r=Object(A.b)();r&&n.headers.append("X-AnchorMailbox",r);n.headers.set("X-Client-LocalTime",(new Date).toISOString());var o=[];o.length&&n.headers.set("X-Client-Flights",o.join(","));var i=Object(g.i)("mc-smartReplyWithDoc-SmartAttachments"),a={EntityRequests:[e?{Context:{EntityId:e}}:{}],Scenario:{Name:i?"SmartAttachments":"AttachFile"}};return n.body=JSON.stringify(a),n}(o,t),[4,fetch(H,i)];case 3:return(a=s.sent())&&200==a.status?[4,a.text()]:[3,5];case 4:return u=s.sent(),l=JSON.parse(u),n=function(t){try{return t.EntitySets[0].ResultSets[0].Results.map((function(t,e){return function(t,e){var n,r;try{var o=!!t.Source.LastShared&&!t.Source.WebUrl;return{DateAccessed:t.Source.LastAccessDateTime||(null===(n=t.Source.UserRelationship)||void 0===n?void 0:n.LastAccessDateTime),DateModified:t.Source.LastModifiedDateTime,Endpoint:"Implicit"===(null===(r=t.SubstrateSearchExtendedProperties)||void 0===r?void 0:r.RelevanceRelationship)?o?D.a.MRUClassicContextual:D.a.MRUContextual:o?D.a.MRUClassic:D.a.MRUCloudy,FileExtension:t.Source.FileExtension,FileName:t.Source.FileName,FileSize:t.Source.FileSize,FileSourceType:t.ContentSource||t.Provenance,Id:o?t.Source.LastShared.AttachmentId:t.Id,Position:e,ReferenceId:t.ReferenceId,SourceTitle:t.Source.SiteTitle||t.Source.LastShared.SharingSubject,Url:t.Source.Url,TraceId:null}}catch(t){return c.g.info("[convertMRUAttachmentToReplyWithAttachmentSuggestion] Error accessing MRUAttachment properties: "+t.message),null}}(t,e)}))}catch(t){return c.g.info("[fetchMRUSuggestions_getAttachmentsFromResponse] Error: "+t.message),[]}}(l),[3,6];case 5:r=a?a.status+"-"+a.statusText:"No response",s.label=6;case 6:return[3,9];case 7:return d=s.sent(),r=d.message,[3,9];case 8:return r?(c.g.info("getMRUSuggestions: Error "+r),L(3)):U(n,2),Object(M.n)("SmartDocSuggestionRequestSent",{EID:e,isSuccessful:!r,numOfFileSuggestions:null==n?void 0:n.length}),[2,n];case 9:return[2]}}))}))}function W(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,e,n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(s.__read)(Object(F.getAccessTokenforResourceAsLazy)(window.location.origin),2),e=t[0],n=t[1],e?[3,2]:[4,n];case 1:e=r.sent(),r.label=2;case 2:return[2,e]}}))}))}var Q=n(11),Z="@EntityId";function J(t,e){var n=!1;if(t){if(e)try{n=function(t,e){var n=!1,r=e[Z];if(!r)throw c.g.info("[extractAndCacheSmartDocDataFromProperty] Cannot parse entity ID. Aborting..."),new Error("NoEntityIdOnProperty");return E(t,n=!0,r),n}(t,JSON.parse(e.Value)[0])}catch(t){throw c.g.warn("[parseSmartDocProperty] Malformed property, cannot parse. Error: "+t.message),t.networkError=!0,t}else c.g.info("[parseSmartDocProperty] No property found.");n||E(t,n)}else c.g.info("[parseSmartDocProperty] No item.")}var z=n(292),q=n(10),K=n(2042),X=n(15445),Y=n(669),$="...",tt=30,et=n(15446);function nt(t){var e,n,r,o=t.item,i=t.suggestion,a=t.smartPillLogData,u=t.onAttachmentClicked,l=t.dismissMenu,s=R.useCallback((function(){Object(M.j)(M.a,a,{subtype:"FileSuggestion"+i.Position,clickedSuggestion:{endpoint:D.a[i.Endpoint],fileSourceType:i.FileSourceType}}),Object(M.k)(a.mainPayload.EID,a.mainPayload.position,a.mainPayload.loggableText,"SmartDoc",a.mainPayload.language,a.mainPayload.locale,a.cosmosOnlyData),u(o,i,w.a.FileSuggestion),l()}),[o,i,l]);try{e=function(t){var e=null;try{e=[t.FileName,it(t),rt(t),ot(t)].filter((function(t){return t})).join("\n")}catch(t){c.g.info("[SmartDocMenuItemBuilder] Failed to parse attachment tooltip data, message: "+t.message)}finally{return e}}(i),n=function(t){return t.Endpoint===D.a.MRUClassic||t.Endpoint===D.a.MRUClassicContextual?it(t):rt(t)}(i),r=function(t){if(t.length<=tt)return t;var e=tt-$.length,n=Math.ceil(e/2),r=Math.floor(e/2),o=t.substr(0,n),i=t.substr(t.length-r);return""+o+$+i}(function(t){var e="."+t.FileExtension;return t.FileName.indexOf(e)>=0?t.FileName.replace(e,""):t.FileName}(i)+at(i))}catch(t){throw c.g.warn("[SmartDocMenuItemBuilder] Error: "+t.message),t.networkError=!0,t}return R.createElement("button",{className:et.attachmentSuggestionButton,title:e,name:i.FileName,"aria-label":Object(Q.c)(Object(Q.b)(X.b),i.FileName),"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:s,tabIndex:0},R.createElement("div",{className:et.attachmentSuggestionButtonContent},R.createElement("div",{className:et.attachmentSuggestionButtonImageContainer,role:"presentation","aria-hidden":"true"},function(t){var e=t.FileName+at(t);return R.createElement(K.a,{fileName:e,contentType:null,isBlocked:!1,isFolder:!1,embeddedItemClass:null,cloudyIconStyle:et.cloudyIcon,fileIconStyle:et.fileIcon})}(i)),R.createElement("div",null,R.createElement("div",{className:et.attachmentSuggestionButtonTextContainer},R.createElement("div",{className:et.attachmentSuggestionPrimaryText},r)),R.createElement("div",{className:et.attachmentSuggestionSecondaryText},n))))}function rt(t){if(t.Endpoint===D.a.MRUClassic||t.Endpoint===D.a.MRUClassicContextual)return null;var e=t.DateAccessed;e||c.d('[SmartDocMenuItemBuilder] Access date is not available for suggestion "'+t.Id+'"');var n=Object(q.Qb)("UTC",e),r=Object(q.N)(n,Object(Y.i)());return Object(Q.c)(Object(Q.b)(X.a),r)}function ot(t){var e=t.DateModified;e||c.d('[SmartDocMenuItemBuilder] Modified date is not available for suggestion "'+t.Id+'"');var n=Object(q.Qb)("UTC",e),r=Object(q.Y)(n);return Object(Q.c)(Object(Q.b)(X.c),r)}function it(t){var e=null,n=document.createElement("a");n.href=t.Url,e=decodeURIComponent(n.hostname);for(var r=Object(z.a)(),o=decodeURIComponent(n.pathname).split("/"),i=1;i<o.length-1;i++)r?e=o[i]+" < "+e:e+=" > "+o[i];return e}function at(t){return"."+t.FileExtension}var ct=3;var ut=n(267),lt=n(463),st=n(10655),dt=n(943),mt=n(312),gt=n(5198),ft=n(182),bt=n(15448),pt=n(388).bind(bt),ht=Object(d.a)((function(t){var e,n=t.store,r=t.item,o=t.logData,i=t.pillsToShowTypes,a=R.useRef(!1),u=R.useRef(),l=[],d=[];switch(l.push({key:"replyWithHeader",name:Object(Q.b)(st.b),title:Object(Q.b)(st.b),itemType:ft.a.Header,iconProps:{iconName:null,styles:{root:{margin:"0px",width:"0px"}}},className:bt.replyWithHeaderForBottomBar}),n.status){case 0:case 2:if(null===(e=n.suggestions)||void 0===e?void 0:e.length)(function(t,e){void 0===e&&(e=ct);var n=[],r=null;if(t)for(var o=0;o<t.length&&n.length<e;o++)(r=t[o])?n.push(r):c.g.info("[extractAttachmentSuggestions] mru suggestion is null");return n})(n.suggestions).forEach((function(t,e){l.push(function(t,e,n,r){return{key:"fileSuggestion"+e,className:bt.attachmentSuggestionButtonRoot,onRender:function(e,o){return R.createElement(nt,{item:n,suggestion:t,smartPillLogData:r,onAttachmentClicked:y,dismissMenu:o})}}}(t,e,r,o)),d.push(function(t){return{endpoint:D.a[t.Endpoint],fileSourceType:t.FileSourceType}}(t))}));l.push(St());break;case 1:l.push({key:"spinner",className:bt.attachmentSuggestionButtonRoot,onRender:function(){return R.createElement(dt.a,{size:mt.a.medium,className:bt.loadingSpinner})}}),l.push(St());break;case 3:l.pop();break;default:Object(ut.a)(n.status)}l.push(vt(r,o,Object(Q.b)(gt.b),Object(Q.b)(gt.b),{iconName:"System",styles:{root:pt(bt.iconRoot,bt.iconRootComputer)}},w.a.LocalFiles)),l.push(vt(r,o,Object(Q.b)(gt.a),Object(Q.b)(gt.a),{iconName:"Cloud",styles:{root:pt(bt.iconRoot,bt.iconRootCloud)}},w.a.CloudFiles)),l.push(vt(r,o,Object(Q.b)(gt.c),Object(Q.b)(gt.d),{iconName:"CloudUpload",styles:{root:pt(bt.iconRoot,bt.iconRootUploadAndShare)}},w.a.UploadAndShare));var m=function(t,e){if(t){var n=(new Date).toISOString(),r={data:[Object(s.__assign)(Object(s.__assign)({},o.mainPayload),{timeClicked:n,numOfFileSuggestions:d.length,isSuccessful:e})]};t.addCustomData([JSON.stringify(r)]),t.addCosmosOnlyData(o.cosmosOnlyData),t.end()}};R.useEffect((function(){!a.current||2!==n.status&&3!==n.status||m(u.current,2===n.status)}));var f={items:l,onMenuOpened:function(){a.current=!0,Object(M.j)(M.d,o,{numOfFileSuggestions:d.length,numOfPillsShown:i.length,typesOfPillsShown:i}),1===n.status&&(u.current=new T.b(M.c,{isCore:!0,isCosmosDatapoint:!0}))},onMenuDismissed:function(){a.current=!1,Object(M.j)(M.b,o,{numOfFileSuggestions:d.length,suggestions:d}),1===n.status&&m(u.current,!1),u.current=null}},b=Object(Q.b)(st.a);return R.createElement(lt.a,{ariaDescription:b,title:Object(g.i)("mc-smartPillsTooltipV2")?Object(Q.b)(st.c):b,iconProps:{iconName:"Attach"},key:t.position,split:!1,styles:t.menuItemStyle,text:b,menuProps:f})}));function St(){return{key:"replyWithSeparator",iconProps:{iconName:null,styles:{root:{margin:"0px",width:"0px"}}},className:bt.replyWithSeparator,itemType:ft.a.Divider}}function vt(t,e,n,r,o,i){var a=w.a[i];return{key:a,name:n,ariaLabel:r,title:r,iconProps:o,onClick:function(){Object(M.j)(M.a,e,{subtype:a}),y(t,null,i)}}}var Ot=n(3106),yt=n(3523),jt="EntityExtraction/SendContentRequestV21.0",Pt="Attach a file";function kt(t){var e;return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return t.SmartDocData&&!t.SmartDocData.EntityId?[2,[]]:t.SmartDocData?[3,3]:[4,yt.c.import()];case 1:return[4,o.sent()(t.ItemId.Id,Ot.a.SmartDoc)];case 2:(n=o.sent())&&(r=function(t,e){var n=t.ExtendedProperty;if(n)for(var r=n.length,o=0;o<r;o++){var i=n[o];if(i.ExtendedFieldURI.PropertyName===e)return i}return null}(n,jt),J(n,r)),o.label=3;case 3:return(null===(e=t.SmartDocData)||void 0===e?void 0:e.EntityId)?[2,[It(t)]]:[2,[]]}}))}))}function It(t){var e,n=Object(M.i)("SmartDoc",Pt,t.SmartDocData.EntityId);return G(Object(g.i)("mc-smartReplyWithDoc-ContextualMRU")?null===(e=t.ItemId)||void 0===e?void 0:e.Id:null,t.SmartDocData.EntityId),{onRender:function(e,r,o){return R.createElement(ht,{store:B(),item:t,logData:n,position:e,menuItemStyle:r,pillsToShowTypes:o})},ariaLabel:Object(Q.b)(st.a),featureName:"SmartDoc",index:0,logData:n,onClick:null}}function xt(t){var e=this;return{buildPills:function(){return Object(s.__awaiter)(e,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return[2,kt(t)]}))}))},getName:function(){return"SmartDoc"}}}var Ct=Object(r.action)("cacheSmartReplyDataAction",(function(t,e,n,r,o){return{item:t,validPropertyExists:e,smartReplies:n,loggableSmartReplies:r,smartReplyExtractionID:o}})),_t=n(20),wt=(Object(r.mutator)(Ct,(function(t){var e={SmartReplies:null,LoggableSmartReplies:null,ExtractionID:null,SuggestionAppropriatenessMap:null,FeedbackSubmitted:!1},n=t.item,r=t.validPropertyExists,o=t.smartReplies,i=t.loggableSmartReplies,a=t.smartReplyExtractionID;if(r){e={SmartReplies:o,LoggableSmartReplies:i,ExtractionID:a,SuggestionAppropriatenessMap:new _t.ObservableMap,FeedbackSubmitted:!1};for(var c=0;c<o.length;c++){var u=String(c);e.SuggestionAppropriatenessMap.set(u,"")}}n.SmartReplyData=e})),Object(r.action)("updateSIGSDataOnClickAction",(function(t,e,n){return{composeViewState:t,timeClicked:e,clickIndex:n}}))),Tt=(Object(r.mutator)(wt,(function(t){var e=t.composeViewState,n=t.timeClicked,r=t.clickIndex;e&&(e.smartPillViewState.smartReplyComposeSIGSData={isSmartSuggestionsClicked:!0,suggestionsClickedTime:n,clickIndex:r})})),"EntityExtraction/SmartReplyForEmail"),Et=n(15450),Rt=n(1892),Dt=n(15451);function Ft(t,e,n){return e.suggestions.slice(1).map((function(e){return{key:e,name:e,ariaLabel:e,title:Object(g.i)("mc-smartPillsTooltipV2")?Object(Q.b)(Et.b):e,itemProps:{styles:{root:Dt.menuButton}},onClick:function(){Object(M.j)(M.f,n,{subtype:e}),Object(M.k)(n.mainPayload.EID,n.mainPayload.position,n.mainPayload.loggableText,"SmartReply",n.mainPayload.language,n.mainPayload.locale,n.cosmosOnlyData,e),Rt.j.importAndExecute(t.ItemId.Id,t.ConversationId.Id,e,1)}}}))}var At="2018-06-20T00:00:00.0000000Z",Mt="@extractionTimeUtc",Nt="@EntityId",Bt=3,Lt="SmartReplyForEmail",Ut="SmartReplyForEmail_Group";function Vt(t,e){var n=!1;if(t){if(e)try{var r=JSON.parse(e.Value)[0],o=r[Mt];if(!o){c.g.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Time stamp not found on property, aborting smart reply parsing.");var i=new Error("NoTimeStamp");throw i.networkError=!0,i}Date.parse(o)>=Date.parse(At)&&(n=function(t,e){for(var n=e[Nt],r=[],o=[],i=!1,a=e.entities.length,u=0;u<a;u++){var l=Ht(e.entities[u]),s=l.smartReply,d=l.loggableSmartReply;r.push(s),o.push(d)}if(!n||r.length!=Bt){c.g.info("[getSmartRepliesForItem_extractAndCacheSmartRepliesFromProperty] Unexpected number of smart replies on item. Expected "+Bt+" but found "+r.length);var m=new Error("NumberOfSmartRepliesIs"+r.length);throw m.networkError=!0,m}Ct(t,i=!0,r,o,n);return i}(t,r))}catch(t){throw c.g.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Malformed property, cannot parse. Error: "+t.message),t.networkError=!0,t}else c.g.info("[getSmartRepliesForItem_parseSmartReplyProperty] No property found.");n||Ct(t,n,null)}else c.g.info("[getSmartRepliesForItem_parseSmartReplyProperty] No item.")}function Ht(t){var e=null,n=null;switch(t["@type"]){case Lt:e={type:0,suggestions:t.value},n=t.valueRaw||t.value;break;case Ut:e={type:1,suggestions:t.values},n=JSON.stringify(t.values);break;default:c.g.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Unexpected entity type. Expected "+Lt+" or "+Ut+" but found "+t["@type"])}return{smartReply:e,loggableSmartReply:n}}function Gt(t){var e;return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return t?t.SmartReplyData?[3,3]:[4,yt.c.import()]:[3,4];case 1:return[4,o.sent()(t.ItemId.Id,Ot.a.SmartReply)];case 2:(n=o.sent())&&(r=function(t,e){var n=t.ExtendedProperty;if(n)for(var r=n.length,o=0;o<r;o++){var i=n[o];if(i.ExtendedFieldURI.PropertyName===e)return i}return null}(n,Tt),Vt(n,r)),o.label=3;case 3:return(null===(e=t.SmartReplyData)||void 0===e?void 0:e.ExtractionID)?[2,t.SmartReplyData.SmartReplies.map((function(e,n){return function(t,e,n,r,o){var i=this,a=Object(M.i)("SmartReply",n,r,o+1),c=null,u=null;if(0==e.type)c=e.suggestions;else if(1==e.type)switch(e.suggestions.length){case 0:c="";break;case 1:c=e.suggestions[0];break;default:c=e.suggestions[0],u={items:Ft(t,e,a)}}return{ariaLabel:Object(Q.c)(Object(Q.b)(Et.a),c),featureName:"SmartReply",icon:Object(g.i)("mc-smartPillsDesignV2")?{iconName:"Edit"}:null,onClick:function(e){return Object(s.__awaiter)(i,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return[4,Rt.j.importAndExecute(t.ItemId.Id,t.ConversationId.Id,c,1)];case 1:return n=r.sent(),wt(n,e.logData.mainPayload.timeClicked,e.logData.mainPayload.position),[2]}}))}))},logData:a,index:o,text:c,toolTip:Object(g.i)("mc-smartPillsTooltipV2")?Object(Q.b)(Et.b):c,confidenceScore:a.mainPayload.confidenceScore,menuProps:u}}(t,e,t.SmartReplyData.LoggableSmartReplies[n],t.SmartReplyData.ExtractionID,n)}))]:[3,5];case 4:c.g.info("[getSmartRepliesForItem] No item, cannot produce smart replies."),o.label=5;case 5:return[2,[]]}}))}))}function Wt(t){var e=this;return{buildPills:function(){return Object(s.__awaiter)(e,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return[2,Gt(t)]}))}))},getName:function(){return"SmartReply"}}}var Qt=Object(r.action)("cacheSmartTimeExtendedPropertyAction",(function(t,e,n){return{item:t,validPropertyExists:e,smartTimesExtendedProp:n}})),Zt=(Object(r.mutator)(Qt,(function(t){var e={beginingOfTimeRange:null,endOfTimeRange:null,duration:null,entityId:null,hasIntent:!1,confidenceScore:0,scheduler:"",rawConfidenceScores:null},n=t.item,r=t.validPropertyExists,o=t.smartTimesExtendedProp;r&&o&&(e=Object(s.__assign)(Object(s.__assign)({},o),{hasIntent:!0})),n.SmartTimeExtendedProperty=e})),n(10656));var Jt="EntityExtraction/Events1.0",zt="EntityExtraction/CalendarRelated1.0";var qt=n(545),Kt=n(782);var Xt="@EntityId",Yt="confidence",$t="SenderSchedulerConfidence",te="RecipientSchedulerConfidence",ee="UnclearSchedulerConfidence",ne="AvailabilityConfidence",re="times";function oe(t,e){if(e){var n=null,r=!1;try{var o=JSON.parse(e.Value),i=-1/0,a=null;o.forEach((function(t){var e,n=(e=t,Object(g.i)("mc-smartReplyWithMeeting-MeetingScheduler")?Math.max(e[te]?e[te]:0,e[ee]?e[ee]:0,e[ne]?e[ne]:0):e[Yt]?+e[Yt]:0);n>i&&(i=n,a=t)}));var u=a[Xt],l=a[re][0],s={confidence:a[Yt],AvailabilityConfidence:a[ne],RecipientSchedulerConfidence:a[te],SenderSchedulerConfidence:a[$t],UnclearSchedulerConfidence:a[ee]},d=function(t,e){var n="";if(Object(g.i)("mc-smartReplyWithMeeting-MeetingScheduler")&&t&&e>0){var r=0;t[te]>r&&(r=t[te],n="Recipient"),t[ee]>r&&(r=t[ee],n="Unclear"),t[ne]>r&&(r=t[ne],n="Availability")}return n}(a,i);n={beginingOfTimeRange:l.beginingOfTimeRange,endOfTimeRange:l.endOfTimeRange,duration:l.duration,entityId:u,hasIntent:!0,confidenceScore:i,scheduler:d,rawConfidenceScores:s},r=!0}catch(t){throw c.g.warn("[getSmartTimeForItem_parseSmartTimeProperty] Malformed property, cannot parse. Error: "+t.message),t.networkError=!0,t}finally{Qt(t,r,n)}}else c.g.info("[getSmartTimeForItem_parseSmartTimeProperty] No smart time extended property found.")}var ie=n(1812),ae=n(281),ce=n(1481),ue=n(1783),le=Object(ae.action)("setCalendarInlineComposeViewState")((function(t,e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return n=t,[4,C.i.import()];case 1:return[4,a.sent()(n,!0)];case 2:return r=s.__read.apply(void 0,[a.sent(),2]),o=r[0],i=r[1],Object(ce.a)(t.ConversationId.Id).calendarInlineComposeViewState=Object(s.__assign)(Object(s.__assign)({},Object(ue.a)()),{referenceItemId:t.ItemId.Id,subject:t.Subject,location:null,smartTimeSuggestion:e,toRecipients:o,ccRecipients:i}),[2]}}))}))})),se=n(1299);function de(){var t=Object(g.i)("mc-smartReplyWithMeeting-Cortana"),e=Object(se.d)(se.a.CalendarHelp).calendarHelpEnabled;return t&&e}var me=n(7132);function ge(t){var e;return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,a,u,l,d,m,f,b,p,h,S;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return n=[],t?t.SmartTimeExtendedProperty?[3,3]:[4,yt.c.import()]:[3,7];case 1:return[4,s.sent()(t.ItemId.Id,Ot.a.SmartTime)];case 2:(r=s.sent())&&(o=function(t){var e=null,n=Object(g.i)("mc-smartReplyWithMeeting-MeetingScheduler")?zt:Jt;if(t){var r=t.ExtendedProperty;r&&r.some((function(t){return t.ExtendedFieldURI.PropertyName==n&&(e=t,!0)}))}return e}(r),oe(r,o)),s.label=3;case 3:return(i=t.SmartTimeExtendedProperty)?(a=i.entityId,u=100*i.confidenceScore,l=i.scheduler,d=i.rawConfidenceScores,m=function(t){var e;if(null===(e=null==t?void 0:t.SmartTimeExtendedProperty)||void 0===e?void 0:e.beginingOfTimeRange)try{var n=Object(q.lc)(t.SmartTimeExtendedProperty.beginingOfTimeRange);if(Object(Y.e)(n)){var r=Number(t.SmartTimeExtendedProperty.duration);r<=0&&(r=Object(Kt.a)());var o=Object(q.h)(n,r),i=Object(qt.g)(n,o);return{startTime:i.start,endTime:i.end}}}catch(t){throw c.g.warn("[getSmartTimeSuggestion] Unable to parse suggested time. Error: "+t.message),t.networkError=!0,t}return null}(t),f=null,m?[4,le(t,m)]:[3,5]):[3,6];case 4:s.sent(),f=Object(ce.a)(null===(e=t.ConversationId)||void 0===e?void 0:e.Id).calendarInlineComposeViewState,s.label=5;case 5:b=t,p=de(),h=function(t,e,n,r,o,i,a){var c=Object(M.i)("SmartTime",Object(Q.b)(Zt.d),t,e),u=null!=i,l=o.ToRecipients?o.ToRecipients.length:0,s=o.CcRecipients?o.CcRecipients.length:0;c.mainPayload.rawConfidenceScores=r,c.mainPayload.scheduler=n,c.mainPayload.hasSuggestedTime=u,c.mainPayload.NumToRecipient=l,c.mainPayload.NumCCRecipient=s,c.mainPayload.isCalendarHelpEnabled=a,c.cosmosOnlyData=o.InternetMessageId,u&&(c.mainPayload.suggestedStartTime=i.startTime,c.mainPayload.suggestedEndTime=i.endTime);return c}(a,u,l,d,b,m,p),S=null,p&&(S={items:be(t,f,a,b,h)}),n.push(function(t,e,n,r,o,i,a){return{ariaLabel:Object(Q.b)(Zt.d),featureName:"SmartTime",onClick:n,index:t,logData:r,text:e,toolTip:Object(g.i)("mc-smartPillsTooltipV2")?Object(Q.b)(Zt.e):e,icon:i,confidenceScore:o,menuProps:a}}(n.length,Object(Q.b)(Zt.d),(function(){return fe(t,f,a,b,{SuggestionsClickedTime:(new Date).toISOString()})}),h,u,{iconName:"DateTime2"},S)),s.label=6;case 6:return[3,8];case 7:c.g.info("[getSmartTimesForItem] No item, cannot produce smart times."),s.label=8;case 8:return[2,n]}}))}))}function fe(t,e,n,r,o){window.addEventListener("message",pe),ie.r.importAndExecute(t.ItemId.Id,e,!1,null,n,r.InternetMessageId,o)}function be(t,e,n,r,o){var i=[];return i.push({key:"OutlookMeeting",text:Object(Q.b)(Zt.c),onClick:function(){Object(M.j)(M.g,o,{subtype:"OutlookMeeting"});var i=(new Date).toISOString();fe(t,e,n,r,{SuggestionsClickedTime:i,IsSmartTimeSuggestionsClicked:i?"True":"False"})}}),i.push({key:"CortanaMeeting",text:Object(Q.b)(Zt.a),onClick:function(){Object(M.j)(M.g,o,{subtype:"CortanaMeeting"}),function(t){Rt.j.importAndExecute(t.ItemId.Id,t.ConversationId.Id,Object(Q.b)(Zt.b),2)}(t)}}),i}var pe=function(t){if((null==t?void 0:t.data)&&"string"==typeof t.data){var e=JSON.parse(t.data);e&&"calDraftItem"===e.source&&me.a.importAndExecute({featureName:"SmartTime"})}};function he(t){var e=this;return{buildPills:function(){return Object(s.__awaiter)(e,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return[2,ge(t)]}))}))},getName:function(){return"SmartTime"}}}function Se(t){var e=this;return{updateLogData:function(n){return Object(s.__awaiter)(e,void 0,void 0,(function(){var e,r,o,i,a;return Object(s.__generator)(this,(function(c){return t&&(e=null===(i=t.stampedLanguage)||void 0===i?void 0:i.language,r=null===(a=t.stampedLanguage)||void 0===a?void 0:a.locale,o=t.InternetMessageId,n.forEach((function(t){t.logData.mainPayload.language=e,t.logData.mainPayload.locale=r,t.logData.cosmosOnlyData=o}))),[2]}))}))},getName:function(){return"ItemLevelDataUpdater"}}}function ve(t){var e=this;return{preRun:function(){return Object(s.__awaiter)(e,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,yt.c.import()];case 1:return[4,n.sent()(t.ItemId.Id,Ot.a.LanguageAndLocale)];case 2:return(e=n.sent())&&!e.stampedLanguage&&a(e),[2]}}))}))},getName:function(){return"LanguagePreRunner"}}}var Oe=n(15453),ye={SmartPillFeedbackGenericOption1:"Not relevant",SmartPillFeedbackGenericOption2:"Too similar",SmartPillFeedbackGenericOption3:"No reply needed",SmartPillFeedbackGenericOption4:"Doesn't sound like me",SmartPillFeedbackGenericOption5:"Offensive or rude",SmartPillFeedbackGenericOption6:"Not in the correct language",SmartPillFeedbackGenericOption7:"Other",SmartPillFeedbackMeetingOption1:"The meeting is already on my calendar",SmartPillFeedbackMeetingOption2:"A meeting suggestion isn't relevant",SmartPillFeedbackMeetingOption3:"I'm not the person who should schedule the meeting",SmartPillFeedbackMeetingOption4:"I want to schedule the meeting later",SmartPillFeedbackMeetingOption5:"I don't want help scheduling a meeting",SmartPillFeedbackFileOption1:'"Attach a file" suggestion isn\'t relevant',SmartPillFeedbackFileOption2:"I'm not the one who needs to attach a file",SmartPillFeedbackFileOption3:"Didn't find the file I was looking for",SmartPillFeedbackFileOption4:"Didn't get any file suggestions",SmartPillFeedbackFileOption5:"Want to attach a file later"};function je(t,e){var n;e.UniqueBody?n=e.UniqueBody.Value:e.NormalizedBody&&(n=e.NormalizedBody.Value);var r={subtitle:void 0,dSATOptions:void 0,donationJson:{messageBody:n}},o=t.some((function(t){return"SmartTime"===t.featureName})),i=t.some((function(t){return"SmartDoc"===t.featureName})),a=t.some((function(t){return"SmartReply"===t.featureName}));return o&&i&&c.g.warn("[SmartPillFeedbackData] feedback options not defined for Smart Time + Smart Doc"),a?(r.subtitle=Object(Q.b)(Oe.n),r.dSATOptions=o?[{logString:ye.SmartPillFeedbackGenericOption1,uiString:Object(Q.b)(Oe.g)},{logString:ye.SmartPillFeedbackGenericOption4,uiString:Object(Q.b)(Oe.j)},{logString:ye.SmartPillFeedbackGenericOption5,uiString:Object(Q.b)(Oe.k)},{logString:ye.SmartPillFeedbackMeetingOption3,uiString:Object(Q.b)(Oe.q)},{logString:ye.SmartPillFeedbackMeetingOption5,uiString:Object(Q.b)(Oe.s)},{logString:ye.SmartPillFeedbackGenericOption7,uiString:Object(Q.b)(Oe.m)}]:i?[{logString:ye.SmartPillFeedbackGenericOption1,uiString:Object(Q.b)(Oe.g)},{logString:ye.SmartPillFeedbackGenericOption5,uiString:Object(Q.b)(Oe.k)},{logString:ye.SmartPillFeedbackFileOption2,uiString:Object(Q.b)(Oe.b)},{logString:ye.SmartPillFeedbackFileOption3,uiString:Object(Q.b)(Oe.c)},{logString:ye.SmartPillFeedbackFileOption5,uiString:Object(Q.b)(Oe.e)},{logString:ye.SmartPillFeedbackGenericOption7,uiString:Object(Q.b)(Oe.m)}]:[{logString:ye.SmartPillFeedbackGenericOption1,uiString:Object(Q.b)(Oe.g)},{logString:ye.SmartPillFeedbackGenericOption2,uiString:Object(Q.b)(Oe.h)},{logString:ye.SmartPillFeedbackGenericOption3,uiString:Object(Q.b)(Oe.i)},{logString:ye.SmartPillFeedbackGenericOption4,uiString:Object(Q.b)(Oe.j)},{logString:ye.SmartPillFeedbackGenericOption5,uiString:Object(Q.b)(Oe.k)},{logString:ye.SmartPillFeedbackGenericOption6,uiString:Object(Q.b)(Oe.l)},{logString:ye.SmartPillFeedbackGenericOption7,uiString:Object(Q.b)(Oe.m)}]):o?(r.subtitle=Object(Q.b)(Oe.t),r.dSATOptions=[{logString:ye.SmartPillFeedbackMeetingOption1,uiString:Object(Q.b)(Oe.o)},{logString:ye.SmartPillFeedbackMeetingOption2,uiString:Object(Q.b)(Oe.p)},{logString:ye.SmartPillFeedbackMeetingOption3,uiString:Object(Q.b)(Oe.q)},{logString:ye.SmartPillFeedbackMeetingOption4,uiString:Object(Q.b)(Oe.r)},{logString:ye.SmartPillFeedbackMeetingOption5,uiString:Object(Q.b)(Oe.s)},{logString:ye.SmartPillFeedbackGenericOption7,uiString:Object(Q.b)(Oe.m)}]):i?(r.subtitle=Object(Q.b)(Oe.f),r.dSATOptions=[{logString:ye.SmartPillFeedbackFileOption1,uiString:Object(Q.b)(Oe.a)},{logString:ye.SmartPillFeedbackFileOption2,uiString:Object(Q.b)(Oe.b)},{logString:ye.SmartPillFeedbackFileOption3,uiString:Object(Q.b)(Oe.c)},{logString:ye.SmartPillFeedbackFileOption4,uiString:Object(Q.b)(Oe.d)},{logString:ye.SmartPillFeedbackFileOption5,uiString:Object(Q.b)(Oe.e)},{logString:ye.SmartPillFeedbackGenericOption7,uiString:Object(Q.b)(Oe.m)}]):r.subtitle=Object(Q.b)(Oe.n),r}var Pe=n(4102);var ke=n(7435),Ie=n(9145),xe=n(15454),Ce=Object(d.a)((function(t){var e,n=this;R.useEffect((function(){return f(),function(){r.current=null,i.current=null,l.current=null,u.current=null,o(t.viewState,!1)}}),[]),R.useEffect((function(){d.current||(d.current=Object(ke.b)(t.item))}));var r=R.useRef(function(t){return[he(t),xt(t),Wt(t)]}(t.item)),i=R.useRef(O),a=R.useRef(function(t){return[Se(t)]}(t.item)),u=R.useRef(function(t){return[ve(t)]}(t.item)),l=R.useRef(),d=R.useRef(!1),g=Object(m.a)((function(){var e,n=t.item;return!(null===(e=null==n?void 0:n.ItemId)||void 0===e||!e.Id)&&null!=Object(x.a)(n.ItemId.Id,1)})),f=function(){return Object(s.__awaiter)(n,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return c.g.info("[MailSmartPillBlock] Running smart pill builders"),e=l,[4,Object(M.h)(r.current,i.current,u.current,a.current,3e3)];case 1:return e.current=n.sent(),function(t,e){var n=e?e.pillsToShow.filter((function(t){return"SmartReply"===t.featureName})):[],r=n.length>0?n[0].logData.mainPayload.EID:"",o=e&&e.pillsToShow.length>0?"True":"False",i="True"===o?e.pillsToShow.map((function(t){return t.featureName})).toString():"",a="True"===o?e.pillsToShow.map((function(t){return t.text})).join("$"):"";Object(Pe.a)(t.ItemId.Id,o,i,a,r)}(t.item,l.current),l.current&&l.current.pillsToShow.length>0&&o(t.viewState,!0),[2]}}))}))},b=t.item,p=t.viewState.smartPillBlockVisible,h=!!b.RightsManagementLicenseData,S=(null===(e=b.adaptiveCardDetails)||void 0===e?void 0:e.length)>0&&"3f0a4969-053e-44be-9931-ca62d0c32bde"!==b.adaptiveCardDetails[0].connectorSenderGuid;if(h||!p||!l.current||0==l.current.pillsToShow.length&&0==l.current.pillsToHide.length||g.get()||S)return null;var v=l.current.pillsToShow.length>0;return R.createElement("div",{className:v?xe.bar:void 0},R.createElement(Ie.a,{arbitratedPills:l.current,enableFeedbackForm:!b.smartPillFeedbackSubmitted,feedbackData:je(l.current.pillsToShow,b)}))}));n.d(e,"MailSmartPillBlock",(function(){return Ce}))},1715:function(t,e,n){"use strict";var r=n(0),o=n(29);function i(t){return Object(r.__assign)({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},t)}function a(t){var e,n,r=i({ProviderType:t});return void 0===(e=r)||e.__type||(e=i(e)),Object(o.a)("GetNewAttachmentDataProviderCreationInfo",e,n)}function c(t){return Object(r.__assign)({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},t)}function u(t){var e,n,r=c({ProviderType:t});return void 0===(e=r)||e.__type||(e=c(e)),Object(o.a)("GetAttachmentDataProviderCreator",e,n)}var l=n(2083),s=n(2021);n.d(e,"a",(function(){return S})),n.d(e,"b",(function(){return y}));var d="code",m="token",g=3e3,f=3;function b(t){return{state:t}}function p(t){return t.state}function h(t){return t.code}function S(t,e,n,o,i){var c={providerType:t,getAuthUrlInfo:null,getCSRFToken:p,getOAuthCode:h};return function t(e,n,o,i,c,s,d){return Object(r.__awaiter)(this,void 0,void 0,(function(){var m,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),m=void 0,7!==e&&9!==e&&8!==e?[3,2]:[4,u(e)];case 1:return f=r.sent(),m=f.AttachmentDataProviderCreator.ProviderAppKey,o=f.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,a(e)];case 3:f=r.sent(),m=f.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(l.d)(e,o,i,m,c,s),[3,6];case 5:return r.sent(),d>0&&setTimeout((function(){return t(e,n,o,i,c,s,--d)}),g),[3,6];case 6:return[2]}}))}))}(t,c,e,n,o,i,f),c}var v=null;function O(){if(!v){if(v={},Object(s.a)(3)&&(v[3]=S(3,"https://app.box.com/api/oauth2/authorize",Object(l.c)(3),d,b)),Object(s.a)(2)&&(v[2]=S(2,"https://www.dropbox.com/oauth2/authorize",Object(l.b)(2),d,b)),Object(s.a)(6)){var t=S(6,"https://www.facebook.com/dialog/oauth",Object(l.b)(6),m,(function(t){return{state:t,scope:"user_photos,email"}}));t.getCSRFToken=p,t.getOAuthCode=function(t){return t.access_token},v[6]=t}if(Object(s.a)(5)){var e=S(5,"https://accounts.google.com/o/oauth2/auth",l.a+"/ADPRedirect.aspx",d,(function(t){var e={state:t,provider:5..toString(),url:Object(l.b)()};return{state:JSON.stringify(e),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));e.getCSRFToken=function(t){return JSON.parse(t.state).state},v[5]=e}Object(s.a)(1)&&(v[1]=S(1,"https://login.live.com/oauth20_authorize.srf",Object(l.c)(1),d,(function(t){return{state:t,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(s.a)(7)&&(v[7]=S(7,"",Object(l.c)(7),d,b)),Object(s.a)(8)&&(v[8]=S(8,"",Object(l.c)(8),d,b)),Object(s.a)(9)&&(v[9]=S(9,"",Object(l.c)(9),d,b))}return v}function y(t){var e=O();return t in e?e[t]:null}},1720:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1507);function o(){return Object(r.a)().loadState}},1728:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2134),o=n(2047),i=n(2095),a=n(11),c=n(267);function u(t,e){if(void 0===e&&(e=!1),e)return"";switch(t){case 0:return Object(a.b)(i.b);case 1:return Object(a.b)(i.a);case 2:case 9:return Object(a.b)(r.b);case 3:case 7:return Object(a.b)(r.a);case 5:return Object(a.b)(r.e);case 6:return Object(a.b)(r.d);case 4:return Object(a.b)(r.f);case 10:return Object(a.b)(o.b);case 8:return Object(a.b)(r.c);default:return Object(c.a)(t)}}},1729:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return a}));var r,o=n(0);!function(t){t[t.Groups=1e4]="Groups"}(r||(r={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),a=Object.freeze(Object(o.__spread)(i,[0,4,10]))},1757:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var r=n(3),o=Object(r.action)("NEW_MESSAGE_V3",(function(t,e,n,r,o){return{actionSource:t,groupId:e,toEmailAddressWrappers:n,subject:r,body:o}})),i=Object(r.action)("ON_CLOSE_COMPOSE",(function(t){return{closeReason:t}}))},178:function(t,e,n){"use strict";var r=n(74),o=n(640),i=n(641),a=n(431);function c(){return Object(a.a)().endShortEventsBy}function u(){return Object(a.a)().endLongEventsBy}var l=n(638),s=n(639),d=n(772),m=n(636),g=n(637),f=n(77),b=5;function p(){if(!Object(f.i)("cal-mf-shouldEventsEndEarlySetting")&&!Object(f.i)("cal-mf-shortenEventsDuration"))return 0;var t=c();return null!=t?t:b}var h=10;function S(){if(!Object(f.i)("cal-mf-shouldEventsEndEarlySetting")&&!Object(f.i)("cal-mf-shortenEventsDuration"))return 0;var t=u();return null!=t?t:h}var v=n(773),O=n(473);n.d(e,"o",(function(){return j})),n.d(e,"n",(function(){return P})),n.d(e,"m",(function(){return o.a})),n.d(e,"l",(function(){return i.a})),n.d(e,"k",(function(){return c})),n.d(e,"j",(function(){return u})),n.d(e,"i",(function(){return l.a})),n.d(e,"e",(function(){return s.a})),n.d(e,"f",(function(){return d.a})),n.d(e,"g",(function(){return m.a})),n.d(e,"h",(function(){return g.a})),n.d(e,"c",(function(){return p})),n.d(e,"b",(function(){return S})),n.d(e,"d",(function(){return v.a})),n.d(e,"a",(function(){return O.a}));var y=new r.c((function(){return n.e(502).then(n.bind(null,17290))})),j=new r.a(y,(function(t){return t.saveCalendarCloudSettings})),P=new r.a(y,(function(t){return t.initCalendarCloudSettings}))},1782:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Images=1]="Images"}(r||(r={})),e.a=r},1783:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=0;function o(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),{editorId:(r++).toString(),content:t,isDirty:e,textDirection:null,keyStrokeCount:0,selectedImage:null}}},1812:function(t,e,n){"use strict";var r=n(74),o=n(2260),i=n(1864),a=n(1724),c=n(1851),u=n(2010),l=n(2011),s=n(2151),d=n(2261),m=n(2152),g=n(1395),f=n(77),b=n(1297);function p(t,e){return!!t&&(1!==e&&!!b.a.conversations.get(t))}function h(t,e){return 2!=e&&(Object(f.i)("rp-persistedReadingPaneTabs")?g.a.loadedItemReadingPaneViewStates.has(t):g.a.itemReadingPaneViewState&&g.a.itemReadingPaneViewState.itemId==t)}var S=n(1973),v=n(1974),O=n(1879),y=n(1481);n.d(e,"l",(function(){return P})),n.d(e,"p",(function(){return k})),n.d(e,"m",(function(){return I})),n.d(e,"q",(function(){return x})),n.d(e,"s",(function(){return C})),n.d(e,"n",(function(){return _})),n.d(e,"o",(function(){return w})),n.d(e,"i",(function(){return T})),n.d(e,"j",(function(){return E})),n.d(e,"k",(function(){return R})),n.d(e,"g",(function(){return D})),n.d(e,"r",(function(){return F})),n.d(e,"h",(function(){return A})),n.d(e,"d",(function(){return p})),n.d(e,"e",(function(){return h})),n.d(e,"f",(function(){return S.a})),n.d(e,"a",(function(){return v.a})),n.d(e,"t",(function(){return g.a})),n.d(e,"c",(function(){return O.a})),n.d(e,"b",(function(){return y.a}));var j=new r.c((function(){return Promise.all([n.e(3),n.e(6),n.e(8),n.e(15),n.e(17),n.e(18),n.e(21),n.e(22),n.e(26),n.e(39),n.e(47),n.e(62),n.e(73),n.e(136),n.e(120),n.e(175),n.e(179),n.e(262),n.e(271),n.e(259),n.e(709)]).then(n.bind(null,17143))})),P=new r.a(j,(function(t){return t.loadConversationReadingPane})),k=new r.a(j,(function(t){return t.moveReadingPaneToTab})),I=new r.a(j,(function(t){return t.loadConversationReadingPaneForSingleMailItemSelected})),x=new r.a(j,(function(t){return t.print})),C=new r.a(j,(function(t){return t.setItemIdToScrollTo})),_=new r.a(j,(function(t){return t.loadItemReadingPane})),w=new r.a(j,(function(t){return t.loadItemReadingPaneForSingleMailItemSelected})),T=new r.a(j,(function(t){return t.expandCollapseAllItemParts}));Object(r.f)(a.a,j,(function(t){return t.deleteItemsStoreUpdateOrchestrator})),Object(r.f)(u.a,j,(function(t){return t.markConversationsAsReadStoreUpdateOrchestrator})),Object(r.f)(l.a,j,(function(t){return t.markItemsAsReadStoreUpdateOrchestrator})),Object(r.f)(c.a,j,(function(t){return t.markAllAsReadOrchestrator})),Object(r.f)(o.a,j,(function(t){return t.applyConversationFlagStateStoreUpdateOrchestrator})),Object(r.f)(i.a,j,(function(t){return t.deleteConversationStoreUpdateOrchestrator})),Object(r.f)(m.a,j,(function(t){return t.conversationReadyToLoadOrchestrator})),Object(r.f)(m.b,j,(function(t){return t.updateAttachmentsOrchestrator})),Object(r.f)(m.c,j,(function(t){return t.updateItemMandatoryPropertiesOrchestrator})),Object(r.f)(s.a,j,(function(t){return t.updateInternetMessageIdOrchestrator})),Object(r.f)(d.a,j,(function(t){return t.initializeExtendedCardForItemReadingPaneOrchestrator}));new r.b(j,(function(t){return t.getLastestNonDraftItemId}));var E=new r.b(j,(function(t){return t.getLatestNonDraftItemIdFromConversation})),R=new r.b(j,(function(t){return t.isUnsupportedItem})),D=new r.a(j,(function(t){return t.clearReadingPaneStore})),F=new r.a(j,(function(t){return t.replyByMeeting})),A=new r.a(j,(function(t){return t.ensureSecondaryReadingPaneTabHandler}))},1892:function(t,e,n){"use strict";var r=n(3),o=n(1757);Object(r.orchestrator)(o.a,(function(t){u.importAndExecute(t.actionSource,t.groupId,t.toEmailAddressWrappers,t.subject,t.body)}));var i=n(2187),a=(Object(r.orchestrator)(i.a,(function(t){var e=t.source,n=t.groupId,r=t.toRecipients,i=t.subject,a=t.body;Object(o.a)(e,n,r,i,a)})),n(74));n.d(e,"c",(function(){return u})),n.d(e,"h",(function(){return l})),n.d(e,"a",(function(){return s})),n.d(e,"f",(function(){return d})),n.d(e,"i",(function(){return m})),n.d(e,"b",(function(){return g})),n.d(e,"g",(function(){return f})),n.d(e,"k",(function(){return b})),n.d(e,"j",(function(){return p})),n.d(e,"e",(function(){return h})),n.d(e,"d",(function(){return S}));var c=new a.c((function(){return Promise.all([n.e(28),n.e(32),n.e(40),n.e(41),n.e(641)]).then(n.bind(null,17212))})),u=new a.a(c,(function(t){return t.newMessage}),{captureBundleTime:!0}),l=new a.a(c,(function(t){return t.replyToConversation})),s=new a.a(c,(function(t){return t.forwardConversation})),d=new a.a(c,(function(t){return t.printConversation})),m=new a.a(c,(function(t){return t.replyToItem})),g=new a.a(c,(function(t){return t.forwardItem})),f=new a.a(c,(function(t){return t.printItem})),b=new a.a(c,(function(t){return t.showConversationInImmersiveReader})),p=new a.a(c,(function(t){return t.replyWithText})),h=new a.a(c,(function(t){return t.onKeyboardReply})),S=new a.a(c,(function(t){return t.onKeyboardForward}))},2021:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1366),o=n(318),i=n(267),a=n(77);function c(t){var e=Object(r.a)();switch(t){case 5:return(null==e?void 0:e.GoogleDriveAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==e?void 0:e.BoxAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-box");case 2:return(null==e?void 0:e.DropboxAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-dropbox");case 6:return(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-facebook");case 1:return!!Object(o.a)()||(null==e?void 0:e.OnedriveAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled);case 10:return Object(a.i)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-wopiClient");default:return Object(i.a)(t)}}},2047:function(t){t.exports=JSON.parse('{"a":"rxa","b":"sxa"}')},2083:function(t,e,n){"use strict";var r=n(627),o=n(2);function i(t,e,n){if(!t||!e||!n)throw new Error("Key and Value parameters should not be null");return t.indexOf("?")>0?t+"&"+e+"="+n:t+"?"+e+"="+n}n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return l}));var a=Object(o.I)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(t){var e=t?encodeURIComponent("?provider="+t):"",n=t&&6===t?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.l)()+"/mail/"+n+e}function u(t){var e=Object(r.l)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+t+"&url="+e);return a+"/ADPRedirect.aspx?"+n}function l(t,e,n,r,o,a){return function(){var t=function(){for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),e=t.length-1,n=[],r=0;r<16;r++)n.push(t[Math.round(Math.random()*e)]);return"owa_csrf_token_"+n.join("")}(),c=i(e,"client_id",r);if(c=i(c,"redirect_uri",n),c=i(c,"response_type",o),a){var u=a(t);c=Object.keys(u).reduce((function(t,e){return i(t,e,u[e])}),c)}return{authUrl:c,redirectUrl:n,csrfToken:t}}}},2095:function(t){t.exports=JSON.parse('{"b":"pxa","a":"qxa"}')},2134:function(t){t.exports=JSON.parse('{"b":"jxa","a":"kxa","e":"lxa","d":"mxa","f":"nxa","c":"oxa"}')},2187:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.action)("createFeedbackForCortana",(function(t,e,n,r,o){return{source:t,groupId:e,toRecipients:n,subject:r,body:o}}))},2202:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c}));var r=n(33),o=n(24),i=n(96);function a(){var t=Object(r.a)("targetServer"),e="DefaultAnchorMailbox"+(t?"_"+t.toLocaleLowerCase():"");return Object(r.a)(e)}function c(){var t,e,n=(t="",(e=Object(o.a)().pathname.split("/").filter((function(t){return t.length}))).length>=2&&e[1].match(/.+@.+/)&&(t=e[1]),t);if(0===n.length){var r=Object(i.h)();if(null==r?void 0:r.SessionSettings){var c=r.SessionSettings.ExternalDirectoryTenantGuid,u=r.SessionSettings.UserPuid;u&&c&&(n="PUID:"+u+"@"+c)}}return 0===n.length&&(n=a()),n}},2637:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"e",(function(){return l})),n.d(e,"f",(function(){return s})),n.d(e,"g",(function(){return d})),n.d(e,"h",(function(){return m}));var r=n(74),o=n(2887);n.d(e,"a",(function(){return o.a}));var i=new r.c((function(){return Promise.all([n.e(3),n.e(30),n.e(486)]).then(n.bind(null,6897))})),a=new r.b(i,(function(t){return t.clearCachedAttachmentSuggestions})),c=new r.b(i,(function(t){return t.getAttachmentSuggestionsAction})),u=new r.b(i,(function(t){return t.createCloudFileFromAttachmentData})),l=new r.b(i,(function(t){return t.getAttachmentSuggestionsMenuItems})),s=new r.b(i,(function(t){return t.getAttachmentSuggestionsTraceId})),d=new r.b(i,(function(t){return t.getAttachmentSuggestionsTraceIdByComposeId})),m=new r.a(i,(function(t){return t.logEntitiesFromFilePicker}))},2887:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Contextual=0]="Contextual",t[t.MRUCloudy=1]="MRUCloudy",t[t.MRUClassic=2]="MRUClassic",t[t.MRUContextual=3]="MRUContextual",t[t.MRUClassicContextual=4]="MRUClassicContextual"}(r||(r={}))},3106:function(t,e,n){"use strict";var r,o=n(74),i=n(4102),a=n(3),c=n(1305);Object(a.mutator)(i.a,(function(t){var e=t.itemId,n=t.isSmartSuggestionsRendered,r=t.suggestionTypesRendered,o=t.suggestionsRendered,i=t.extractionId,a=Object(c.g)().items.get(e);(null==a?void 0:a.SIGSData)&&(a.SIGSData.SmartPillData={IsSmartSuggestionsRendered:n,SuggestionTypesRendered:r,SuggestionsRendered:o,ExtractionId:i})}));!function(t){t.LanguageAndLocale="SmartPill_LanguageAndLocale",t.SmartDoc="SmartPill_SmartDoc",t.SmartReply="SmartPill_SmartReply",t.SmartTime="SmartPill_SmartTime"}(r||(r={}));var u=n(3220);function l(t){return{smartReplyComposeSIGSData:{isSmartSuggestionsClicked:!1,suggestionsClickedTime:null,clickIndex:-1},smartDocOption:t||u.a.None}}n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return l}));var s=new o.c((function(){return n.e(921).then(n.bind(null,16876))})),d=new o.a(s,(function(t){return t.logToSIGSOnMessageSent}))},3220:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.None=0]="None",t[t.FileSuggestion=1]="FileSuggestion",t[t.LocalFiles=2]="LocalFiles",t[t.CloudFiles=3]="CloudFiles",t[t.UploadAndShare=4]="UploadAndShare"}(r||(r={}))},3716:function(t,e,n){"use strict";var r=n(0),o=2500,i=n(266),a=n(323);function c(t,e,n){var r=new a.a(t,e,{isCore:!0,isCosmosDatapoint:!0});n&&r.addCosmosOnlyData(n),i.m.importAndExecute(r)}function u(t,e,n,a,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var l,s,d,m,g,f,b,p,h,S;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return l={},s=u||o,n?[4,Promise.all(n.map((function(t){return t.preRun().catch((function(e){l[t.getName()]=new Error(e)}))})))]:[3,2];case 1:r.sent(),r.label=2;case 2:return(d=new i.b("SmartPillPerformance",{sessionSampleRate:10})).addCustomProperty("preDefinedTimeout",s),[4,Promise.all(t.map((function(t){return Promise.race([t.buildPills(),(e=s,new Promise((function(t,n){setTimeout((function(){var t=new Error("timeout");t.networkError=!0,n(t)}),e)})))]).catch((function(e){return l[t.getName()]=new Error(e),[]}));var e}))).then((function(t){return d.end(),t}))];case 3:return m=r.sent(),g=[].concat.apply([],m),f=g.length,a?[4,Promise.all(a.map((function(t){return t.updateLogData(g).catch((function(e){l[t.getName()]=new Error(e)}))})))]:[3,5];case 4:r.sent(),r.label=5;case 5:b={pillsToShow:[],pillsToHide:[],arbitratorId:""};try{b=e.arbitratePills(g)}catch(t){l.arbitrator=new Error(t)}return(p=Object.keys(l)).length>0&&(h=[],S=[],p.forEach((function(t){var e=l[t];e.hasOwnProperty("networkError")?h.push(t+"_"+e.message):S.push(t+"_"+e.message)})),c("SmartPillError",[h.toString(),S.toString(),f])),[2,b]}}))}))}function l(t,e,n,r,o){return{mainPayload:{renderStory:0,loggableText:e,type:t,position:-1,EID:n,confidenceScore:r},cosmosOnlyData:o}}function s(t,e,n){var r=void 0;t.concat(e).forEach((function(t){!r&&t.logData.cosmosOnlyData&&(r=t.logData.cosmosOnlyData)}));var o={data:t.map((function(t){return t.logData.mainPayload}))},i={data:e.map((function(t){return t.logData.mainPayload}))};c("SmartPillsRendered",[t.length,e.length,JSON.stringify(o),JSON.stringify(i),n],r)}function d(t,e,n,r,o,i,a){c("SmartReply_Rendered",[t,!1,e.join("$"),!1,n.toString(),r.toString(),o,i],a)}function m(t,e,n){var o=(new Date).toISOString(),i={data:[Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e.mainPayload),{timeClicked:o}),n)]};c(t,[JSON.stringify(i)],e.cosmosOnlyData)}function g(t,e,n,r,o,i,a,u){c("SmartReply_Clicked",[t,e,n,!1,r,o,i,u],a)}n.d(e,"h",(function(){return u})),n.d(e,"i",(function(){return l})),n.d(e,"l",(function(){return s})),n.d(e,"m",(function(){return d})),n.d(e,"j",(function(){return m})),n.d(e,"k",(function(){return g})),n.d(e,"n",(function(){return c})),n.d(e,"d",(function(){return"SmartPillClicked"})),n.d(e,"e",(function(){return"SmartPillMenuOpened"})),n.d(e,"g",(function(){return"SmartTimeMenuClicked"})),n.d(e,"a",(function(){return"SmartDocMenuClicked"})),n.d(e,"b",(function(){return"SmartDocMenuClosed"})),n.d(e,"c",(function(){return"SmartDocSpinnerDisposed"})),n.d(e,"f",(function(){return"SmartReplyMenuClicked"}))},400:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u}));var r=n(0),o=n(14),i=n(342),a=function(){return{position:"absolute",width:1,right:31,top:8,bottom:8}};function c(t){var e,n,i,c,u,l=t.semanticColors,s=t.palette,d=l.buttonBackground,m=l.buttonBackgroundPressed,g=l.buttonBackgroundHovered,f=l.buttonText,b=l.buttonTextHovered,p=l.buttonTextChecked,h=l.buttonTextCheckedHovered;return{root:{backgroundColor:d,color:f},rootHovered:{backgroundColor:g,color:b,selectors:(e={},e[o.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},e)},rootPressed:{backgroundColor:m,color:p},rootExpanded:{backgroundColor:m,color:p},rootChecked:{backgroundColor:m,color:p},rootCheckedHovered:{backgroundColor:m,color:h},rootDisabled:{selectors:(n={},n[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},n)},splitButtonContainer:{selectors:(i={},i[o.HighContrastSelector]={border:"none"},i)},splitButtonMenuButton:{color:s.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:s.neutralLight,selectors:(c={},c[o.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:l.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:l.buttonBackgroundDisabled}}},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},a()),{backgroundColor:s.neutralTertiaryAlt,selectors:(u={},u[o.HighContrastSelector]={backgroundColor:"WindowText"},u)}),splitButtonDividerDisabled:{backgroundColor:t.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:s.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:s.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:s.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:s.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:l.buttonText},splitButtonMenuIconDisabled:{color:l.buttonTextDisabled}}}function u(t){var e,n,c,u,l,s,d,m,g,f=t.palette,b=t.semanticColors;return{root:{backgroundColor:b.primaryButtonBackground,border:"1px solid "+b.primaryButtonBackground,color:b.primaryButtonText,selectors:(e={},e[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},e["."+i.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:f.white}}},e)},rootHovered:{backgroundColor:b.primaryButtonBackgroundHovered,border:"1px solid "+b.primaryButtonBackgroundHovered,color:b.primaryButtonTextHovered,selectors:(n={},n[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},n)},rootPressed:{backgroundColor:b.primaryButtonBackgroundPressed,border:"1px solid "+b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed,selectors:(c={},c[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},c)},rootExpanded:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed},rootChecked:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed},rootDisabled:{selectors:(u={},u[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},u)},splitButtonContainer:{selectors:(l={},l[o.HighContrastSelector]={border:"none"},l)},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},a()),{backgroundColor:f.white,selectors:(s={},s[o.HighContrastSelector]={backgroundColor:"Window"},s)}),splitButtonMenuButton:{backgroundColor:b.primaryButtonBackground,color:b.primaryButtonText,selectors:(d={},d[o.HighContrastSelector]={backgroundColor:"WindowText"},d[":hover"]={backgroundColor:b.primaryButtonBackgroundHovered,selectors:(m={},m[o.HighContrastSelector]={color:"Highlight"},m)},d)},splitButtonMenuButtonDisabled:{backgroundColor:b.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:b.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:b.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:b.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:b.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:b.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:b.primaryButtonText},splitButtonMenuIconDisabled:{color:f.neutralTertiary,selectors:(g={},g[o.HighContrastSelector]={color:"GrayText"},g)}}}},4102:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.action)("initializeSIGSDataAction",(function(t,e,n,r,o){return{itemId:t,isSmartSuggestionsRendered:e,suggestionTypesRendered:n,suggestionsRendered:r,extractionId:o}}))},431:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),o={shouldEventsEndEarly:void 0,shortenEventScope:void 0,endShortEventsBy:void 0,endLongEventsBy:void 0,enableOnlineMeetingsByDefault:void 0},i=Object(r.createStore)("CalendarCloudSettings",o)},463:function(t,e,n){"use strict";var r=n(0),o=n(1),i=n(394),a=n(461),c=n(460),u=n(14),l=n(234),s=n(395),d=n(428),m=n(400),g=Object(l.c)((function(t,e,n){var r=Object(s.a)(t),o=Object(d.a)(t),i={root:{minWidth:"80px",height:"32px"},label:{fontWeight:u.FontWeights.semibold}};return Object(u.concatStyleSets)(r,i,n?Object(m.a)(t):Object(m.b)(t),o,e)}));n.d(e,"a",(function(){return f}));var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.__extends)(e,t),e.prototype.render=function(){var t=this.props,e=t.primary,n=void 0!==e&&e,c=t.styles,u=t.theme;return o.createElement(i.a,Object(r.__assign)({},this.props,{variantClassName:n?"ms-Button--primary":"ms-Button--default",styles:g(u,c,n),onRenderDescription:a.b}))},e=Object(r.__decorate)([Object(c.a)("DefaultButton",["theme","styles"],!0)],e)}(o.Component)},473:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.EndEarly="End_Early",t.StartLate="Start_Late",t.None="None"}(r||(r={}))},5198:function(t){t.exports=JSON.parse('{"b":"U8a","a":"V8a","c":"W8a","d":"X8a"}')},545:function(t,e,n){"use strict";var r=n(178);function o(t){return Object(r.f)()&&0!==t?t<60?Object(r.c)():Object(r.b)():0}var i=n(782);function a(){var t=Object(i.a)(),e=o(t);return Math.max(t-e,0)}var c,u=n(10);function l(t,e){if(!Object(r.g)())return e;var n=o(Object(u.x)(e,t)),i=n?Object(u.ec)(e,n):e;return Object(u.Gb)(t,i)?i:e}function s(t,e){if(!Object(r.h)())return t;var n=o(Object(u.x)(e,t)),i=n?Object(u.h)(t,n):t;return Object(u.Gb)(i,e)?i:t}function d(t,e){return{start:s(t,e),end:l(t,e)}}function m(t,e,n,o){var i=Object(u.x)(e,t),a=Object(u.x)(o,n),l=60-Object(r.b)();return 0===i&&0!==a&&a<l?c.ZeroToShort:0===i&&a>=l?c.ZeroToLong:0===a&&0!==i&&i<l?c.ShortToZero:0===a&&i>=l?c.LongToZero:i<l&&a<l||i>=l&&a>=l?c.None:i<l&&a>=l?c.ShortToLong:i>=l&&a<l?c.LongToShort:null}function g(t,e,n,o,i,a){if(!Object(r.h)())return n;var l=m(t,e,n,o),s=i?n:t,d=n;return l===c.ShortToLong?d=Object(u.h)(Object(u.ec)(s,Object(r.c)()),Object(r.b)()):l===c.LongToShort?d=Object(u.h)(Object(u.ec)(s,Object(r.b)()),Object(r.c)()):l!==c.ZeroToShort||a?l!==c.ZeroToLong||a||(d=Object(u.h)(s,Object(r.b)())):d=Object(u.h)(s,Object(r.c)()),Object(u.Gb)(d,o)?d:n}function f(t,e,n,o){if(!Object(r.g)())return o;var i=m(t,e,n,o),a=o;return i===c.ShortToLong?a=Object(u.ec)(Object(u.h)(o,Object(r.c)()),Object(r.b)()):i===c.LongToShort?a=Object(u.ec)(Object(u.h)(o,Object(r.b)()),Object(r.c)()):i===c.ZeroToShort?a=Object(u.ec)(o,Object(r.c)()):i===c.ZeroToLong&&(a=Object(u.ec)(o,Object(r.b)())),Object(u.Gb)(n,a)?a:o}function b(t,e){if(!Object(r.h)())return e;var n=Object(r.c)(),o=Object(r.b)();return t>=60-o?Object(u.h)(e,o):Object(u.h)(e,n)}function p(t,e,n,r){return Object(u.Hb)(e,r)?f(t,e,n,r):l(n,r)}function h(t,e,n,r){return Object(u.Hb)(t,n)?g(t,e,n,r):s(n,r)}function S(t,e,n,r){return{start:h(t,e,n,r),end:p(t,e,n,r)}}!function(t){t[t.None=0]="None",t[t.ShortToLong=1]="ShortToLong",t[t.LongToShort=2]="LongToShort",t[t.ZeroToShort=3]="ZeroToShort",t[t.ZeroToLong=4]="ZeroToLong",t[t.ShortToZero=5]="ShortToZero",t[t.LongToZero=6]="LongToZero"}(c||(c={})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return l})),n.d(e,"d",(function(){return s})),n.d(e,"g",(function(){return d})),n.d(e,"f",(function(){return g})),n.d(e,"c",(function(){return f})),n.d(e,"e",(function(){return b})),n.d(e,"h",(function(){return S}))},5735:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return l})),n.d(e,"f",(function(){return s})),n.d(e,"h",(function(){return d})),n.d(e,"i",(function(){return g})),n.d(e,"g",(function(){return f}));var r=n(474),o=n(77),i="Language",a="Locale",c="LanguageScores",u="@EntityId",l="EntityExtraction/ExtractLanguage1.0",s=Object(r.a)({PropertyName:l,DistinguishedPropertySetId:"Common",PropertyType:"String"}),d=Object(r.a)({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),m=Object(o.i)("mc-smartReplyWithMeeting-MeetingScheduler")?"EntityExtraction/CalendarRelated1.0":"EntityExtraction/Events1.0",g=Object(r.a)({PropertyName:m,DistinguishedPropertySetId:"Common",PropertyType:"String"}),f=Object(r.a)({PropertyName:"EntityExtraction/SendContentRequestV21.0",DistinguishedPropertySetId:"Common",PropertyType:"String"})},636:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(645),o=n(639),i=n(473);function a(){var t=Object(r.a)();return t?t===i.a.EndEarly:Object(o.a)()}},637:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(645),o=n(473);function i(){return Object(r.a)()===o.a.StartLate}},638:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(431);function o(){return Object(r.a)().enableOnlineMeetingsByDefault}},639:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(640),o=n(77),i=!1;function a(){if(!Object(o.i)("cal-mf-shouldEventsEndEarlySetting"))return!1;var t=Object(r.a)();return null!=t?t:i}},640:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(431);function o(){return Object(r.a)().shouldEventsEndEarly}},641:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(431);function o(){return Object(r.a)().shortenEventScope}},645:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(473),o=n(641),i=n(77),a=r.a.None;function c(){if(!Object(i.i)("cal-mf-shortenEventsDuration"))return null;var t=Object(o.a)();return null!=t?t:a}},7435:function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return l}));var r=n(0),o=n(266),i=n(1305),a=n(56),c=4e3;function u(t){var e,n;if(t.SIGSData&&t.SIGSData.SmartPillData){var r=t.SIGSData.SmartPillData,i=r.IsSmartSuggestionsRendered,u=r.SuggestionTypesRendered,l=r.SuggestionsRendered,s=r.ExtractionId,d=t.InternetMessageId,m=(null===(e=t.UniqueBody)||void 0===e?void 0:e.Value)||(null===(n=t.NormalizedBody)||void 0===n?void 0:n.Value);if(m&&(m=m.substring(0,c)),"True"===i){var g={InternetMessageId:d,MessageBody:m,SuggestionTypesRendered:u,SuggestionsRendered:l,ExtractionId:s};return o.n.importAndExecute("SmartSuggestionsRendered",{compliance:"CustomerContent",customProperties:g}),!0}}else a.g.warn("SIGSData object not initialized on item.");return!1}function l(t,e,n){var u,l,s;try{if(t){var d=Object(i.g)().items.get(t);if(null===(u=null==d?void 0:d.SIGSData)||void 0===u?void 0:u.SmartPillData){var m=d.InternetMessageId,g=(null===(l=d.NormalizedBody)||void 0===l?void 0:l.Value)||(null===(s=d.UniqueBody)||void 0===s?void 0:s.Value);g&&(g=g.substring(0,c));var f=e.substring(0,c);o.n.importAndExecute("SmartSuggestionsClicked",{compliance:"CustomerContent",customProperties:Object(r.__assign)(Object(r.__assign)({InternetMessageId:m,MessageBody:g},d.SIGSData.SmartPillData),{IsSmartSuggestionsClicked:n&&n.isSmartSuggestionsClicked?"True":"False",SuggestionsClickedTime:null==n?void 0:n.suggestionsClickedTime,ClickIndex:n&&n.clickIndex.toString(),ReplyBody:f})})}}}catch(t){a.d("[logToSIGSOnMessageSent] Error: "+t.message)}}},772:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(636),o=n(637);function i(){return Object(o.a)()||Object(r.a)()}},773:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(638),o=n(77),i=!1;function a(){if(!Object(o.i)("cal-mf-enableDefaultOnlineMeetingSetting"))return!1;var t=Object(r.a)();return null!=t?t:i}},9145:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(74),o=new r.c((function(){return n.e(922).then(n.bind(null,11103))})),i=(Object(r.d)(o,(function(t){return t.SmartPill})),Object(r.d)(o,(function(t){return t.SmartPillBlock})))},942:function(t,e,n){"use strict";t.exports=function(t,e){return"string"!=typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),/["'() \t\n]/.test(t)||e?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}}}]);
//# sourceMappingURL=owa.MailBoot~MailSmartPill.js.map
self.scriptsLoaded['owa.MailBoot~MailSmartPill.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailSmartPill.js'] = (new Date()).getTime();