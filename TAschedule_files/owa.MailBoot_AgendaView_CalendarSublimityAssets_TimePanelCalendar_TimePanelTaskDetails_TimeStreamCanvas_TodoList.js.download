self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AgendaView~CalendarSublimityAssets~TimePanelCalendar~TimePanelTaskDetails~TimeStreamCanvas~TodoList.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[91],{1787:function(t,e,r){"use strict";var n=r(3),i=Object(n.action)("updateItem",(function(t,e,r){return{key:t,itemId:e,itemUpdates:r}})),u=Object(n.action)("replaceItems",(function(t,e){return{key:t,items:e}})),a=Object(n.action)("upsertItemsForDescriptor",(function(t,e,r,n){return{key:t,lockId:e,items:r,descriptor:n}})),o=Object(n.action)("addItem",(function(t,e){return{key:t,item:e}})),c=Object(n.action)("deleteItem",(function(t,e){return{key:t,itemId:e}})),s=r(20),d={};function f(t){return d[t]}var l=r(0);function b(t,e,r){var n=e.Id;return t.descriptors.has(n)||function(t,e,r){return Object(l.__spread)(t.descriptors.values()).some((function(t){return r(t,e)}))}(t,e,r)}var m={};function O(t){return m[t]}Object(n.mutator)(a,(function(t){var e=t.key,r=t.descriptor;b(f(e),r,O(e).containsDescriptor)||f(e).descriptors.set(r.Id,r)}));function p(t,e,r,n){var i=t.locks.get(e);return!!i&&(i.some((function(t){return t===r.Id}))||function(t,e,r,n){var i=t.locks.get(e),u=null==i?void 0:i.map((function(e){return t.descriptors.get(e)}));return!!u&&u.some((function(t){return t&&n(t,r)}))}(t,e,r,n))}Object(n.mutator)(a,(function(t){var e=t.key,r=t.lockId,n=t.descriptor,i=f(e),u=i.locks.get(r),a=O(e).containsDescriptor;u?p(i,r,n,a)||u.push(n.Id):f(e).locks.set(r,[n.Id])}));function v(t,e){return t.items.get(e)}function h(t,e){e.forEach((function(e){f(t).items.set(e.Id,e)}))}Object(n.mutator)(i,(function(t){var e=t.key,r=t.itemUpdates,n=t.itemId,i=v(f(e),n);i&&function(t,e,r){var n=Object(l.__assign)(Object(l.__assign)({},e),r);h(t,[n])}(e,i,r)})),Object(n.mutator)(u,(function(t){!function(t,e){f(t).items.clear(),h(t,e)}(t.key,t.items)})),Object(n.mutator)(a,(function(t){h(t.key,t.items)})),Object(n.mutator)(o,(function(t){h(t.key,[t.item])})),Object(n.mutator)(c,(function(t){!function(t,e){e.forEach((function(e){f(t).items.delete(e)}))}(t.key,[t.itemId])}));var j=0;function _(t,e,r,n){if(b(t,e,n)){var i=r(e);return Object(l.__spread)(t.items.values()).filter(i)}}var g,I=r(1571);function k(t){return t&&t.type===g.FolderId}function D(t){return t&&t.type===g.MyDay}function y(t){return t&&t.type===g.DueDate}!function(t){t.FolderId="FolderId",t.MyDay="MyDay",t.DueDate="DueDate"}(g||(g={}));var T=r(267);function w(t){return[S(t),C(t)].join(",")}function C(t){return k(t)?function(t){return[t.folderId].join(",")}(t):y(t)?function(t){return[t.startDate,t.endDate].join(",")}(t):D(t)?function(t){return[t.date].join(",")}(t):Object(T.a)(t)}function S(t){var e,r=[t.type.toString(),null===(e=t.isComplete)||void 0===e?void 0:e.toString()],n=t.maxCount?[t.maxCount,t.orderBy].join(","):void 0;return n&&r.push(n),r.join(",")}function F(t){return k(t)?I.b.FolderId:D(t)?I.b.MyDay:y(t)?I.b.DueDate:Object(T.a)(t)}function E(t){var e=t.isComplete;return!1===e?{taskStatusFilters:[{status:"Completed",equalityOperator:"ne"}]}:!0===e?{taskStatusFilters:[{status:"Completed",equalityOperator:"eq"}]}:{taskStatusFilters:[]}}function x(t){var e=t.maxCount,r={};return e&&(r={maxPageSize:e}),k(t)?r:D(t)?Object(l.__assign)(Object(l.__assign)({},r),{date:t.date}):y(t)?Object(l.__assign)(Object(l.__assign)({},r),{startDate:t.startDate,endDate:t.endDate}):Object(T.a)(t)}function L(t){var e=t.orderBy;return void 0!==e?e:I.c.OrderDateTime}var P=r(759),N={},R=3,B=null;function M(t){var e=this,r=w(t),n=N[r];return n||Object(l.__awaiter)(e,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,,2,3]),e=(null==B&&(B=Object(P.a)(R)),B).add((function(){return Object(I.l)(function(t){return{type:F(t),filters:E(t),customQueryOptions:x(t),orderBy:L(t),expand:I.a.LinkedEntities,folderId:k(t)?t.folderId:void 0}}(t))})),N[r]=e,[4,e];case 1:return[2,n.sent()];case 2:return delete N[r],[7];case 3:return[2]}}))}))}var A,q=r(2250),U=r(56);function z(t){var e=L(t);switch(e){case I.c.CompletedDateTime:case I.c.OrderDateTime:return q.b;case I.c.CommittedOrder:return q.a;default:return Object(T.a)(e)}}function J(t){var e=L(t);switch(e){case I.c.CompletedDateTime:case I.c.OrderDateTime:return q.b;default:return U.g.warn("[getSubtodoCompareForDescriptor] Invalid order by value property for subtasks: "+e+". Falling back to OrderDateTime comparison."),q.b}}function H(t,e){return k(t)?function(t,e){var r=Object(l.__assign)({},t);r.folderId||(A=function(t){if(t.length>0)return t[0].ParentFolderId;return null}(e),r.folderId=A);return r}(t,e):t}function W(t){return k(t)?function(t){var e=Object(l.__assign)({},t);t.folderId||(e.folderId=A);return e}(t):t}function X(t){return function(e){return t.every((function(t){return t(e)}))}}function V(t){return function(e){return!0===t?"Completed"===e.Status:"Completed"!==e.Status}}var $=r(10);var G=function(t){return!!t.CommittedDay};var K=r(539);var Q=function(t){var e=f(t.cacheId),r=O(t.cacheId);r&&e||(e=function(t){return d[t]||(d[t]=Object(n.createStore)(t,{key:t,items:new s.ObservableMap,descriptors:new s.ObservableMap,locks:new s.ObservableMap})()),d[t]}(t.cacheId),r=function(t,e){return m[t]=e,e}(t.cacheId,t.functions));var b=t.cacheId,h=r.buildItemDescriptorFilter,j=r.containsDescriptor;return{getItems:function(t){return _(e,t,h,j)},getDescriptors:function(){return function(t){return Object(l.__spread)(t.descriptors.values())}(e)},getItemsForLock:function(t,r){return function(t,e,r,n,i){if(p(t,e,r,i)){var u=n(r);return Object(l.__spread)(t.items.values()).filter(u)}}(e,t,r,h,j)},getItemIds:function(t){return function(t,e,r,n){var i=_(t,e,r,n);return i?i.map((function(t){return t.Id})):void 0}(e,t,h,j)},selectItemById:function(t){return v(e,t)},selectItemByIdForLock:function(t,r){return function(t,e,r){return t.items.get(r)}(e,0,r)},upsertItemsForDescriptor:function(t,e,r){return a(b,t,e,r)},replaceItems:function(t){return u(b,t)},updateItem:function(t,e){return i(b,t,e)},addItem:function(t){return o(b,t)},deleteItem:function(t){return c(b,t)}}}({cacheId:"todo_item_cache",functions:{containsDescriptor:function(t,e){if(t.type!==e.type)return!1;if(k(t))return t.Id===e.Id;if(y(t)){if(t.isComplete!==e.isComplete)return!1;var r={start:t.startDate,end:t.endDate},n={start:e.startDate,end:e.endDate};return Object(K.c)(r,n,!0)}return D(t)?t.Id===e.Id:Object(T.a)(t)},buildItemDescriptorFilter:function(t){return k(t)?(n=[(r=(e=t).folderId,function(t){return t.ParentFolderId===r})],void 0!==e.isComplete&&n.push(V(e.isComplete)),X(n)):D(t)?function(t){var e,r=[G,(e=t.date,function(t){return Object($.Ib)(e,t.CommittedDay)})];return void 0!==t.isComplete&&r.push(V(t.isComplete)),X(r)}(t):y(t)?function(t){var e,r,n=[(e=t.startDate,r=t.endDate,function(t){return!!t.DueDateTime&&Object(K.t)({start:e,end:r},t.DueDateTime)})];return void 0!==t.isComplete&&n.push(V(t.isComplete)),X(n)}(t):Object(T.a)(t);var e,r,n}}});function Y(){return Q}var Z=Object(n.action)("UPDATE_TODO_LOAD_STATE",(function(t,e){return{id:t,loadState:e}})),tt=Object(n.createStore)("todoCacheLoadStateStore",{loadState:new s.ObservableMap});function et(t,e,r){return Object(l.__awaiter)(this,void 0,void 0,(function(){var n,i,u,a,o,c;return Object(l.__generator)(this,(function(s){switch(s.label){case 0:n=w(e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r];case 2:return i=s.sent(),[3,4];case 3:return s.sent(),Z(n,"Error"),[2,[]];case 4:return(u=J(e))&&i.forEach((function(t){var e;return null===(e=t.Subtasks)||void 0===e?void 0:e.sort(u)})),a=H(e,i),o=w(a),c=Object(l.__assign)(Object(l.__assign)({},a),{Id:o}),Y().upsertItemsForDescriptor(t,i,c),Z(n,"Loaded"),[2,i]}}))}))}Object(n.mutator)(Z,(function(t){var e=t.id,r=t.loadState;tt().loadState.set(e,r)}));var rt=r(336);var nt=r(472),it=r(290);function ut(t,e,r){t[e]||(t[e]=r)}function at(t,e){delete t[e]}function ot(t){return Object.keys(t).length}function ct(t,e){Object.keys(t).map((function(e){return t[e]})).reduce(st,[]).forEach((function(t){return t.callback(e)}))}function st(t,e){return t.some((function(t){return t.callbackId===e.callbackId}))||t.push(e),t}var dt,ft,lt=r(677);function bt(t){return(null==t?void 0:t.Type)===dt.Task}function mt(t){return function(t){return(null==t?void 0:t.Type)===dt.Setting}(t)||bt(t)||function(t){return(null==t?void 0:t.Type)===dt.TaskFolder}(t)}!function(t){t.Setting="Setting",t.Task="Task",t.TaskFolder="TaskFolder"}(dt||(dt={})),function(t){t.Created="Created",t.Updated="Updated",t.Deleted="Deleted"}(ft||(ft={}));var Ot,pt,vt,ht="https://substrate.office.com/todo/api/v1/realtime",jt=Object(lt.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(lt.a)(1e3)});function _t(t,e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r;return Object(l.__generator)(this,(function(n){switch(n.label){case 0:if(vt||(vt={}),ut(vt,t,e),pt)return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,(pt=jt((function(){return t=function(t){return t.forEach((function(t){return ct(vt,t)}))},new Promise((function(e,r){(Ot=new XMLHttpRequest).onload=function(t){Object(rt.a)(Ot.status)?e():r()},Ot.onerror=function(){r()},Ot.ontimeout=function(){r()},Ot.open("GET",ht);var n=0;Ot.onreadystatechange=function(){if(Ot.readyState>2){var e=function(t){for(var e=0,r=0,n=0,i=!1,u=[],a=0;a<t.length;a++)"{"===t[a]?(0===r&&(e=a),r++):'"'===t[a]&&"\\"!==t[a-1]&&(i=!i),i||"}"!==t[a]||0==--r&&u.push(t.substring(e,a+1));r>0&&u.push(t.substring(e));var o=u.reduce((function(t,e){var r;try{r=JSON.parse(e)}catch(t){n+=e.length}return r&&t.push(r),t}),[]);return{unparsedBytes:n,parsedItems:o}}(Ot.responseText.substring(n)),r=e.unparsedBytes,i=e.parsedItems;if(n=Ot.responseText.length-r,i){var u=i.filter(mt);t(u)}}},function(t){return Object(l.__awaiter)(this,void 0,void 0,(function(){var e,r,n,i;return Object(l.__generator)(this,(function(u){switch(u.label){case 0:return e=Object(l.__read)(Object(nt.getAccessTokenforResourceAsLazy)(window.location.origin),2),r=e[0],n=e[1],r?[3,2]:[4,n];case 1:r=u.sent(),u.label=2;case 2:return t.setRequestHeader("Authorization","Bearer "+r),t.setRequestHeader("Content-Type","application/json"),(i=Object(it.d)().mailboxSmtpAddress)&&t.setRequestHeader("X-AnchorMailbox",i),[2]}}))}))}(Ot).then((function(){Ot.send()}))}));var t}))).retriableFunc()];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),U.g.warn("[owa-todo-notifications] subscribe: subscribe with retry failed: "+r),pt=void 0,[3,4];case 4:return[2]}}))}))}var gt,It=r(2535),kt=6e5,Dt="RELOAD_TASKS";function yt(t){if(bt(t)){var e,r=t.Operation,n=t.Payload,i=t.Id;switch(r){case ft.Updated:var u=n&&!Object(I.n)(n)?Object(I.o)(n):null;u&&Y().updateItem(i,u);break;case ft.Created:var a=n&&!Object(I.n)(n)?Object(I.o)(n):null;a&&(e=a,void 0===Y().selectItemById(e.CreatedWithLocalId))&&Y().addItem(a);break;case ft.Deleted:Y().deleteItem(i);break;default:Object(T.a)(r)}}}var Tt=5;function wt(){return Object(l.__awaiter)(this,void 0,void 0,(function(){var t,e,r,n,i;return Object(l.__generator)(this,(function(u){switch(u.label){case 0:if(!(t=Y().getDescriptors()))return[2];e=[],r=!1,n=0,u.label=1;case 1:return n<t.length?(i=t.slice(n,n+Tt).map((function(t){return M(t).then((function(n){!n||n.errorResponse?r=!0:e.push.apply(e,Object(l.__spread)(function(t,e){var r=e.map(I.o),n=J(t);return n&&r.forEach((function(t){var e;return null===(e=t.Subtasks)||void 0===e?void 0:e.sort(n)})),r}(t,n.Value)))}))})),[4,Promise.all(i)]):[3,4];case 2:u.sent(),u.label=3;case 3:return n+=Tt,[3,1];case 4:return r?e.forEach((function(t){return Y().addItem(t)})):Y().replaceItems(e),[2]}}))}))}function Ct(t){return{fetchTasks:function(e,r){return function(t,e,r){return void 0===r&&(r=!1),Object(l.__awaiter)(this,void 0,void 0,(function(){var n,i,u;return Object(l.__generator)(this,(function(a){return n=w(e),u=Object(l.__assign)(Object(l.__assign)({},e),{Id:n}),Y().getItems(u)&&!r?i=Promise.resolve(Y().getItems(u)):(Z(n,"Fetching"),i=M(e).then((function(t){if(null==t?void 0:t.errorResponse)throw Error("Unable to fetch tasks "+(null==t?void 0:t.errorResponse));return t.Value.map(I.o)}))),[2,et(t,e,i)]}))}))}(t,e,r)},getTasksLoadState:function(t){return function(t){var e=tt().loadState.get(t);return e||"None"}(w(t))},getItemsForLock:function(e){var r,n=W(e),i=w(n),u=z(n),a=J(n),o=null===(r=Y().getItemsForLock(t,Object(l.__assign)(Object(l.__assign)({},n),{Id:i})))||void 0===r?void 0:r.sort(u);return o&&a?o.map((function(t){return t.Subtasks?St(t,a):t})):o},getTaskForLock:function(e,r){var n=Y().selectItemByIdForLock(t,e);return r&&(null==n?void 0:n.Subtasks)?St(n,J(W(r))):n},taskFolderAdded:function(e){if(k(e)){var r=w(e),n=Object(l.__assign)(Object(l.__assign)({},e),{Id:r});Y().upsertItemsForDescriptor(t,[],n)}},subscribeNotifications:function(){_t(t,{callback:yt,callbackId:"processTasks"}),gt||(gt={}),ut(gt,t,{callback:wt,callbackId:"reloadTodos"}),Object(It.b)((function(){return ct(gt,void 0)}),Dt,kt)},releaseLock:function(){var e;!function(t){Object(l.__awaiter)(this,void 0,void 0,(function(){return Object(l.__generator)(this,(function(e){return vt?(at(vt,t),0===ot(vt)&&(null==Ot||Ot.abort(),pt=void 0),[2]):[2]}))}))}(t),e=t,gt&&(at(gt,e),0===ot(gt)&&Object(It.a)(Dt))}}}function St(t,e){var r=Object(l.__assign)({},t),n=Object(l.__spread)(t.Subtasks);return n.sort(e),r.Subtasks=n,r}function Ft(){return Ct(function(){var t="item_cache_lock_"+j;return j++,t}())}var Et=r(361),xt=r(1858);function Lt(t,e,r){var n=[];return t.forEach((function(t){n.push(Object(I.f)(t,e,r))})),Promise.all(n)}function Pt(t,e,r){return Object(l.__awaiter)(this,void 0,void 0,(function(){var n,i,u,a;return Object(l.__generator)(this,(function(o){switch(o.label){case 0:return t?((n=t.map((function(t,r){return Object(xt.g)(Object(l.__assign)({Id:Object(Et.a)(),ParentFolderId:e},t))}))).forEach(Y().addItem),i=n.map((function(t){return t.Id})),[4,Lt(n,e,r)]):[2,{items:[],success:!0}];case 1:return u=o.sent(),a=u.filter((function(t){return null!==t})),i.forEach(Y().deleteItem),a.forEach(Y().addItem),[2,{items:a,success:a.length===u.length}]}}))}))}function Nt(t,e){if(null==e?void 0:e.hasOwnProperty("Subtasks"))return U.g.warn("Call to 'updateTodo' should not update Subtasks. Instead, call 'updateSubtodo'"),Promise.resolve(!1);var r=Object(I.j)(e);return r?(Y().updateItem(t,e),Object(I.r)(r,t)):Promise.resolve(!0)}function Rt(t){Y().deleteItem(t),Object(I.h)(t)}function Bt(t,e,r){var n=[];return t.forEach((function(t){n.push(Object(I.d)(e,t,r))})),Promise.all(n)}function Mt(t,e,r){var n,i;return Object(l.__awaiter)(this,void 0,void 0,(function(){var u,a,o,c,s,d,f,b,m,O,p,v,h,j;return Object(l.__generator)(this,(function(_){switch(_.label){case 0:return u=Y().selectItemById(e),!t||t.length<=0||!u?[2,{items:[],success:!0}]:(a=u.Subtasks,o=null!==(n=null==a?void 0:a.length)&&void 0!==n?n:0,c=t.length,s=null==a?void 0:a[o-1],d=null==s?Object($.Pb)():Object($.f)(s.OrderDateTime,-1),f=t.map((function(t,e){var r=Object($.f)(d,-e);return Object(xt.f)(Object(l.__assign)({Id:Object(Et.a)(),OrderDateTime:r},t))})),b=a?Object(l.__spread)(a,f):f,Y().updateItem(e,{Subtasks:b}),[4,Bt(f,e,r)]);case 1:if(m=_.sent(),O=m.filter((function(t){return null!==t})),p=null===(i=Y().selectItemById(e))||void 0===i?void 0:i.Subtasks,v=[],p){for(v=Object(l.__spread)(p),h=0;h<c;++h)v[o+h]=m[h];j=v.filter((function(t){return null!==t})),Y().updateItem(e,{Subtasks:j})}else U.d("[createSubtodos] Subtodo local lies were not properly placed inside cache.");return[2,{items:O,success:O.length===m.length}]}}))}))}function At(t,e,r){var n;return Object(l.__awaiter)(this,void 0,void 0,(function(){var i,u,a,o,c;return Object(l.__generator)(this,(function(s){switch(s.label){case 0:return i=Object(I.i)(t),u=null===(n=Y().selectItemById(e))||void 0===n?void 0:n.Subtasks,i&&u?(a=function(t,e){for(var r=0,n=t.length;r<n;r++){var i=t[r];if(e(i))return{item:i,index:r}}return null}(u,(function(t){return t.Id===r})))?((o=Object(l.__spread)(u))[a.index]=Object(l.__assign)(Object(l.__assign)({},a.item),t),Y().updateItem(e,{Subtasks:o}),[4,Object(I.p)(e,r,i)]):[2,!0]:[2,!0];case 1:return(c=s.sent())||Y().updateItem(e,{Subtasks:u}),[2,c]}}))}))}function qt(t,e){var r;return Object(l.__awaiter)(this,void 0,void 0,(function(){var n,i,u;return Object(l.__generator)(this,(function(a){switch(a.label){case 0:return!(n=null===(r=Y().selectItemById(t))||void 0===r?void 0:r.Subtasks)||n.length<=0?[2,!0]:(i=n.filter((function(t){return t.Id!==e})),Y().updateItem(t,{Subtasks:i}),[4,Object(I.g)(t,e)]);case 1:return(u=a.sent())||Y().updateItem(t,{Subtasks:n}),[2,u]}}))}))}r.d(e,"c",(function(){return Ft})),r.d(e,"d",(function(){return Pt})),r.d(e,"i",(function(){return Nt})),r.d(e,"f",(function(){return Rt})),r.d(e,"b",(function(){return Mt})),r.d(e,"h",(function(){return At})),r.d(e,"e",(function(){return qt})),r.d(e,"g",(function(){return z})),r.d(e,"a",(function(){return g}))},187:function(t,e,r){"use strict";function n(){var t=Object.create(null),e=0,r=0,n=0,i=!1;function u(e){n--,delete t[e]}this.put=function(e,r,i,a){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var o=t[e];o?clearTimeout(o.timeout):n++;var c={value:r,expire:i+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){u(e),a&&a(e,r)}.bind(this),i)),t[e]=c,r},this.del=function(e){var r=!0,n=t[e];return n?(clearTimeout(n.timeout),!isNaN(n.expire)&&n.expire<Date.now()&&(r=!1)):r=!1,r&&u(e),r},this.clear=function(){for(var u in t)clearTimeout(t[u].timeout);n=0,t=Object.create(null),i&&(e=0,r=0)},this.get=function(u){var a=t[u];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return i&&e++,a.value;i&&r++,n--,delete t[u]}else i&&r++;return null},this.size=function(){return n},this.memsize=function(){var e,r=0;for(e in t)r++;return r},this.debug=function(t){i=t},this.hits=function(){return e},this.misses=function(){return r},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var r in t){var n=t[r];e[r]={value:n.value,expire:n.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,r){var n=JSON.parse(e),i=Date.now(),u=r&&r.skipDuplicates;for(var a in n)if(n.hasOwnProperty(a)){if(u)if(t[a])continue;var o=n[a],c=o.expire-i;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,o.value,c)}return this.size()}}t.exports=new n,t.exports.Cache=n},2250:function(t,e,r){"use strict";var n=r(4644),i=r(11);function u(){return Object(i.b)(n.a)}var a=r(10);function o(t){var e=t||Object(a.Pb)(),r=Object(a.Wb)(e),n=Object(a.e)(r,1);return Object(a.f)(n,11)}function c(t){return t.IsDefaultFolder?u():"Commitments"===t.FolderType?t.Name:"FlaggedEmails"===t.FolderType?Object(i.b)(n.b):t.Name}function s(t){return"FlaggedEmails"===t.FolderType}var d=r(1858);function f(t){return t===d.e.High}var l=function(t,e){return void 0===e&&(e=Object(a.Pb)()),Object(a.u)(Object(a.Wb)(e),Object(a.Wb)(t))>0};function b(t){return!!t.CommittedDay&&Object(a.Ib)(t.CommittedDay,Object(a.kc)())}var m=function(t){return"Completed"===t},O=r(0);function p(t){var e=[],r=null,n=null,i=null;t.forEach((function(t){t.IsDefaultFolder?(r=Object(O.__assign)({},t)).Name=c(t):"Commitments"===t.FolderType?(n=Object(O.__assign)({},t)).Name=c(t):"FlaggedEmails"===t.FolderType?(i=Object(O.__assign)({},t)).Name=c(t):e.push(t)}));var u=e.sort((function(t,e){return t.OrderDateTime&&e.OrderDateTime?Object(a.p)(e.OrderDateTime,t.OrderDateTime):t.OrderDateTime?-1:e.OrderDateTime?1:0}));return n&&u.splice.apply(u,Object(O.__spread)([0,0],[n])),i&&u.splice.apply(u,Object(O.__spread)([0,0],[i])),r&&u.splice.apply(u,Object(O.__spread)([0,0],[r])),u}function v(t,e){return Object(a.Eb)(t.OrderDateTime,e.OrderDateTime)?-1:1}function h(t,e){return Object(a.Eb)(t.CommittedOrder,e.CommittedOrder)?-1:1}var j=r(267),_=36e5;function g(t,e,r){if(0===e.length)return{};if(t>=e.length)return function(t,e){switch(e){case"CommittedOrder":return{CommittedOrder:Object(a.g)(t.CommittedOrder,-_)};case"OrderDateTime":return k(t);default:return Object(j.a)(e)}}(e[e.length-1],r);if(0===t)return function(t,e){var r=Object(a.Pb)();switch(e){case"CommittedOrder":return{CommittedOrder:T(Object(a.Eb)(t.CommittedOrder,r)?Object(a.g)(t.CommittedOrder,_):r,t.CommittedOrder)};case"OrderDateTime":return D(t);default:return Object(j.a)(e)}}(e[t],r);var n=e[t];return function(t,e,r){switch(r){case"CommittedOrder":return{CommittedOrder:T(t.CommittedOrder,e.CommittedOrder)};case"OrderDateTime":return y(t,e);default:return Object(j.a)(r)}}(e[t-1],n,r)}function I(t,e){if(0===e.length)return{};if(t>=e.length)return function(t,e){switch(e){case"OrderDateTime":return k(t);default:return Object(j.a)(e)}}(e[e.length-1],"OrderDateTime");if(0===t)return function(t,e){switch(e){case"OrderDateTime":return D(t);default:Object(j.a)(e)}}(e[t],"OrderDateTime");var r=e[t];return function(t,e,r){switch(r){case"OrderDateTime":return y(t,e);default:return Object(j.a)(r)}}(e[t-1],r,"OrderDateTime")}function k(t){return{OrderDateTime:Object(a.g)(t.OrderDateTime,-_)}}function D(t){var e=Object(a.Pb)();return{OrderDateTime:T(Object(a.Eb)(t.OrderDateTime,e)?Object(a.g)(t.OrderDateTime,_):e,t.OrderDateTime)}}function y(t,e){return{OrderDateTime:T(t.OrderDateTime,e.OrderDateTime)}}function T(t,e){var r=Object(a.w)(t,e)/2;return Object(a.g)(e,r)}r.d(e,"d",(function(){return u})),r.d(e,"c",(function(){return o})),r.d(e,"e",(function(){return c})),r.d(e,"h",(function(){return s})),r.d(e,"i",(function(){return f})),r.d(e,"k",(function(){return l})),r.d(e,"j",(function(){return b})),r.d(e,"l",(function(){return m})),r.d(e,"m",(function(){return p})),r.d(e,"b",(function(){return v})),r.d(e,"a",(function(){return h})),r.d(e,"f",(function(){return g})),r.d(e,"g",(function(){return I}))},322:function(t,e,r){"use strict";r.d(e,"b",(function(){return u})),r.d(e,"a",(function(){return a}));var n,i=r(0);function u(t){n=t}function a(){var t,e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(u=n)?[4,n()]:[3,2];case 1:u=i.sent(),i.label=2;case 2:if((r=u)&&r.length>0){if("bearer"===(null===(t=null==r?void 0:r.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,r.split(" ")[1]];if("msauth1.0"===(null===(e=null==r?void 0:r.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,r]}return[2,void 0]}}))}))}},447:function(t,e,r){"use strict";var n=function(){function t(t,e,r){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=r,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();r.d(e,"a",(function(){return n}))},4644:function(t){t.exports=JSON.parse('{"a":"Xda","b":"Yda"}')}}]);
//# sourceMappingURL=owa.MailBoot~AgendaView~CalendarSublimityAssets~TimePanelCalendar~TimePanelTaskDetails~TimeStreamCanvas~TodoList.js.map
self.scriptsLoaded['owa.MailBoot~AgendaView~CalendarSublimityAssets~TimePanelCalendar~TimePanelTaskDetails~TimeStreamCanvas~TodoList.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AgendaView~CalendarSublimityAssets~TimePanelCalendar~TimePanelTaskDetails~TimeStreamCanvas~TodoList.js'] = (new Date()).getTime();