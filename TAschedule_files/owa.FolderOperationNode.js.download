self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FolderOperationNode.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[415],{12528:function(e){e.exports=JSON.parse('{"a":"mxb","b":"nxb","c":"oxb"}')},1342:function(e,n){e.exports=function(e){if(!e.webpackPolyfill){var n=Object.create(e);n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),Object.defineProperty(n,"exports",{enumerable:!0}),n.webpackPolyfill=1}return n}},17423:function(e,n,i){"use strict";i.r(n);var t=i(0),a=i(2454),l=i(96),r=i(1),o=i(2176),d=i(47),c=i(5939),u=i(388).bind(c),m=Object(d.a)((function(e){return r.createElement(a.a,{className:u(Object(l.d)(),c.nodeHeight),depth:e.nestDepth,defaultValue:e.defaultValue,key:"folderTextField",onEntry:e.onEntry,onDismiss:s,folderId:e.folderId})}));function s(){o.c.importAndExecute()}var b=i(12528),p=i(11),f=i(1709),v=i(1306),k=i(5489),N=i(2989),y=i(1997),O={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"RenameFolder"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"newDisplayName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"renameFolder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"newDisplayName"},value:{kind:"Variable",name:{kind:"Name",value:"newDisplayName"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"DisplayName"},arguments:[],directives:[]}]}}]}}]},j=i(1438),g=i(3),x=i(1291),w=Object(g.mutatorAction)("setFolderName",(function(e,n){Object(x.o)().get(e).DisplayName=n})),h=i(5);n.default=Object(d.a)((function(e){var n,i=Object(h.h)("apollo")&&Object(h.h)("gqlfolders"),a=Object(t.__read)(r.useState(""),2),l=a[0],d=a[1],c=Object(t.__read)(Object(y.useMutation)(O,{onError:function(){i||w(e.folderId,e.originalValue)}}),1)[0],u=r.useCallback((function(e){o.e.importAndExecute(e),d(Object(p.c)(Object(p.b)(b.b),e))}),[d]),s=r.useCallback((function(n,t){o.c.importAndExecute();var a=e.originalValue,l=(n||"").trim();if(l&&l!==a){var r=e.mailboxInfo;i||(w(t,l),r=Object(j.c)(t)),c({variables:{id:t,newDisplayName:l,mailboxInfo:r},optimisticResponse:{__typename:"Mutation",renameFolder:{id:t,__typename:"MailFolder",DisplayName:l}}});var u=e.ariaAnnouncementLabel||b.c;d(Object(p.c)(Object(p.b)(u),n))}}),[d]),g=r.useCallback((function(n){n.stopPropagation(),n.preventDefault(),Object(N.b)(e.folderId,"new",e.treeType)}),[e.folderId,e.treeType]);return"new"==e.operationType||"newNode"==e.operationType&&Object(k.a)(e.folderId,"new")?n=r.createElement(m,{nestDepth:e.nestDepth,onEntry:u}):"rename"==e.operationType?n=r.createElement(m,{nestDepth:e.nestDepth,onEntry:s,defaultValue:e.originalValue,folderId:e.folderId}):"newNode"!=e.operationType||e.treeType!==v.i&&e.treeType!==v.c&&e.treeType!==v.k||(n=r.createElement(f.a,{displayName:Object(p.b)(b.a),isCustomActionNode:!0,isRootNode:!1,key:"newFolder",onClick:g})),n?r.createElement(r.Fragment,null,n,r.createElement("span",{className:"screenReaderOnly","aria-live":"assertive","aria-atomic":"true"},l)):null}))},2989:function(e,n,i){"use strict";i.d(n,"b",(function(){return d})),i.d(n,"a",(function(){return c}));var t=i(1291),a=i(281),l=i(3),r=i(1800),o=i(3082),d=Object(a.select)({folderTable:function(){return t.d.folderTable},viewState:function(){return r.a}})(Object(a.action)("initiateMailFolderTextField")((function(e,n,i,t){"new"===n&&Object(o.a)(e,!0),t.viewState.folderTextFieldViewState={folderId:e,operation:n,folderNodeType:i}}))),c=Object(l.action)("dismissMailFolderTextField")},3082:function(e,n,i){"use strict";var t=i(281),a=i(1878);n.a=Object(t.action)("setFolderViewExpansionState")((function(e,n){Object(a.a)(e).isExpanded=n}))},5939:function(e,n,i){var t=i(5940),a=i(130);"string"==typeof t&&(t=[[e.i,t]]);for(var l=0;l<t.length;l++)a.loadStyles(t[l][1],!1);t.locals&&(e.exports=t.locals)},5940:function(e,n,i){(n=e.exports=i(129)(!1)).push([e.i,"._18ze-w-t88rwZv0403rvPg.DBK6RDiFurUg3gg-V45BC{height:40px}._18ze-w-t88rwZv0403rvPg._1PIY0tyZF9nxP3tVebMhJN{height:36px}._18ze-w-t88rwZv0403rvPg._1Bhfu7vneLnaeh4a2UUEcI{height:28px}html[dir] ._1NxbrVecx_6iZABaN-ePoz{padding-bottom:8px}",""]),n.locals={nodeHeight:"_18ze-w-t88rwZv0403rvPg",full:"DBK6RDiFurUg3gg-V45BC",medium:"_1PIY0tyZF9nxP3tVebMhJN",compact:"_1Bhfu7vneLnaeh4a2UUEcI",monarchFavoriteList:"_1NxbrVecx_6iZABaN-ePoz"}}}]);
//# sourceMappingURL=owa.FolderOperationNode.js.map
self.scriptsLoaded['owa.FolderOperationNode.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FolderOperationNode.js'] = (new Date()).getTime();