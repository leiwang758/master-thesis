self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFunctionalBoot~MeetingMessage~PostMailDeeplinkBoot~ReadingPane.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[136],{10231:function(e,t,n){"use strict";var r=n(3),i=Object(r.createStore)("TrustedSenders",{trustedSendersAndDomains:null})();t.a=i},1295:function(e,t,n){"use strict";var r=n(3),i=n(1348),a=n(1397),o={settings:i.a,overrides:Object(a.a)(i.a),configIDs:void 0,lastError:void 0,initialized:!1,report:void 0,searchKey:void 0};t.a=Object(r.createStore)("applicationSettings",o)},1300:function(e,t,n){"use strict";var r=Array.isArray;t.a=r},1317:function(e,t,n){"use strict";var r=n(538),i=n(1328),a=n(1300),o=n(730),s=1/0,c=r.a?r.a.prototype:void 0,u=c?c.toString:void 0;t.a=function e(t){if("string"==typeof t)return t;if(Object(a.a)(t))return Object(i.a)(t,e)+"";if(Object(o.a)(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-s?"-0":n}},1328:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},1348:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={Loki:{resourceUrl:"https://loki.delve.office.com/"}}},1349:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(9),i=function(){var e=Object(r.a)(window,"applicationSettingOverrides");if(e)try{return JSON.parse(e)}catch(e){return{}}return{}},a=function(e,t,n){var a,o=i();o[e]?o[e][t]=n:o[e]=((a={})[t]=n,a),Object(r.e)(window,"applicationSettingOverrides",JSON.stringify(o))},o=function(){Object(r.d)(window,"applicationSettingOverrides")}},1376:function(e,t,n){"use strict";var r=n(670),i=1/0,a=17976931348623157e292;var o=function(e){return e?(e=Object(r.a)(e))===i||e===-i?(e<0?-1:1)*a:e==e?e:0:0===e?e:0};t.a=function(e){var t=o(e),n=t%1;return t==t?n?t-n:t:0}},1377:function(e,t,n){"use strict";var r=n(1317);t.a=function(e){return null==e?"":Object(r.a)(e)}},1397:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1349);function i(e,t){void 0===t&&(t=!0);var n={},i=Object(r.a)();return Object.keys(e).forEach((function(r){var a=e[r],o=i[r];n[r]={},Object.keys(a).forEach((function(e){n[r][e]=t&&(null==o?void 0:o.hasOwnProperty(e))?o[e]:void 0}))})),n}},1398:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var r=n(1295),i=n(56),a=n(77);function o(t,n){var o,s=Object(r.a)();if(s.initialized||e.env.JEST_WORKER_ID||i.d("Attempted to read "+t+"."+n+" before application settings were initialized."),Object(a.i)("fwk-devTools")){var c=null===(o=s.overrides[t])||void 0===o?void 0:o[n];if(void 0!==c)return c}return s.settings[t][n]}}).call(this,n(125))},1405:function(e,t,n){"use strict";t.a=function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}},1477:function(e,t,n){"use strict";var r=n(0),i=n(1),a=n(304),o=n(1444),s=n(1961),c=n(1296),u=n(266),f=n(1868),l=n(47),d=n(1559),b=n(1326),v=n(1596),p=n(77),O=Object(l.a)((function(e){var t=e.personaSize,n=e.identifiers,r=e.styles,a=e.children,o=e.onPersonaInsightRingStateChange,s="User"===n.PersonaType||"NotResolved"===n.PersonaType,u=window.PersonaInsightRing;return u&&c.a.isLivePersonaCardInitialized&&s?i.createElement(u,{identifiers:n,styles:r,personaSize:t,onPersonaInsightRingStateChange:o},a):i.createElement(i.Fragment,null,a)}));n.d(t,"a",(function(){return j}));var g=Object(l.a)((function(e){var t=e.composeEmailOverride,n=e.isUnauthenticatedSender,g=e.mailBoxType,j=e.personaType,h=e.emailAddress,y=e.clientScenario,m=e.locationToOpen,S=e.focusReturnElement,w=e.tabIndex,P=e.olsPersonaId,E=e.hostAppPersonaId,T=e.name,_=e.disableHover,C=e.ariaLabel,N=e.className,B=e.children,x=e.size,I=e.aadObjectId,k=e.displayPersonaHighlightRing,R=e.mountWithoutWrapperSpan,D=e.disableAccessibilityDefaults,L=Object(r.__read)(i.useState(!1),2),A=L[0],z=L[1];i.useEffect((function(){Object(s.a)(t),Object(o.a)()}),[]);var U,F=i.useMemo((function(){return Object(v.b)(n,g,j,h)}),[n,g,j,h,c.a.brandListLoadState]),G=i.useCallback((function(){return function(e,t,n){if(Object(p.i)("grp-TransferOwnership")){var r=document.getElementById("TransferOwnershipGroupDialog");r&&(a.unmountComponentAtNode(r),document.body.removeChild(r))}e.isBrand&&Object(u.q)(e.personaType===v.a.Brand?"BrandCardDisplayed":"BrandDetectedButNotDisplayed");var i=t||"No Client Scenario",o=n||"LPC";Object(u.q)("LPCRenderedFromHoverTarget",{clientScenario:i,locationToOpen:o})}(F,y,m)}),[F,y,m]),M=i.useCallback((function(){S instanceof HTMLElement?S.focus():(null==S?void 0:S.current)&&S.current.focus()}),[S]),H=i.useCallback((function(e){z(e)}),[z]),q=Object(d.a)({text:T}),J=(U={displayPersonaHighlightRing:k,personaSize:x||b.c.size40,identifiers:{OlsPersonaId:P,HostAppPersonaId:E,Smtp:h,PersonaType:F.personaType},onPersonaInsightRingStateChange:H},Object(l.a)((function(e){var t=e.children;return Object(p.i)("lpc-isPersonaInsightRingEnabled")&&U.displayPersonaHighlightRing?i.createElement(O,Object(r.__assign)({},U),t):i.createElement(i.Fragment,null,t)})));if(c.a.isLivePersonaCardInitialized){var $=window.LivePersonaCardHoverTargetV2,K=k?i.createElement(J,null,B):B;return i.createElement($,{tabIndex:w,cardParameters:{disableAccessibilityDefaults:D,externalAppSessionCorrelationId:f.lokiClientCorrelationId,personaInfo:{identifiers:{Smtp:h,PersonaType:F.personaType,OlsPersonaId:P,AadObjectId:I,HostAppPersonaId:E},isUnauthenticatedSender:n,displayName:T,isTier3Brand:F.isTier3Brand,personaCoinColor:q},behavior:{disableHover:_,onCardOpen:G,onCardClose:M,locationToOpen:m},clientScenario:y,ariaLabel:C,hasPersonaInsightRing:A}},R?K:i.createElement("span",{className:N,"aria-label":C},K))}return i.createElement(i.Fragment,null,B)}));function j(e){return Object(l.a)((function(t){var n=t.children;return c.a.isPersonaCardDisabled?i.createElement(i.Fragment,null,n):i.createElement(g,Object(r.__assign)({},e),n)}))}},1536:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(29),i=n(1556);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("GetPersona",e,t)}},1544:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetPersonaRequest:#Exchange"},e)}},1556:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetPersonaJsonRequest:#Exchange"},e)}},1561:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetNotesForPersonaRequest:#Exchange"},e)}},1578:function(e,t,n){"use strict";n.r(t);var r=n(1405),i=n(1317),a=n(1376),o=n(1377);t.default=function(e,t,n){e=Object(o.a)(e),t=Object(i.a)(t);var s=e.length,c=n=void 0===n?s:Object(r.a)(Object(a.a)(n),0,s);return(n-=t.length)>=0&&e.slice(n,c)==t}},1596:function(e,t,n){"use strict";var r=n(77),i=n(97),a=n(1603),o=n(318),s=n(1578);n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return f}));var c={NotResolved:"NotResolved",User:"User",Group:"Group",External:"External",DistributionList:"DistributionList",PrivateDistributionList:"PrivateDistributionList",Location:"Location",Room:"Room",Meeting:"Meeting",Brand:"Brand",Topic:"Topic"};function u(e,t,n,u){if(e)return{personaType:c.User,isBrand:!1,isTier3Brand:!1};if(Object(r.i)("rp-brandCards")&&!Object(i.b)(u)&&Object(a.a)(u)){var l=Object(a.b)(u);return{personaType:c.Brand,isBrand:!0,isTier3Brand:l}}return Object(i.b)(t)?!Object(i.b)(n)&&Object.keys(c).indexOf(n)>-1?{personaType:n,isBrand:!1,isTier3Brand:!1}:(d=u,Object(s.default)(d,"@groups.outlook.com")?{personaType:"Group",isBrand:!1,isTier3Brand:!1}:Object(o.a)()?{personaType:"User",isBrand:!1,isTier3Brand:!1}:{personaType:"NotResolved",isBrand:!1,isTier3Brand:!1}):{personaType:f(t),isBrand:!1,isTier3Brand:!1};var d}function f(e){switch(e){case"PublicDL":return c.DistributionList;case"PrivateDL":return c.PrivateDistributionList;case"GroupMailbox":return c.Group;case"Mailbox":case"Contact":return c.User;case"OneOff":case"Unknown":return c.NotResolved;default:return c.User}}},1669:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(20),i=n(3),a={signInState:0,presences:new r.ObservableMap({}),processingManualSignIn:!1,isRetrySignInAllowed:!0},o=Object(i.createStore)("presenceStore",a),s=o();t.a=s},1733:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.createStore)("chatStore",{isChatCalloutShown:!1,chatProvider:0});i()},1824:function(e,t,n){"use strict";var r=n(3),i=Object(r.action)("initializeApplicationSettings",(function(e){return{config:e}})),a=n(1348),o=n(1295),s=n(0),c=function(e,t){return e.filter((function(e){return!t.includes(e)}))},u=(Object(r.mutator)(i,(function(e){var t=e.config,n=Object(o.a)();if(!t)return n.initialized=!0,void(n.report={NoSettings:!0});if(!t.settings)return n.lastError=t.lastError,n.initialized=!0,void(n.report={NoSettings:!0});var r={};Object.keys(a.a).forEach((function(e){r[e]={};var n=t.settings[e];Object.keys(a.a[e]).forEach((function(t){r[e][t]=n&&n.hasOwnProperty(t)?n[t]:a.a[e][t]}))})),n.configIDs=t.configIDs,n.lastError=t.lastError,n.settings=r,n.initialized=!0,n.report=function(e,t,n){var r,i,a,o,u,f={},l=0,d=0,b=Object.keys(e),v=Object.keys(t),p=c(b,v),O=c(v,b),g=(u=v,b.filter((function(e){return u.includes(e)})));if(p.length){f.MissingSettings=[];try{for(var j=Object(s.__values)(p),h=j.next();!h.done;h=j.next()){var y=h.value;f.MissingSettings.push({group:y,settings:["all"]}),l+=Object.keys(e[y]).length}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=j.return)&&i.call(j)}finally{if(r)throw r.error}}}if(O.length){f.ExtraSettings=[];try{for(var m=Object(s.__values)(O),S=m.next();!S.done;S=m.next()){y=S.value;var w=Object.keys(t[y]);f.ExtraSettings.push({group:y,settings:w}),d+=Object.keys(t[y]).length}}catch(e){a={error:e}}finally{try{S&&!S.done&&(o=m.return)&&o.call(m)}finally{if(a)throw a.error}}}if(g.forEach((function(n){var r=Object.keys(e[n]),i=Object.keys(t[n]),a=c(r,i),o=c(i,r);a.length&&(f.MissingSettings=[{group:n,settings:a}],l+=a.length),o.length&&(f.ExtraSettings=[{group:n,settings:o}],d+=o.length)})),l&&(f.MissingSettingsCount=l),d&&(f.ExtraSettingsCount=d),n&&(f.LastError=n),l||d)return f}(a.a,t.settings,t.lastError)})),Object(r.action)("setApplicationSettingOverride",(function(e,t,n){return{group:e,setting:t,value:n}}))),f=(Object(r.mutator)(u,(function(e){var t=e.group,n=e.setting,r=e.value;Object(o.a)().overrides[t][n]=r})),Object(r.action)("setApplicationSettingsSearchKey",(function(e){return{key:e}}))),l=(Object(r.mutator)(f,(function(e){var t=e.key;Object(o.a)().searchKey=t})),Object(r.action)("resetApplicationSettingOverrides")),d=n(1397),b=(Object(r.mutator)(l,(function(){Object(o.a)().overrides=Object(d.a)(a.a,!1)})),n(1349)),v=(Object(r.orchestrator)(u,(function(e){var t=e.group,n=e.setting,r=e.value;Object(b.c)(t,n,r)})),Object(r.orchestrator)(l,b.b),n(1398));function p(){return Object(o.a)().settings}function O(){return Object(o.a)().overrides}function g(){return Object(o.a)().report}function j(){return Object(o.a)().searchKey}n.d(t,"a",(function(){return v.a})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return j})),n.d(t,"f",(function(){return i})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return f})),n.d(t,"g",(function(){return l}))},1827:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1669);function i(){return 3==r.a.signInState}},1840:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"PersonaPropertyUpdate:#Exchange"},e)}},187:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function a(t){r--,delete e[t]}this.put=function(t,n,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var s=e[t];s?clearTimeout(s.timeout):r++;var c={value:n,expire:i+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){a(t),o&&o(t,n)}.bind(this),i)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&a(t),n},this.clear=function(){for(var a in e)clearTimeout(e[a].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(a){var o=e[a];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&t++,o.value;i&&n++,r--,delete e[a]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),a=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(a)if(e[o])continue;var s=r[o],c=s.expire-i;if(c<=0){this.del(o);continue}c=c>0?c:void 0,this.put(o,s.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},1912:function(e,t,n){"use strict";var r=n(74),i=n(1827),a=n(1733);function o(){var e=Object(a.a)().chatProvider;return Object(i.a)()&&(3==e||4==e)}n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return o}));var s=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(6),n.e(7),n.e(247),n.e(744)]).then(n.bind(null,17127))})),c=new r.a(s,(function(e){return e.initializeSkypeForBusiness})),u=new r.b(s,(function(e){return e.tryRegisterForPresenceUpdates})),f=new r.b(s,(function(e){return e.startChat})),l=new r.a(s,(function(e){return e.setIsSkypeShown})),d=Object(r.d)(s,(function(e){return e.UcmaChatView}))},1928:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(0),i=void 0,a=new Promise((function(e){i=e}));function o(e){null==i||i(e)}function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,Promise.race([a,new Promise((function(e,t){setTimeout((function(){return t()}),45e3)}))])]}))}))}},1929:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(29),i=n(1561);function a(e,t){return void 0===e.getNotesForPersonaRequest||e.getNotesForPersonaRequest.__type||(e.getNotesForPersonaRequest=Object(i.a)(e.getNotesForPersonaRequest)),Object(r.a)("GetNotesForPersona",e,t)}},1951:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1544),i=n(317),a=n(1536);function o(e){if(!e)return Promise.reject(new Error("GetPersonaByEmailAddress failed"));var t=Object(r.a)({EmailAddress:{EmailAddress:e}});return Object(a.a)({Header:Object(i.b)(),Body:t}).then((function(e){if(e.Body&&"NoError"===e.Body.ResponseCode)return e.Body.Persona;throw new Error("GetPersonaByEmailAddress failed")}))}},2234:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2235),i=n(1669),a=n(1326),o=n(77);function s(e){if(Object(o.i)("fwk-skypeBusinessV2")&&e){var t=Object(r.b)(e),n=function(e){switch(e){case"Offline":return a.b.offline;case"Away":case"BeRightBack":return a.b.away;case"Busy":case"IdleBusy":return a.b.busy;case"DoNotDisturb":return a.b.dnd;case"Online":case"IdleOnline":return a.b.online;case"None":return a.b.none}}(i.a.presences.get(t));return n||void 0}}},2235:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r="sip:";function i(e){if(!e)return null;var t=e.toLowerCase();return 0!=t.indexOf(r)&&(t=r+t),t}},322:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r,i=n(0);function a(e){r=e}function o(){var e,t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(a=r)?[4,r()]:[3,2];case 1:a=i.sent(),i.label=2;case 2:if((n=a)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},538:function(e,t,n){"use strict";var r=n(625).a.Symbol;t.a=r},553:function(e,t,n){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},625:function(e,t,n){"use strict";var r=n(731),i="object"==typeof self&&self&&self.Object===Object&&self,a=r.a||i||Function("return this")();t.a=a},670:function(e,t,n){"use strict";var r=n(553),i=n(730),a=NaN,o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,f=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(i.a)(e))return a;if(Object(r.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(r.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=c.test(e);return n||u.test(e)?f(e.slice(2),n?2:8):s.test(e)?a:+e}},726:function(e,t,n){"use strict";var r=n(538),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,s=r.a?r.a.toStringTag:void 0;var c=function(e){var t=a.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var i=o.call(e);return r&&(t?e[s]=n:delete e[s]),i},u=Object.prototype.toString;var f=function(e){return u.call(e)},l="[object Null]",d="[object Undefined]",b=r.a?r.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?d:l:b&&b in Object(e)?c(e):f(e)}},727:function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},730:function(e,t,n){"use strict";var r=n(726),i=n(727),a="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(i.a)(e)&&Object(r.a)(e)==a}},731:function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(115))}}]);
//# sourceMappingURL=owa.MailBoot~MailFunctionalBoot~MeetingMessage~PostMailDeeplinkBoot~ReadingPane.js.map
self.scriptsLoaded['owa.MailBoot~MailFunctionalBoot~MeetingMessage~PostMailDeeplinkBoot~ReadingPane.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFunctionalBoot~MeetingMessage~PostMailDeeplinkBoot~ReadingPane.js'] = (new Date()).getTime();