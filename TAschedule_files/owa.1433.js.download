self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1433.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1433],{11040:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1438),i=n(1911),a=n(1894),u=n(56),c=n(1528);function d(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){return 1===(n=t.tableQuery).listViewType?(i={Id:e,mailboxInfo:Object(o.d)(n)},[2,a.e.importAndExecute(i,"LoadNudgedItem")]):[2,s(e,t)]}))}))}function s(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){return n=t.tableQuery,a=Object(o.d)(n),[2,i.h.importAndExecute(e,n.folderId,n.sortBy,Object(c.l)(n),n.requestShapeName,a).then((function(e){return e})).catch((function(e){return u.g.warn("loadNudgedConversation throws an exception"+e.message),null}))]}))}))}var l=n(77),f=n(318),b=n(472),w="https://outlook.office.com/FocusedInboxB2",O="https://outlook.office.com/M365.Access";function I(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,g()];case 1:return(e=n.sent())?((t=new Headers).authorization="Bearer "+e,[2,t]):[2,null]}}))}))}function g(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(o){switch(o.label){case 0:return Object(f.a)()?[3,3]:(e=Object(r.__read)(Object(b.getAccessTokenforResourceAsLazy)(w),2),t=e[0],n=e[1],t?[3,2]:[4,n]);case 1:t=o.sent(),o.label=2;case 2:return[2,t];case 3:return Object(l.i)("tri-nudge-consumer")?[4,Object(b.getDelegationTokenForOwa)(O)]:[3,5];case 4:return[2,o.sent()];case 5:return[2,null]}}))}))}var v=n(319),m=n(336),h="FocusedInboxB2/api/v1/Nudges/GetNudges";function j(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,I()];case 1:return(t=r.sent())?[4,Object(v.b)(h,e,!0,t,!1,!1,"GetNudges")]:[3,9];case 2:if(o=r.sent(),!Object(m.a)(o.status))return[3,7];r.label=3;case 3:return r.trys.push([3,5,,6]),[4,o.json()];case 4:return(i=r.sent()).Nudges?[2,i]:(n=i,[3,6]);case 5:return r.sent(),n="Parse Error",[3,6];case 6:return[3,8];case 7:n=o.status,r.label=8;case 8:return[3,10];case 9:n="Token Failure",r.label=10;case 10:return[2,n]}}))}))}var _=n(1290),y=n(4),N=n(1301);function p(e){switch(e){case"Received":return 0;case"Sent":return 1;default:return u.g.warn("No nudge reason returned in GetNudge server response"),0}}var R=n(4038),E=n(2040),T=n(3289),S=n(8449),C=n(2249),K=n(2299);function L(e,t){var n=t.rowKeys.indexOf(e);if(-1!=n){var r=_.b.getLastDeliveryOrRenewTimeStamp(e,t);if(Object(K.a)(e,t.id,r)){var o=Object(T.a)(r,_.b.getLastDeliveryTimeStamp(e,t),t,n+1);-1==o?Object(E.a)([e],t,"NotNudgeAnymore"):(Object(S.a)([e],t),C.a.updateRowPosition(--o,e,t))}}}var A=n(266),V=n(74),D=n(361),x=n(2468),P=n(1297),M=n(10);function F(e,t,n){Object(A.q)("Nudge_RowRemove",{owa_1:t,owa_2:n,rKey:e},{isCore:!0})}var k=n(4595),U=n(1351);function G(e){var t,n=(null!==(t=e.IconIndex)&&void 0!==t?t:"").toString().toLowerCase();return n.indexOf("replied")>-1||n.indexOf("forwarded")>-1}function B(e,t,n){return _.b.getIsPinned(n,t)?"RowPinned":function(e,t,n){if(Object(_.P)(e)){var r=_.b.getLatestGlobalItemId(t,e),o=_.b.getDraftItemIds(t,e);return!(!t||-1!=o.indexOf(r)||r==n)}var i=Object(P.b)().items.get(n);return!(!i||!G(i))}(t,n,e)?"NotLatestItemInRow":null}var W,z,Q=!1,q={},H=36e5,J=18e5,X=Object(V.e)(k.a,"getNudgesOnNudgeOptionChangeClone",(function(e){ee(!0,"SettingChange")})),Y=Object(V.e)(x.a,"clone_onSelectFolderComplete",(function(e){var t=e.selectedFolderId,n=e.previousFolderId,r=e.isExitingSearch;t==n||r||ee(!1,"FolderSwitch")})),Z=Object(V.e)(K.i,"clone_getNudgesOnNudgeRemoved",(function(e){Object(l.i)("tri-nudgePolling")&&(z=setTimeout((function(){return ee(!0,"NudgeRemoval")}),9e5))}));function $(e,t){"visible"===document.visibilityState&&ee(e,t)}function ee(e,t){if(!Q&&Object(R.b)()){var n=Object(l.i)("tri-nudgePolling");!W&&n&&(W=!0,document.addEventListener("visibilitychange",(function(){return $(!1,"VisibilityChange")})));var o=Object(_.G)(),i=o.tableQuery.folderId;if(Object(R.a)(i)){if(n){if(!e&&Date.now()-q[i]<=J)return;z&&(clearTimeout(z),z=null),z=setTimeout((function(){return $(!1,"Timer")}),H)}!function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,d,s,l,f,b,w,O,I,g,v,m,h,p,R,E,T;return Object(r.__generator)(this,(function(S){switch(S.label){case 0:return Q=!0,o=Object(D.a)(),i=Date.now(),[4,j(o)];case 1:if(a=S.sent(),d=[],s=a,l=Date.now()-i,!(null==s?void 0:s.Nudges))return[3,6];f=s.Nudges,b=0,w=[],O=[],I="sentitems"==Object(U.a)(e),g=0,S.label=2;case 2:return g<f.length?(v=f[g],m=v.FolderId.Id,h=v.ItemId.Id,w.push(h),I&&m!=e?[3,4]:[4,te(v,t,o,!I)]):[3,5];case 3:(p=S.sent())&&(d.push(p),O.push(h)),b++,S.label=4;case 4:return g++,[3,2];case 5:return ne(f.length,b,d.length,n,o,w.join(","),l,O.join(","),"none"),[3,7];case 6:ne(0,0,0,n,o,"",l,"",null==a?void 0:a.toString()),S.label=7;case 7:return R=Object(y.a)("testOldNudge"),0!=decodeURIComponent(R||"").trim().length&&(d.push({rowKey:"testNudgeRowKey",itemId:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId=",conversationId:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId=",tableViewId:t.id,reason:0,daysAgo:7}),E={ConversationId:{__type:"ItemId:#Exchange",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId="},ConversationTopic:"This is a test Nudge Email that is older than the loaded rows",UniqueSenders:["Sayali Shah"],LastDeliveryTime:"2019-10-01T15:30:58-07:00",HasAttachments:!1,MessageCount:1,GlobalMessageCount:1,UnreadCount:1,GlobalUnreadCount:1,Size:1234,ItemClasses:["IPM.Note"],Importance:null,ItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],GlobalItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],LastModifiedTime:"2019-10-29T15:30:59-07:00",InstanceKey:"testNudgeRowKey",Preview:"Test nudge email for row that is not loaded",HasIrm:!1,IsLocked:!1,FamilyId:{__type:"ItemId:#Exchange",Id:"AAQkAGZjM2NmMGY1LTkzMzgtNGNhMy04ODg5LWQwMjJjMDc0YjJlMAAQAH9+ZbR0rbRFncY81mWHT1E="},LastDeliveryOrRenewTime:"2019-10-01T15:30:58-07:00",HasAttachmentPreviews:!1,LastSender:{Mailbox:{Name:"Sayali Shah",EmailAddress:"sayalis@microsoft.com",RoutingType:"SMTP"}}},t.rowKeys.indexOf("testNudgeRowKey")<0&&(T=Object(c.f)(t,0),C.a.addRow(T,E,t))),d.push.apply(d,Object(r.__spread)(function(e){var t=Object(y.a)("testNudge");if(0==decodeURIComponent(t||"").trim().length)return[];var n=[];if(e.rowKeys.length>0){var r=e.tableQuery.folderId===Object(N.a)("sentitems")?1:0,o={rowKey:e.rowKeys[4],itemId:_.b.getItemIds(e.rowKeys[0],e)[0],conversationId:_.b.getConversationId(e.rowKeys[4],e),tableViewId:e.id,reason:r,daysAgo:1};if(n.push(o),e.rowKeys.length>3){var i={rowKey:e.rowKeys[6],itemId:_.b.getItemIds(e.rowKeys[3],e)[0],conversationId:_.b.getConversationId(e.rowKeys[6],e),tableViewId:e.id,reason:r,daysAgo:0};n.push(i)}if(e.rowKeys.length>10&&1===Math.floor(2*Math.random())){var a={rowKey:e.rowKeys[10],itemId:_.b.getItemIds(e.rowKeys[10],e)[0],conversationId:_.b.getConversationId(e.rowKeys[10],e),tableViewId:e.id,reason:r,daysAgo:3};n.push(a)}}return n}(t))),Object(K.f)().nudgedRows.forEach((function(e){var n=e.rowKey;e.tableViewId!=t.id||d.some((function(t){return t.rowKey===n&&t.tableViewId===e.tableViewId}))||(L(n,t),F(n,"NotReceivedAsNudgeAnyMore",e.reason)),e.tableViewId!=t.id&&d.push(e)})),Object(K.h)(d,t),u.g.info("Nudge: onSelectFolderCompleteOrchestrator new nudges length: "+d.length),Q=!1,[2]}}))}))}(i,o,t),q[i]=Date.now()}}}function te(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l,f,b,w,O,I,g,v,m,h,j,y,N;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),s=void 0,l=void 0,f=e.ItemId.Id,b=e.ConversationId.Id,w=e.NudgeReason.Reason,O=Object(_.P)(t),I=O?b:f,g=Object(_.E)([I],t),v=i?"Sent"==w:"Received"==w,0!==g.length?[3,2]:[4,d(I,t)];case 1:return m=r.sent(),(l=function(e,t,n,r){var o,i;if(!e)return"RowNotFound";if(i=n?e.LastDeliveryOrRenewTime:e.ReceivedOrRenewTime,Object(_.v)(i))return"RowPinned";if(n){var a=e,u=a.GlobalItemIds[0].Id;return 0==(a.DraftItemIds||[]).filter((function(e){return e.Id==u})).length&&u!=t?"NotLatestItemInRow":null}return G(e)?"NotLatestItemInRow":(null===(o=e.ParentFolderId)||void 0===o?void 0:o.Id)!=r.tableQuery.folderId?"ItemFromOtherTable":null}(m,f,O,t))||(s=m.InstanceKey,t.rowKeys.indexOf(s)<0&&(h=Object(c.f)(t,0),C.a.addRow(h,m,t))),[3,3];case 2:(l=B(f,t,g[0]))||(s=g[0]),r.label=3;case 3:return s?(function(e,t){if(1===e.listViewType){var n=Object(P.b)().items.get(t);n&&n.NormalizedBody||a.e.importAndExecute({Id:t,mailboxInfo:Object(o.d)(e)},"LoadNudgedItem")}else Object(P.b)().conversations.get(t)||a.d.importAndExecute({Id:t,mailboxInfo:Object(o.d)(e)},"LoadNudgedConversation")}(t.tableQuery,I),j=e.MessageReceivedOrSentTimeUTC||_.b.getLastDeliveryTimeStamp(s,t),y=Object(M.s)(Object(M.lc)(),Object(M.lc)(j)),[2,{rowKey:s,itemId:f,conversationId:b,tableViewId:t.id,reason:p(e.NudgeReason.Reason),daysAgo:y}]):(function(e,t,n,r,o,i,a){var c=a?"inbox":"sentitems";Object(A.q)("Nudge_Discarded",{owa_1:e,owa_2:o,owa_3:i,itemId:t,cId:n,crId:r},{isCore:!0}),u.g.warn("Nudge Discarded - isConversationView: "+o+" itemId: "+t+" conversationId: "+n+" folderId: "+c+" isNudgeFromOtherTable: "+i)}(l,f,b,n,O,v,i),[2,null]);case 4:return N=r.sent(),u.g.warn("Nudge: processNudgeResponse throws an exception"+N.message),[2,null];case 5:return[2]}}))}))}function ne(e,t,n,r,o,i,a,u,c){Object(A.q)("Nudge_GetNudge",{owa_1:e,owa_2:t,owa_3:n,owa_4:r,cId:o,itemId:i,latency:a,validItemId:u,error:c})}var re="FocusedInboxB2/api/v1/Nudges/UpdateNudge";function oe(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,u,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,I()];case 1:return i=r.sent(),a="No error",i?(u={ItemId:{Id:e},NudgeAction:t},[4,Object(v.d)(re,u,Object(D.a)(),!0,i,!1,!1,!1,"UpdateNudges")]):[3,3];case 2:c=r.sent();try{Object(m.a)(c.status)||(a=c.status)}catch(e){a="Parse Error"}return[3,4];case 3:a="Token Failure",r.label=4;case 4:return function(e,t,n,r,o){Object(A.q)("Nudge_Update",{owa_1:e,owa_2:t,owa_3:n,owa_4:o,itemId:r},{isCore:!0})}(t,n,o,e,a),[2]}}))}))}var ie,ae,ue=n(1724),ce=n(3130),de=n(3131),se=n(3774),le=n(4990),fe=n(5951),be=n(3128),we=n(3129),Oe=Object(V.e)(fe.b,"clone_onNudgeInfoBarClicked",(function(e){var t=e.response===fe.a.MarkComplete?"MarkedComplete":"DismissedOnView";pe(e.rowKey,e.itemId,t,"ReadingPane")})),Ie=Object(V.e)(le.a,"clone_onDismissNudgeClicked",(function(e){Object(K.f)().nudgedRows.filter((function(t){return t.rowKey===e.rowKey&&t.tableViewId===e.tableViewId})).forEach((function(t){pe(e.rowKey,t.itemId,"Dismissed",e.actionSource)}))})),ge=Object(V.e)(de.a,"clone_markItemsAsPinnedStoreUpdate",(function(e){Ne(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned)})),ve=Object(V.e)(ce.a,"clone_markConversationsAsPinnedStoreUpdate",(function(e){Ne(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned)})),me=Object(V.e)(ue.a,"clone_deleteItemsStoreUpdate",(function(e){e.itemContexts.map((function(e){return e.itemId})).forEach((function(t){var n=Object(K.e)(t);n&&(Object(K.i)(n),F(n,e.actionType,Ee(n)))}))})),he=Object(V.e)(E.a,"clone_removeRowsFromListViewStore",(function(e){Re(e.rowKeys,e.tableView.id,e.actionType)})),je=Object(V.e)(se.a,"clone_onSendMessageSucceeded",(function(e){var t=e.operation;if(1===t||2===t||3===t){e.referenceItemId||u.g.warn("Nudge: referenceItemId should not be null for r/R/f operations");var n,r=e.referenceItemId.Id,o=e.conversationId,i=Object(K.e)(r);i||(i=Object(K.d)(o)),i?(L(i,Object(_.G)()),n=Ee(i),Object(K.i)(i)):ie==r&&(i=ae),i&&Object(A.q)("Nudge_Reply",{owa_1:t,owa_2:n,refId:r,cId:o,rKey:i},{isCore:!0})}})),_e=Object(V.e)(we.a,"clone_removeNudgeUponRowUpdate",(function(e){var t=Object(K.f)().nudgedRows.filter((function(t){return t.rowKey===e.rowKey}));if(t.length>0){var n=B(t[0].itemId,e.tableView,e.rowKey);n&&(ie=t[0].itemId,ae=e.rowKey,L(e.rowKey,e.tableView),Re([e.rowKey],e.tableView.id,n))}})),ye=Object(V.e)(k.a,"updateNudgesOnNudgeOptionChangeClone",(function(e){if(Object(be.a)(16)){var t=Object(K.f)().nudgedRows.map((function(e){return e.rowKey})),n=Object(_.G)();t.forEach((function(e){L(e,n),Re([e],n.id,"NudgeDisabled")}))}}));function Ne(e,t,n){var r=n?"Pinned":"Unpinned";e.forEach((function(e){Object(K.f)().nudgedRows.filter((function(n){return n.rowKey===e&&n.tableViewId===t})).forEach((function(e){oe(e.itemId,r,"PinUnpin",e.reason)}))})),Re(e,t,"PinUnpin")}function pe(e,t,n,r){oe(t,n,r,Ee(e)),L(e,Object(_.G)()),Object(K.i)(e)}function Re(e,t,n){e.forEach((function(e){if(Object(K.g)(e,t)){var r=Ee(e);Object(K.i)(e),F(e,n,r)}}))}function Ee(e){var t=Object(K.f)().nudgedRows.filter((function(t){return t.rowKey===e}));return t.length>0?t[0].reason:null}var Te=n(3);function Se(e,t,n){if(e.tableViewId==t.id){var r,o="Nudge_Render",i=e.rowKey,a=e.conversationId,d=e.itemId;Object(K.a)(i,t.id,_.b.getLastDeliveryOrRenewTimeStamp(i,t))?(r=Object(c.f)(t,0),C.a.updateRowPosition(r,i,t),u.g.info("Nudge: "+n+" updateNudgedRowPosition - row is inserted at "+r)):(o="Nudge_NotRender",u.g.info("Nudge: "+n+" updateNudgedRowPosition - row is pinned")),Object(A.q)(o,{owa_1:n,rKey:i,iId:d,cId:a,index:r},{isCore:!0})}}Object(Te.orchestrator)(K.h,(function(e){e.nudgedRows.forEach((function(t){return Se(t,e.tableView,"onGetNudge")}))})),Object(Te.orchestrator)(c.i,(function(e){var t=Object(K.f)().nudgedRows,n=e.tableView;t.filter((function(e){return e.tableViewId==n.id})).forEach((function(t){return Se(t,e.tableView,"onMerge")}))}));var Ce=n(96);function Ke(){Object(be.b)(!0,16),Ce.v.importAndExecute([{key:"FocusedInboxBitFlags",valuetype:"Integer32",value:[""+Object(Ce.h)().ViewStateConfiguration.FocusedInboxBitFlags]}],"OWA.ViewStateConfiguration"),Object(A.q)("TnS_SaveNudgeOption",[!1,"InlineFeedback"]),Object(k.a)()}n.d(t,"getNudgesOnSelectFolderComplete",(function(){return Y})),n.d(t,"getNudgesOnNudgeOptionChange",(function(){return X})),n.d(t,"getNudgesOnNudgeRemoved",(function(){return Z})),n.d(t,"removeNudgeOnInfoBarClickedOrchestrator",(function(){return Oe})),n.d(t,"removeNudgeOnDismissNudgeClickedOrchestrator",(function(){return Ie})),n.d(t,"removeNudgeOnItemDeleteStoreUpdateOrchestrator",(function(){return me})),n.d(t,"removeNudgeOnRowsDeleteStoreUpdateOrchestrator",(function(){return he})),n.d(t,"removeNudgeOnItemsPinnedStoreUpdateOrchestrator",(function(){return ge})),n.d(t,"removeNudgeOnConversationsPinnedStoreUpdateOrchestrator",(function(){return ve})),n.d(t,"removeNudgeOnReplyOrReplyAllOrForwardOrchestrator",(function(){return je})),n.d(t,"updateNudgesOnNudgeOptionChange",(function(){return ye})),n.d(t,"removeNudgeUponRowUpdate",(function(){return _e})),n.d(t,"disableNudgeOption",(function(){return Ke}))},1505:function(e,t,n){"use strict";n.d(t,"q",(function(){return s})),n.d(t,"t",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"i",(function(){return w})),n.d(t,"o",(function(){return O})),n.d(t,"b",(function(){return I})),n.d(t,"m",(function(){return g})),n.d(t,"f",(function(){return v})),n.d(t,"p",(function(){return m})),n.d(t,"s",(function(){return h})),n.d(t,"r",(function(){return j})),n.d(t,"g",(function(){return _})),n.d(t,"j",(function(){return y})),n.d(t,"k",(function(){return N})),n.d(t,"n",(function(){return p})),n.d(t,"d",(function(){return R})),n.d(t,"c",(function(){return E})),n.d(t,"h",(function(){return T})),n.d(t,"l",(function(){return S}));var r=n(0),o=n(72),i=n(1290),a=n(1305),u=n(3),c=n(1407),d=n(30),s=Object(u.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(C(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(u.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(C(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(u.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,o){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:o}})),b=Object(u.action)("EXPAND_ROW_FIRST_LEVEL",(function(e,t){return{rowKey:e,latestItemIdsInForks:t}})),w=Object(u.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),O=Object(u.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",(function(e){return{rowKey:e}})),I=Object(u.action)("ITEM_PART_SELECTED",(function(e,t,n,r,o){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:o}})),g=Object(u.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),v=Object(u.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),m=Object(u.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r,o){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r,currentSelectedNodeIds:o}})),h=Object(u.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),j=Object(u.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),_=Object(u.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),y=Object(u.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),N=Object(u.action)("RESET_SELECTION",(function(e){return{tableView:e}})),p=Object(u.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(o.c)(C(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),R=Object(u.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),E=Object(u.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),T=Object(u.action)("RESET_BUS_STOP_STATE_MAP"),S=Object(u.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}}));function C(e,t,n,o){return{name:function(e,t,n,o){return!(function(e){return e===a.b.MailListItemRichPreview||e===a.b.KeyboardShiftEnter||e===a.b.MailListItemBodyDoubleClick}(e)||Object(c.c)()&&!function(e){var t;return e===a.b.KeyboardEnter||e===a.b.MailListItemBody||e===a.b.RouteHandler||e===a.b.CommandBarArrows||e===a.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(d.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,o){if(Object(c.c)())return!1;if(e===a.b.KeyboardUpDown){var u=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==u&&1===t.selectedRowKeys.size){var d=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return o===i.d.Next?d===u+1||d===t.rowKeys.length-1&&u===t.rowKeys.length-1:d===u-1||0===d&&0===u}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,o))}(e,t,n,o)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},1672:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,o=t%n;return(((e-=r)/n&(t-=o)/n)>>>0)*n+((r&o)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},1818:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=1,o=16},187:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,o,a){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):r++;var c={value:n,expire:o+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){i(t),a&&a(t,n)}.bind(this),o)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var a=e[i];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return o&&t++,a.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),o=Date.now(),i=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(i)if(e[a])continue;var u=r[a],c=u.expire-o;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,u.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},272:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d}));var r=n(7),o=new r.b((function(){return Promise.all([n.e(38),n.e(46),n.e(102),n.e(150),n.e(477)]).then(n.bind(null,592))})),i=new r.a(o,(function(e){return e.createApolloClient})),a=new r.a(o,(function(e){return e.wrapInApolloProvider})),u=new r.a(o,(function(e){return e.unblockBootResolvers})),c=new r.a(o,(function(e){return e.getApolloClient})),d=new r.c(o,(function(e){return e.ApolloProvider}))},306:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d}));var r=n(0),o=n(272),i=null,a=null;function u(){return s(i),i}function c(){return s(a),a}function d(e){var t=e.lazyResolvers,n=e.lazyLocalStateResolvers,u=e.lazyCreateManagedQueryLink,c=e.context;return i=Promise.all([o.b.import(),t,n,u]).then((function(e){var t=Object(r.__read)(e,4),n=t[0],o=t[1],i=t[2],u=t[3];return a=n({resolvers:o,localStateResolvers:i,createManagedQueryLink:u,context:c})}))}function s(e){if(!e)throw new Error("Apollo client has not been initialized yet.")}},322:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r,o=n(0);function i(e){r=e}function a(){var e,t;return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return(i=r)?[4,r()]:[3,2];case 1:i=o.sent(),o.label=2;case 2:if((n=i)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},3289:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var r=n(2299),o=n(1290),i=n(1528);function a(e,t,n,r){var a=new Date(o.b.getLastDeliveryTimeStamp(n,r)).getTime()-new Date(t).getTime();if(Object(i.l)(r.tableQuery)){var u=new Date(o.b.getLastDeliveryOrRenewTimeStamp(n,r)).getTime()-new Date(e).getTime();return 0!=u?u:a}return a}function u(e,t,n,o,a){return Object(r.a)(a,n.id,e)?Object(i.f)(n,0):c(e,t,n,o)}function c(e,t,n,i){var u=n.rowKeys.length;if(0==u)return 0;var c,d=Object(o.I)(n).sortDirection==o.c.DESCENDING_SORT_DIR;for(c=i;c<u;c++){var s=n.rowKeys[c];if(!Object(r.a)(s,n.id,e)){var l=a(e,t,s,n);if(d?l<=0:l>0)return c}}return u==n.totalRowsInView?u:-1}},340:function(e,t,n){"use strict";var r=n(306);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.c}));var o=n(272);n.d(t,"c",(function(){return o.a})),n.d(t,"d",(function(){return o.c})),n.d(t,"e",(function(){return o.d})),n.d(t,"f",(function(){return o.e}))},8449:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1505),o=n(1455);function i(e,t){var n=e[e.length-1],i=t.rowKeys.indexOf(n);i<t.rowKeys.length-1?Object(r.q)(t,t.rowKeys[i+1],!1,o.a.RowRemoval):Object(r.j)(t,o.a.Reset)}}}]);
//# sourceMappingURL=owa.1433.js.map
self.scriptsLoaded['owa.1433.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1433.js'] = (new Date()).getTime();