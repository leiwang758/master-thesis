self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Attachments~filesView~smime.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[154],{10369:function(n,t,e){"use strict";e.d(t,"a",(function(){return f}));var r=e(13564),i=e(1629),c=e(11),u=e(4925),o=e(1434),a=e(1345);function s(n,t,e,r){var c=[],u=[];if(n.forEach((function(n){e(n)?c.push(n):u.push(n)})),u.length>0){var o=r(u.map((function(n){return n.name})).join(", ")),a=o.messageId,s=o.message;Object(i.a)(t,a,[s])}return c}function f(n,t,e){Object(u.a)(e);for(var i=[],f=0;f<n.length;f++)i.push(n[f]);return i=function(n,t){return s(n,t,(function(n){return!(n.fileType===o.a.Local&&0===n.size)}),(function(n){return{messageId:"WarningEmptyFilesCanNotBeAttached",message:Object(c.c)(Object(c.b)(r.a),n)}}))}(i,e),t&&(i=function(n,t){return s(n,t,(function(n){return Object(a.g)(n.name,n.type)}),(function(n){return{messageId:"WarningInlineImageTypeNotSupported",message:Object(c.c)(Object(c.b)(r.b),n)}}))}(i,e)),i}},10370:function(n,t,e){"use strict";e.d(t,"a",(function(){return s}));var r=e(13565),i=e(11),c=e(56),u=e(3165),o=e(8704),a=e(1629);function s(n,t,e){for(var s=0,f=0,l=void 0;l=n[f];f++)s+=l.size;var d=Object(o.a)(e);if(s>d){var m=Math.floor(d/u.b),h=void 0,b=void 0;return n.length>1?(b="ErrorTooLargeForLocalAttachmentMultiple",h=Object(i.c)(Object(i.b)(r.a),m)):(b="ErrorTooLargeForLocalAttachmentSingle",h=Object(i.c)(Object(i.b)(r.b),m)),Object(a.a)(t,b,[h]),!0}return c.g.info("Attachment: TotalSize = "+Math.floor(e.totalClassicAttachmentSize/1048576)),!1}},13564:function(n){n.exports=JSON.parse('{"a":"cjb","b":"djb"}')},13565:function(n){n.exports=JSON.parse('{"a":"Wib","b":"Xib"}')},1566:function(n,t,e){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}e.d(t,"a",(function(){return r})),e.d(t,"b",(function(){return i})),function(n){n.noPermissionToShare="WarningNoPermissionToShare",n.getSharingInfoFailed="WarningGetSharingInfoFailed",n.linkHasExpired="WarningLinksHasExpired",n.linkWillExpire="WarningLinksWillExpire",n.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",n.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",n.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",n.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1662:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(267);function i(n){switch(n){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(n)}}},1750:function(n,t,e){"use strict";var r;e.d(t,"a",(function(){return r})),function(n){n[n.InProgress=0]="InProgress",n[n.Failed=1]="Failed",n[n.Succeeded=2]="Succeeded"}(r||(r={}))},1761:function(n,t,e){"use strict";e.d(t,"a",(function(){return i})),e.d(t,"b",(function(){return c}));var r=e(1695);function i(n){return u(n.type)}function c(n){return u(Object(r.a)(n))}function u(n){return 1===n||3===n}},1784:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(3),i=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(n){return{id:n}}))},1785:function(n,t,e){"use strict";var r;e.d(t,"a",(function(){return r})),function(n){n[n.ignore=0]="ignore",n[n.refreshExpiration=1]="refreshExpiration",n[n.changePermission=2]="changePermission",n[n.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1814:function(n,t,e){"use strict";var r=e(1366);function i(){var n=Object(r.a)();return n.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||n.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?n.ConditionalAccessWacViewingOnPrivateComputersBlocked||n.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var c=e(1662),u=e(1598);function o(){return i()}function a(n){return(n&&n.length>0&&function(n){return n.some((function(n){return!((t=n).IsInline&&!Object(u.a)(t));var t}))}(n)?i():[]).map(c.a)}e.d(t,"a",(function(){return o})),e.d(t,"b",(function(){return a}))},187:function(n,t,e){"use strict";function r(){var n=Object.create(null),t=0,e=0,r=0,i=!1;function c(t){r--,delete n[t]}this.put=function(t,e,i,u){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var o=n[t];o?clearTimeout(o.timeout):r++;var a={value:e,expire:i+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){c(t),u&&u(t,e)}.bind(this),i)),n[t]=a,e},this.del=function(t){var e=!0,r=n[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(e=!1)):e=!1,e&&c(t),e},this.clear=function(){for(var c in n)clearTimeout(n[c].timeout);r=0,n=Object.create(null),i&&(t=0,e=0)},this.get=function(c){var u=n[c];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return i&&t++,u.value;i&&e++,r--,delete n[c]}else i&&e++;return null},this.size=function(){return r},this.memsize=function(){var t,e=0;for(t in n)e++;return e},this.debug=function(n){i=n},this.hits=function(){return t},this.misses=function(){return e},this.keys=function(){return Object.keys(n)},this.exportJson=function(){var t={};for(var e in n){var r=n[e];t[e]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,e){var r=JSON.parse(t),i=Date.now(),c=e&&e.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(c)if(n[u])continue;var o=r[u],a=o.expire-i;if(a<=0){this.del(u);continue}a=a>0?a:void 0,this.put(u,o.value,a)}return this.size()}}n.exports=new r,n.exports.Cache=r},1887:function(n,t,e){"use strict";e.d(t,"h",(function(){return s})),e.d(t,"i",(function(){return f})),e.d(t,"f",(function(){return l})),e.d(t,"k",(function(){return d})),e.d(t,"m",(function(){return m})),e.d(t,"e",(function(){return h})),e.d(t,"g",(function(){return b})),e.d(t,"j",(function(){return p})),e.d(t,"l",(function(){return g}));var r=e(74),i=e(1784);e.d(t,"n",(function(){return i.a}));var c=e(1750);e.d(t,"a",(function(){return c.a}));var u=e(1566);e.d(t,"d",(function(){return u.b})),e.d(t,"c",(function(){return u.a}));var o=e(1785);e.d(t,"b",(function(){return o.a}));var a=new r.c((function(){return Promise.all([e.e(3),e.e(34),e.e(71),e.e(740)]).then(e.bind(null,3100))})),s=new r.b(a,(function(n){return n.getSharingInformation})),f=new r.b(a,(function(n){return n.getSharingIssuesForSharingData})),l=new r.b(a,(function(n){return n.getInfoBarCreator})),d=new r.b(a,(function(n){return n.hasLargeDLRecipient})),m=new r.b(a,(function(n){return n.hasRecipientExpansionFailure})),h=new r.b(a,(function(n){return n.getGroupsAndSmallDLs})),b=new r.b(a,(function(n){return n.getInvididualRecipients})),p=new r.b(a,(function(n){return n.hasGetRecipientPermissionFailed})),g=new r.b(a,(function(n){return n.logSharingTipChangesForLinkRemoval}))},2004:function(n,t,e){"use strict";var r=e(74),i=[0,1],c=e(2195),u=e(2125),o=e(11),a=e(267),s=e(1385);function f(n){switch(n){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(u.a),messageParts:[Object(o.b)(u.a),l()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(c.b),messageParts:[Object(o.b)(c.b),l()],color:s.a.Red};default:return Object(a.a)(n)}}function l(){return{text:Object(o.b)(c.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var d=e(1814),m=e(1662),h=e(0),b=e(77),p=e(1366);function g(){var n=Object(p.a)();if(Object(b.i)("fwk-devTools")){if(Object(b.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(h.__assign)(Object(h.__assign)({},n),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(b.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(h.__assign)(Object(h.__assign)({},n),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return n}function v(){var n=g();return n.DirectFileAccessOnPrivateComputersEnabled&&n.DirectFileAccessOnPublicComputersEnabled?2:n.WacViewingOnPrivateComputersEnabled&&n.WacViewingOnPublicComputersEnabled?0:1}e.d(t,"g",(function(){return C})),e.d(t,"a",(function(){return i})),e.d(t,"f",(function(){return f})),e.d(t,"b",(function(){return d.a})),e.d(t,"e",(function(){return m.a})),e.d(t,"d",(function(){return v})),e.d(t,"c",(function(){return g}));var O=new r.c((function(){return e.e(1779).then(e.bind(null,16781))})),C=new r.b(O,(function(n){return n.getAccessIssuesForAttachments}))},2125:function(n){n.exports=JSON.parse('{"a":"q$a"}')},2195:function(n){n.exports=JSON.parse('{"a":"Tsb","b":"Usb"}')},2229:function(n,t,e){"use strict";e.d(t,"n",(function(){return s})),e.d(t,"m",(function(){return f})),e.d(t,"j",(function(){return l})),e.d(t,"i",(function(){return d})),e.d(t,"k",(function(){return m})),e.d(t,"f",(function(){return h})),e.d(t,"a",(function(){return b})),e.d(t,"c",(function(){return p})),e.d(t,"g",(function(){return g})),e.d(t,"d",(function(){return v})),e.d(t,"h",(function(){return O})),e.d(t,"e",(function(){return A})),e.d(t,"l",(function(){return j})),e.d(t,"b",(function(){return E}));var r=e(2947),i=e(2687),c=e(55),u=e(1541),o=e(1698),a=e(2492);function s(){return Object(c.e)()||Object(c.f)()}function f(n){return function(n){if(n.length<2)return!1;var t=n[0]-parseInt(u.b),e=n[1]-parseInt(u.c);return 0==t&&e>=0}("string"==typeof n?n.split(".").map((function(n){return parseInt(n)})):[])}function l(n){var t="string"==typeof n?n.split("."):[];return t.length&&t[0]!=u.b}function d(){return Object(c.r)()&&(Object(c.i)()&&Object(c.b)()[0]==u.i&&Object(i.a)()||Object(r.a)())}function m(n){return 0!==n}function h(n){var t=[];t.push(n.UserEmailAddress),t.push(n.LogonEmailAddress),t.push(n.UserPrincipalName),t.push(n.UserLegacyExchangeDN);var e=n.UserProxyAddresses;return e&&e.length>0&&e.forEach((function(n){t.indexOf(n)>=0||t.push(n)})),t}function b(n){var t=65001;return n.UseGB18030?t=54936:n.UseISO885915&&(t=28605),t}function p(n){return{AllowUserChoiceOfSigningCertificate:n.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:n.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:n.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:n.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:n.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:n.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:n.CopyRecipientHeaders,OnlyUseSmartCard:n.OnlyUseSmartCard,EncryptionAlgorithms:n.EncryptionAlgorithms,SigningAlgorithms:n.SigningAlgorithms}}function g(n,t){var e=Object(a.a)().ClearSign;return t||n&&!e?o.a:u.e}function v(n){return btoa(unescape(encodeURIComponent(n)))}function O(n,t){var e=Object(a.a)();return n&&t?e.TripleWrapSignedEncryptedMail?14:12:n?e.ClearSign?11:10:6}function C(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function A(){return u.m+C()+C()+C()+C()}function j(n,t){return t.IsInline&&-1===n.indexOf(t.ContentId)}function E(){return u.d+C()+"@"+C()+"."+C()}},2492:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(273);function i(){return Object(r.a)().smime}},2687:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(55);function i(){if(Object(r.i)())try{return new ActiveXObject("htmlfile"),!0}catch(n){return!1}return!1}},2853:function(n,t,e){"use strict";e.d(t,"a",(function(){return a}));var r=e(1541),i=function(n,t){return n.substring(0,t.length)===t},c=function(n,t){return n.substring(n.length-t.length)===t},u=function(n){return n.ContentType&&(i(n.ContentType,r.v)||i(n.ContentType,r.l))},o=function(n){return n.ContentType&&n.ContentType===r.j};function a(n){return(null==n?void 0:n.Name)&&c(n.Name,r.t)&&(u(n)||o(n))}},2947:function(n,t,e){"use strict";e.d(t,"a",(function(){return c}));var r=e(55),i=e(1541);function c(){return Object(r.e)()&&Object(r.o)([i.f])||Object(r.g)()&&Object(r.o)([i.h])||Object(r.f)()&&Object(r.o)([i.g])}},3165:function(n,t,e){"use strict";e.d(t,"d",(function(){return r})),e.d(t,"a",(function(){return i})),e.d(t,"b",(function(){return c})),e.d(t,"c",(function(){return u}));var r="ReferenceAttachment:#Exchange",i=1024,c=1048576,u="Not support special characters"},322:function(n,t,e){"use strict";e.d(t,"b",(function(){return c})),e.d(t,"a",(function(){return u}));var r,i=e(0);function c(n){r=n}function u(){var n,t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(c=r)?[4,r()]:[3,2];case 1:c=i.sent(),i.label=2;case 2:if((e=c)&&e.length>0){if("bearer"===(null===(n=null==e?void 0:e.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return[2,e.split(" ")[1]];if("msauth1.0"===(null===(t=null==e?void 0:e.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,e]}return[2,void 0]}}))}))}},443:function(n,t,e){"use strict";var r=e(0);function i(n,t){return n?Object(r.__assign)({mailboxInfo:n},t):null!=t?t:void 0}e.d(t,"a",(function(){return i}))},4758:function(n,t,e){"use strict";var r=e(5606),i=e(4400),c=e(1352),u=e(281);t.a=Object(u.action)("removeAttachmentFromWell")((function(n,t){var e=Object(c.a)(t.attachmentId);if(e){var u,o;1===t.attachmentType?(u=n.inlineAttachments,o=!0):u=n.imageViewAttachments.some((function(n){return n.attachmentId===t.attachmentId}))?n.imageViewAttachments:n.docViewAttachments;for(var a=!1,s=0;s<u.length;s++)if(u[s].attachmentId===t.attachmentId){u.splice(s,1),a=!0;break}!a||!o&&t.isCloudy||Object(r.a)(n,-1*e.model.Size,e.model.AttachmentId),Object(i.a)(t.attachmentId)}}))},4925:function(n,t,e){"use strict";var r=e(1637),i=["ErrorTooLargeForLocalAttachmentSingle","ErrorTooLargeForLocalAttachmentMultiple","WarningFilesCanNotBeAttachedGenericError","WarningEmptyFilesCanNotBeAttached","WarningFilesCanNotBeAttachedWithNamesGenericError","WarningFilesCannotBeAttachedFromOtherMailboxes","WarningSeveralFilesCanNotBeAttachedGenericError","WarningInlineImageTypeNotSupported","WarningAttachmentsCanNotBeDeleted","InfoIncludeMostRecentAttachmentsMessage","ErrorSmimeHasCloudOrUriAttachments","ErrorAttachmentDownloadFailed","ErrorAttachmentDownloadFailedMultipleFiles","WarningSpecialCharactersAreNotSupported"];function c(n){n&&Object(r.a)(n,i)}e.d(t,"a",(function(){return c}))},5227:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(0);function i(n){return Object(r.__assign)({__type:"Item:#Exchange"},n)}},5606:function(n,t,e){"use strict";var r=e(281);t.a=Object(r.action)("changeTotalClassicAttachmentSize")((function(n,t,e){n.totalClassicAttachmentSize+=t}))},6658:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(0);function i(n){return Object(r.__assign)({__type:"ItemIdAttachment:#Exchange"},n)}},677:function(n,t,e){"use strict";function r(n){void 0===n&&(n={}),function(n){n.timeBetweenRetryInMS=n.timeBetweenRetryInMS||function(){return 6e4}}(n);var t=n.maximumAttempts,e=n.timeBetweenRetryInMS;return function(n){var r=0,i=!1,c=function(u,o){i?o(new Error("The function retry was cancelled")):(r++,n().then((function(n){return u(n)})).catch((function(n){t&&r>=t?o(n):setTimeout((function(){return c(u,o)}),e(r))})))};return{retriableFunc:function(){return new Promise((function(n,t){return c(n,t)}))},cancel:function(){return i=!0}}}}function i(n){return function(t){return Math.pow(2,t)*n}}e.d(t,"b",(function(){return r})),e.d(t,"a",(function(){return i}))},8704:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(56);function i(n){var t=n.maxTotalClassicAttachmentSize-n.totalClassicAttachmentSize;return t<0?(r.d("AttachmentWellAvailableSize is smaller than zero: "+n.composeId),0):t}},8705:function(n){n.exports=JSON.parse('{"a":"Oib"}')},8708:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(0);function i(n){return Object(r.__assign)({__type:"ItemAttachment:#Exchange"},n)}},8709:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(0);function i(n){return Object(r.__assign)({__type:"MimeContentType:#Exchange"},n)}}}]);
//# sourceMappingURL=owa.MailBoot~Attachments~filesView~smime.js.map
self.scriptsLoaded['owa.MailBoot~Attachments~filesView~smime.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Attachments~filesView~smime.js'] = (new Date()).getTime();