self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailStoreActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[647],{1299:function(e,n,t){"use strict";var a=t(74),r=t(1482),o=t(1311),i=t(3),s=[o.a.SurfaceActions];Object(i.orchestrator)(r.a,(function(e){var n=e.defaultOptions;s.forEach((function(e){n[e]&&Object(o.f)(Number(e),n[e])}))}));var l=t(1327);t.d(n,"e",(function(){return d})),t.d(n,"h",(function(){return u})),t.d(n,"f",(function(){return f})),t.d(n,"g",(function(){return p})),t.d(n,"c",(function(){return l.a})),t.d(n,"d",(function(){return o.d})),t.d(n,"b",(function(){return o.b})),t.d(n,"a",(function(){return o.a}));var c=new a.c((function(){return t.e(867).then(t.bind(null,17291))})),d=new a.a(c,(function(e){return e.createOrUpdateOptionsForFeature})),u=new a.a(c,(function(e){return e.updateAddinPinStatus})),f=(new a.a(c,(function(e){return e.updateAddInArray})),new a.b(c,(function(e){return e.getServerOptionsForFeature}))),p=new a.a(c,(function(e){return e.loadOptions}))},1311:function(e,n,t){"use strict";var a,r,o=t(3),i=Object(o.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),s=Object(o.action)("assignOptionValue",(function(e,n){return{feature:e,value:n}})),l=Object(o.action)("verifyAndSetOptionValues",(function(e){return{potentialOptionValues:e}})),c=Object(o.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),d=t(0);!function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper",e[e.CalendarHelp=21]="CalendarHelp",e[e.LinkedInViewProfile=22]="LinkedInViewProfile",e[e.Bohemia=23]="Bohemia",e[e.GdprAdsV2=24]="GdprAdsV2",e[e.Proofing=25]="Proofing",e[e.ActiveProxyAddress=26]="ActiveProxyAddress",e[e.OutlookSpaces=27]="OutlookSpaces",e[e.GdprAdsV3=28]="GdprAdsV3",e[e.SxS=29]="SxS"}(a||(a={}));var u=Object(o.createStore)("owsOptionsStore",{options:(r={},r[a.SmartSuggestions]={feature:a.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},r[a.DiverseEmojis]={feature:a.DiverseEmojis,diverseEmojisSelectedSkinTone:""},r[a.SurfaceActions]={feature:a.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},r[a.SkypeNotifications]={feature:a.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},r[a.WebPushNotifications]={feature:a.WebPushNotifications,enabled:!1,applicationServerKey:null},r[a.Confetti]={feature:a.Confetti,confettiEnabled:!1},r[a.GdprAdsPrefs]={feature:a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},r[a.GdprAdsV2]={feature:a.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},r[a.GdprAdsV3]={feature:a.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},r[a.CalendarSurfaceAddins]={feature:a.CalendarSurfaceAddins,calendarSurfaceAddins:[]},r[a.ExternalImages]={feature:a.ExternalImages,externalImagesSelectedOption:null},r[a.EventCapture]={autoCollectionEnabled:!1},r[a.Translation]={feature:a.Translation,translationMode:0,targetLanguage:"",excludedLanguages:[]},r[a.CalendarSurfaceOptions]={feature:a.CalendarSurfaceOptions,agendaPaneIsClosed:!0,lastKnownRoamingTimeZone:void 0,roamingTimeZoneNotificationsIsDisabled:void 0,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},r[a.MentionEventNotifications]={feature:a.MentionEventNotifications,enabled:!1},r[a.TxpEventNotifications]={feature:a.TxpEventNotifications,enabled:!1},r[a.ComposeAssistance]={feature:a.ComposeAssistance,composeAssistanceEnabled:!1},r[a.AmpDeveloper]={feature:a.AmpDeveloper,enabled:!0,allowedSender:[]},r[a.ActivityFeed]={feature:a.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},r[a.LinkedInViewProfile]={dismissed:!1},r[a.CalendarHelp]={feature:a.CalendarHelp,calendarHelpEnabled:!1},r[a.Bohemia]={feature:a.Bohemia,bohemiaEnabled:!1,fluidEnabledForTenant:!1},r[a.Proofing]={feature:a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!1,proofingLocale:void 0,overriddenOptions:void 0},r[a.ActiveProxyAddress]={feature:a.ActiveProxyAddress,activeProxyAddresses:[]},r[a.OutlookSpaces]={feature:a.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},r[a.SxS]={feature:a.SxS,hideReadingPane:!1},r)}),f=t(20);function p(e){return(null==e?void 0:e.feature)in a}var m,A=t(339);function v(e,n){u().options[e]=n}function S(e){return u().options[e]}Object(o.mutator)(s,(function(e){var n=e.feature,t=e.value;A(u().options[n],t)})),Object(o.mutator)(i,(function(e){v(e.feature,e.value)})),Object(o.mutator)(c,(function(e){var n=e.feature,t=e.value;Object(f.extendObservable)(u().options[n],t)})),Object(o.mutator)(l,(function(e){var n,t,a=e.potentialOptionValues;try{for(var r=Object(d.__values)(a),o=r.next();!o.done;o=r.next()){var i=o.value;i&&p(i)&&v(i.feature,i)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}})),function(e){e[e.Work=1]="Work",e[e.Life=2]="Life"}(m||(m={})),t.d(n,"g",(function(){return i})),t.d(n,"c",(function(){return s})),t.d(n,"h",(function(){return l})),t.d(n,"f",(function(){return c})),t.d(n,"e",(function(){return u})),t.d(n,"d",(function(){return S})),t.d(n,"b",(function(){return m})),t.d(n,"a",(function(){return a}))},1327:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(318),r=t(1311),o=t(77);function i(){var e;return(e={})[r.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[r.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[r.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(a.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddClassicAttachment","InsertLink","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[r.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[r.a.Confetti]={confettiEnabled:!0},e[r.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[r.a.GdprAdsPrefs]={feature:r.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[r.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[r.a.ExternalImages]={externalImagesSelectedOption:0},e[r.a.EventCapture]={autoCollectionEnabled:!1},e[r.a.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[r.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[r.a.AmpDeveloper]={enabled:Object(o.i)("rp-ampDefault"),allowedSender:[]},e[r.a.CalendarHelp]={calendarHelpEnabled:!1},e[r.a.LinkedInViewProfile]={dismissed:!1},e[r.a.Bohemia]={bohemiaEnabled:Object(o.i)("cmp-prague")},e[r.a.GdprAdsV2]={feature:r.a.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},e[r.a.GdprAdsV3]={feature:r.a.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[r.a.Proofing]={feature:r.a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[r.a.ActiveProxyAddress]={feature:r.a.ActiveProxyAddress,activeProxyAddresses:[]},e[r.a.OutlookSpaces]={feature:r.a.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[r.a.SxS]={feature:r.a.SxS,hideReadingPane:!1},e}},1482:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(3),r=t(1327),o=Object(a.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(r.a)()),{defaultOptions:e}}))},17425:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t(1305),o=t(4419),i=t(281),s=function(e,n){var t=e,a=n;t.ToRecipients=a.ToRecipients,t.CcRecipients=a.CcRecipients,t.BccRecipients=a.BccRecipients};function l(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,t;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(n=Object(o.a)()).MaximumRecipientsToReturn=0,[4,Object(r.e)(e.ItemId.Id,n,"ItemPart")];case 1:return!(t=a.sent())||t instanceof Error||s(e,t),[2]}}))}))}s=Object(i.action)("updateItemRecipients")(s);var c=t(10311),d=t(10314),u=t(10315),f=t(5236),p=t(10312),m=t(10313),A=t(77),v=t(11156),S=t(4366),b=t(474);var g=t(78),w=t(2019),P=t(3313),O=t(56),C=t(2715),I=t(443),h="X-OWA-ActionSource",y="X-RedirectToOutlookService";var E=Object(i.action)("parseItemResponse")((function(e,n){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,o,i;return Object(a.__generator)(this,(function(s){switch(s.label){case 0:return(t=r.u.items.get(n.Id))&&Object(m.a)(e,t),Object(f.a)()&&Object(p.b)(e),Object(d.a)(e),o=Object(a.__assign)(Object(a.__assign)({Smime:null,TranslationData:{isShowingTranslation:!1,isTranslatable:!1,isTranslating:!1,shouldGetFeedback:!1,isShowingSubjectTranslation:!1,isShowingForwardContentTranslation:!1,isForwardContentTranslatable:!1,manuallyTranslated:!1,userLanguage:null,isWrongLanguage:null},adaptiveCardDetails:null},e),{MailboxInfo:n.mailboxInfo,SmartReplyData:null,SmartTimeData:null,SmartTimeExtendedProperty:null,smartPillFeedbackSubmitted:!1,itemCLPInfo:null,SIGSData:{SmartPillData:null}}),r.u.items.set(n.Id,o),i=r.u.items.get(n.Id),Object(c.a)(i),Object(P.a)(t)?[4,w.l.importAndExecute(i,t)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}}))}))}));function D(e,n,t,a,i){var s;t&&(s=t.addCheckmark("request_start"));var l=Object(I.a)(e.mailboxInfo)||{},c=new Headers;a&&c.set(C.c,C.d),c.set(h,n),l.headers=c,Object(A.i)("platform-redirectGetItemToOutlookService")&&!Object(g.a)(l)&&l.headers.set(y,"true"),l.datapoint={customData:{actionSource:n}};var d,f=Object(o.a)();return Object(v.a)(f),Object(S.a)(f),d=f,Object(A.i)("rp-omeRevocation")&&d.AdditionalProperties.push(Object(b.a)({PropertyName:"x-ms-exchange-organization-ome-messagestate",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})),Object(r.e)(e.Id,f,"ItemNormalizedBody","V2017_08_18",e.mailboxInfo,l,i).then((function(a){if(t){var o=t.addCheckmark("request_end");t.addCustomData({requestTime:o-s})}if(a instanceof Error||null===a){switch(n){case"PrefetchFirstN":case"PrefetchSingleRow":case"PrefetchRowInCache":case"PrefetchAdjacentRowsOnDelay":break;default:O.g.warn(n+": "+(a instanceof Error?a.message:a))}return a instanceof Error?Promise.reject(a):Promise.resolve(null)}return E(a,e).then((function(){return r.u.items.get(e.Id)}))})).catch((function(e){return e.message+=", ActionSource="+n,Object(u.a)(n)?Promise.resolve():Promise.reject(e)}))}var j=t(9571);t.d(n,"loadAllRecipientsForItem",(function(){return l})),t.d(n,"loadItem",(function(){return D})),t.d(n,"loadConversation",(function(){return j.b}))},1935:function(e,n,t){"use strict";var a=t(266),r=t(323),o={tenantTokens:Object(a.f)(),isCore:!0};function i(e,n,t){var i=new r.a(e,n,o);t&&i.addCosmosOnlyData(t),a.m.importAndExecute(i)}function s(e){return new a.b(e,o)}var l=t(564);function c(){return{ariaTenantTokens:Object(l.a)(),flightControls:{client_event:{flight:"ana-client-event",rate:5},client_error:{flight:"ana-client-error"},client_verbose:{flight:"ana-client-verbose",rate:1},client_network_request:{flight:"ana-client-network-request",rate:1}},verboseWhiteListEvents:["AttachmentRefreshDownloadToken","TabViewActivateTab"],qosDatapointNames:["AddMemberModalSave","CreateGrouptoAddMembers","EditGroupModalSave","ForwardInSMIME","GroupFilesHubEnsureAuthToken","GroupFilesHubListsLoad","GroupMailComposeSend","InlineImageLoad","loadSuggestedGroupsAction","MailComposeForward","MailComposeNew","MailComposeReply","MailComposeReplyAll","MailComposeSend","MessageOptionsEmptyInvariantViolation","MessageOptionsMultipleDialogsInvariantViolation","NavigateFromMeToWe","OpenItemPeek","PreviewAttachmentInSxSE2E","ReplyAllInSMIME","ReplyInSMIME","SaveCalendarEvent","SearchEndToEnd","SelectGroup","SelectMailItem","showFullCompose","showFullComposeInEditMode","showQuickCompose","showReadingPane","SwitchGroup","SwitchMailFolder","TnS_DeleteConversation","TnS_DeleteItem","UnreadCountNotification","ViewCalendarEvent"],sampledQosDatapointNames:["LoadGroupsInLeftNavFromSessionData"]}}t.d(n,"c",(function(){return i})),t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return c}))},2152:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return i}));var a=t(3),r=Object(a.action)("CONVERSATION_READY_TO_LOAD",(function(e,n){return{conversationId:e,nodeIdCollectionChange:n}})),o=Object(a.action)("UPDATE_ATTACHMENTS"),i=Object(a.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(function(e,n){return{conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:n}}))},2715:function(e,n,t){"use strict";t.d(n,"c",(function(){return a})),t.d(n,"d",(function(){return r})),t.d(n,"e",(function(){return o})),t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return s}));var a="X-OWA-SmimeInstalled",r="1",o="SmimeWithoutActiveX",i="message/rfc822",s="ErrorSmimeSendCancelled"},272:function(e,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"e",(function(){return i})),t.d(n,"d",(function(){return s})),t.d(n,"c",(function(){return l})),t.d(n,"a",(function(){return c}));var a=t(7),r=new a.b((function(){return Promise.all([t.e(38),t.e(46),t.e(102),t.e(150),t.e(477)]).then(t.bind(null,592))})),o=new a.a(r,(function(e){return e.createApolloClient})),i=new a.a(r,(function(e){return e.wrapInApolloProvider})),s=new a.a(r,(function(e){return e.unblockBootResolvers})),l=new a.a(r,(function(e){return e.getApolloClient})),c=new a.c(r,(function(e){return e.ApolloProvider}))},306:function(e,n,t){"use strict";t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return l})),t.d(n,"c",(function(){return c}));var a=t(0),r=t(272),o=null,i=null;function s(){return d(o),o}function l(){return d(i),i}function c(e){var n=e.lazyResolvers,t=e.lazyLocalStateResolvers,s=e.lazyCreateManagedQueryLink,l=e.context;return o=Promise.all([r.b.import(),n,t,s]).then((function(e){var n=Object(a.__read)(e,4),t=n[0],r=n[1],o=n[2],s=n[3];return i=t({resolvers:r,localStateResolvers:o,createManagedQueryLink:s,context:l})}))}function d(e){if(!e)throw new Error("Apollo client has not been initialized yet.")}},3313:function(e,n,t){"use strict";n.a=function(e){var n;return null===(n=null==e?void 0:e.Smime)||void 0===n?void 0:n.isDecoded}},340:function(e,n,t){"use strict";var a=t(306);t.d(n,"a",(function(){return a.a})),t.d(n,"b",(function(){return a.c}));var r=t(272);t.d(n,"c",(function(){return r.a})),t.d(n,"d",(function(){return r.c})),t.d(n,"e",(function(){return r.d})),t.d(n,"f",(function(){return r.e}))},4366:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(77),r=t(474);function o(e){var n;Object(a.i)("cmp-clp")&&(null===(n=e.AdditionalProperties)||void 0===n||n.push(Object(r.a)({PropertyName:"msip_labels",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})))}},443:function(e,n,t){"use strict";var a=t(0);function r(e,n){return e?Object(a.__assign)({mailboxInfo:e},n):null!=n?n:void 0}t.d(n,"a",(function(){return r}))},5019:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(1299),r=t(77),o=t(318);function i(){var e=Object(a.d)(a.a.AmpDeveloper);return Object(o.a)()&&Object(r.i)("rp-amp")&&e.enabled}}}]);
//# sourceMappingURL=owa.MailBoot~MailStoreActions.js.map
self.scriptsLoaded['owa.MailBoot~MailStoreActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailStoreActions.js'] = (new Date()).getTime();