self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OwsGateway.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[878],{156:function(t,n,e){"use strict";e.d(n,"a",(function(){return i})),e.d(n,"b",(function(){return u}));var r=!1;function i(){return r}function u(t){r=t}},186:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(24);function i(){var t=Object(r.a)(),n=t.origin;return n||(n=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),n}},187:function(t,n,e){"use strict";function r(){var t=Object.create(null),n=0,e=0,r=0,i=!1;function u(n){r--,delete t[n]}this.put=function(n,e,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=t[n];c?clearTimeout(c.timeout):r++;var a={value:e,expire:i+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){u(n),o&&o(n,e)}.bind(this),i)),t[n]=a,e},this.del=function(n){var e=!0,r=t[n];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(e=!1)):e=!1,e&&u(n),e},this.clear=function(){for(var u in t)clearTimeout(t[u].timeout);r=0,t=Object.create(null),i&&(n=0,e=0)},this.get=function(u){var o=t[u];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&n++,o.value;i&&e++,r--,delete t[u]}else i&&e++;return null},this.size=function(){return r},this.memsize=function(){var n,e=0;for(n in t)e++;return e},this.debug=function(t){i=t},this.hits=function(){return n},this.misses=function(){return e},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var n={};for(var e in t){var r=t[e];n[e]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(n)},this.importJson=function(n,e){var r=JSON.parse(n),i=Date.now(),u=e&&e.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(u)if(t[o])continue;var c=r[o],a=c.expire-i;if(a<=0){this.del(o);continue}a=a>0?a:void 0,this.put(o,c.value,a)}return this.size()}}t.exports=new r,t.exports.Cache=r},19:function(t,n,e){"use strict";function r(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.map(o).filter((function(t){return 0!==t.length})).join("/")}function i(t){return t?t.length>0&&"/"!==t[0]?"/"+t:t:"/"}function u(t){return t.length>0&&"/"!==t[t.length-1]?t+"/":t}function o(t){return t.replace(/^\/*/,"").replace(/\/*$/,"")}e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return u}))},2202:function(t,n,e){"use strict";e.d(n,"b",(function(){return o})),e.d(n,"a",(function(){return c}));var r=e(33),i=e(24),u=e(96);function o(){var t=Object(r.a)("targetServer"),n="DefaultAnchorMailbox"+(t?"_"+t.toLocaleLowerCase():"");return Object(r.a)(n)}function c(){var t,n,e=(t="",(n=Object(i.a)().pathname.split("/").filter((function(t){return t.length}))).length>=2&&n[1].match(/.+@.+/)&&(t=n[1]),t);if(0===e.length){var r=Object(u.h)();if(null==r?void 0:r.SessionSettings){var c=r.SessionSettings.ExternalDirectoryTenantGuid,a=r.SessionSettings.UserPuid;a&&c&&(e="PUID:"+a+"@"+c)}}return 0===e.length&&(e=o()),e}},2217:function(t,n,e){"use strict";var r=e(0),i=e(77),u=e(336),o=e(4),c=e(627),a=e(2202),s=e(42),f=e(120),l=e(118),d=e(472),h=e(56),p=e(71),b=e(587),v="owsserver",O="owsapi";e.d(n,"f",(function(){return k})),e.d(n,"d",(function(){return g})),e.d(n,"c",(function(){return y})),e.d(n,"e",(function(){return T})),e.d(n,"b",(function(){return C})),e.d(n,"a",(function(){return R}));var j=2048,m=null;function k(t,n,e,u,o,a,s,f,l){var h="object"==typeof e&&e.customHeaders||s,p=h?Object.keys(h).reduce((function(t,n){return t[n.toLowerCase()]=h[n],t}),{}):void 0,b="object"==typeof e?Object(r.__assign)(Object(r.__assign)({},e),{customHeaders:p}):{returnFullResponse:e,correlationId:o,requestObject:a,customHeaders:p,throwServiceError:f,includeCredentials:l};if(!b.customHeaders||!b.customHeaders.authorization){void 0===b.includeCredentials&&(b.includeCredentials=!Object(i.i)("auth-authzHeaderNoCookies"));var v=Object(c.l)(),O=Object(r.__read)(Object(d.getAccessTokenforResourceAsLazy)(v),2),j=O[0],m=O[1];return j?w(t,n,b,u,j):m.then((function(e){return w(t,n,b,u,e)}))}return w(t,n,b,u)}function w(t,n,e,r,d){var k,w=e.returnFullResponse,g=e.correlationId,y=e.requestObject,T=e.customHeaders,C=e.throwServiceError,R=e.sendPayloadAsBody,P=e.includeCredentials,S=new Headers;S.append("X-OWA-CANARY",Object(s.a)()),S.append("X-MS-AppName","owa-react"+Object(c.q)());var x={n:Object(f.a)().toString()};g&&(S.append("client-request-id",g),x.cri=g),T&&Object.keys(T).forEach((function(t){S.append(t,T[t])}));var N=Object(p.b)();if(N&&(S.append(p.a,N),x.cv=N),d){if(d.length>0&&"msauth1.0"===(null===(k=null==d?void 0:d.split(" ")[0])||void 0===k?void 0:k.toLowerCase()))S.append("Authorization",d);else{if(Object(i.i)("fwk-devTools")){var q=d.split(".");3==q.length&&0!==q[2].length||h.d("BearerTokenIncomplete "+q.length)}S.append("Authorization","Bearer  "+d)}}if(!T||!T["x-anchormailbox"]){var D=Object(a.a)();D&&D.length>0&&S.append("X-AnchorMailbox",D)}var E={method:n,credentials:!1!==P?"same-origin":"omit"};if(y){S.append("Content-Type","application/json");var I=JSON.stringify(y),A=t.search(/ows\/|owa\//i)>=0;if(Object(i.i)("fwk-emptyPost")&&A&&"POST"==n&&!R){var L=encodeURIComponent(I);L.length<j?S.append("X-OWA-UrlPostData",L):E.body=I}else E.body=I}E.headers=S;var z=function(t,n){var e=function(t,n){var e=Object(c.w)(t,n),r=e.split("/");r.length>0&&("ows"==r[0]||"OutlookGateway"==r[0])&&(r[0]=Object(c.e)(r[0]),e=r.join("/"));return Object(c.a)(e)}(Object(i.i)("fwk-proxyOwsPrime")?"/OutlookGateway/":"/",t),r=Object(c.l)()+e;if(Object(i.i)("fwk-devTools")&&Object(o.d)(v)&&(Object(o.a)(O)==t||!Object(o.d)(O))&&(null==m&&(m=confirm("A query param '"+v+"' is set to redirect some of calls to '"+Object(o.a)(v)+"'.\n\nThose calls contain PII. If this is not intentional, click 'Cancel' below or remove the queryparam and reload the page.")),m)){var u=t.split("/");u.length>0&&"ows"==u.shift()&&(t=u.join("/")),r=Object(o.a)(v)+"/"+t}return Object(c.u)(r,n)}(t,x),_=Object(l.a)(z,E);return Object(b.a)(E,e,_,r,z),_.then((function(e){if(w)return e;if(Object(u.a)(e.status))return e.text().then((function(t){return t?JSON.parse(t):{}}));throw new Error(n+" request to "+t+" failed, http error:"+e.status)})).catch((function(t){if(h.g.warn(t),C)throw{stack:t.stack,message:t.message,correlationVector:N,correlationId:e.correlationId,networkError:!0};return[]}))}function g(t,n,e,r,i,u,o,c,a,s){return k(t,"POST",{returnFullResponse:r,correlationId:e,requestObject:n,customHeaders:i,throwServiceError:u,sendPayloadAsBody:o,includeCredentials:c,datapoint:s},a)}function y(t,n,e,r,i,u,o,c){return k(t,"PATCH",{returnFullResponse:r,correlationId:e,requestObject:n,customHeaders:i,throwServiceError:u,includeCredentials:o},c)}function T(t,n,e,r,i,u,o,c){return k(t,"PUT",r,o,e,n,i,u,c)}function C(t,n,e,r,i,u,o){return k(t,"GET",e,o,n,void 0,r,i,u)}function R(t,n,e,r,i,u,o){return k(t,"DELETE",{returnFullResponse:r,correlationId:e,requestObject:n,customHeaders:i,throwServiceError:u,includeCredentials:o})}},27:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(73);function i(t){return Object(r.a)(t,[r.c,r.b])}},293:function(t,n,e){"use strict";var r=e(34);n.a=function(t,n){return new Date(+t+n*r.g)}},322:function(t,n,e){"use strict";e.d(n,"b",(function(){return u})),e.d(n,"a",(function(){return o}));var r,i=e(0);function u(t){r=t}function o(){var t,n;return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(u=r)?[4,r()]:[3,2];case 1:u=i.sent(),i.label=2;case 2:if((e=u)&&e.length>0){if("bearer"===(null===(t=null==e?void 0:e.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,e.split(" ")[1]];if("msauth1.0"===(null===(n=null==e?void 0:e.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return[2,e]}return[2,void 0]}}))}))}},336:function(t,n,e){"use strict";var r=e(732);e.d(n,"a",(function(){return r.a}))},34:function(t,n,e){"use strict";e.d(n,"i",(function(){return r})),e.d(n,"e",(function(){return i})),e.d(n,"f",(function(){return u})),e.d(n,"g",(function(){return o})),e.d(n,"h",(function(){return c})),e.d(n,"l",(function(){return a})),e.d(n,"a",(function(){return s})),e.d(n,"b",(function(){return f})),e.d(n,"j",(function(){return l})),e.d(n,"c",(function(){return d})),e.d(n,"k",(function(){return h})),e.d(n,"d",(function(){return p}));var r=6048e5,i=864e5,u=36e5,o=6e4,c=1e3,a=12,s=30,f=365,l=-864e13,d=864e13,h=Date.UTC(1601,0,1),p=Date.UTC(4501,0,1)},349:function(t,n,e){"use strict";var r=e(34);n.a=function(t,n){return new Date(+t+n*r.h)}},361:function(t,n,e){"use strict";e.d(n,"a",(function(){return u})),e.d(n,"b",(function(){return o}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function u(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}function o(t){return r.test(t)}},432:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(73);function i(t){return Object(r.a)(t,[r.c])}},447:function(t,n,e){"use strict";var r=function(){function t(t,n,e){this.maxParallelTasks=t,this.taskCallback=n,this.taskDelay=e,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var n=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(n).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();e.d(n,"a",(function(){return r}))},477:function(t,n){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},48:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(24);function i(){var t,n=null===(t=Object(r.a)())||void 0===t?void 0:t.pathname;if(n){var e=n.split("/").filter((function(t){return!!t}));return e[0]?e[0].toLowerCase():null}return null}},627:function(t,n,e){"use strict";var r=e(432),i=e(27),u=e(73);function o(t){return Object(u.a)(t,[u.b])}var c=e(19),a=e(48);function s(t){return Object(c.b)(Object(c.c)(Object(c.a)(Object(a.a)()||"",t)))}var f,l,d,h=e(757),p=e(752),b=e(132);function v(){return f||(f=Object(i.a)("/calendar")+"/"),f}function O(){return l||(l=Object(i.a)("/mail")+"/"),l}function j(){return d||(d=Object(i.a)("/files")+"/"),d}var m,k,w,g=e(758);function y(t){return m&&k===t||(k=t,m=t?Object(i.a)("/people/group/owner")+"/":Object(i.a)("/people/group/member")+"/"),m}function T(){return w||(w=Object(i.a)("/people/group/deleted")+"/"),w}function C(t){return window.location.origin+v()+"showPeek/item/"+encodeURIComponent(t)}var R=e(311),P=e(765),S=e(4),x=e(632),N=Object(P.a)().split("/").slice(1).join("/")+"deeplink/";function q(t,n,e,r){e&&((r=r||{}).minus="");var i="";if(r){var u=Object(S.b)();Object(x.a)(u),Object.keys(r).filter((function(t){return t})).forEach((function(t){return u[t]=r[t]})),i="?"+Object(S.h)(u)}var o={pathname:"/"+t+"/"+N+n,search:i};return R.format(o)}var D,E,I=e(156),A=e(30),L="https://to-do.microsoft.com";function z(t){var n,e,r=Object(A.a)(),i=r.UserOptions,u=null===(n=r.SessionSettings)||void 0===n?void 0:n.UserPrincipalName,o=L,c={};return(null===(e=null==i?void 0:i.ReactOptinSettings)||void 0===e?void 0:e.TasksRedirectUrl)&&(o=i.ReactOptinSettings.TasksRedirectUrl,u&&(c.auth_upn=u)),t&&(c.utm_source=t),Object.keys(c).length>0?Object(b.a)(o,c):o}function _(){return D||(D=Object(i.a)("/spaces")+"/"),D}function H(){return E||(E=Object(i.a)("/eventify")+"/"),E}var U=e(186);e.d(n,"i",(function(){return r.a})),e.d(n,"s",(function(){return i.a})),e.d(n,"e",(function(){return o})),e.d(n,"k",(function(){return s})),e.d(n,"r",(function(){return h.a})),e.d(n,"w",(function(){return c.a})),e.d(n,"a",(function(){return c.b})),e.d(n,"n",(function(){return p.a})),e.d(n,"u",(function(){return b.a})),e.d(n,"c",(function(){return v})),e.d(n,"j",(function(){return O})),e.d(n,"f",(function(){return j})),e.d(n,"o",(function(){return g.a})),e.d(n,"h",(function(){return y})),e.d(n,"g",(function(){return T})),e.d(n,"b",(function(){return C})),e.d(n,"p",(function(){return q})),e.d(n,"v",(function(){return I.a})),e.d(n,"t",(function(){return z})),e.d(n,"m",(function(){return _})),e.d(n,"d",(function(){return H})),e.d(n,"l",(function(){return U.a})),e.d(n,"q",(function(){return a.a}))},632:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=["hostApp","isanonymous","cspoff","frameName","opxInstanceId"];function i(t){t&&Object.keys(t).forEach((function(n){r.includes(n)&&delete t[n]}))}},73:function(t,n,e){"use strict";e.d(n,"c",(function(){return o})),e.d(n,"b",(function(){return c})),e.d(n,"a",(function(){return a}));var r=e(19),i=e(24),u=e(48),o=function(t){return!isNaN(parseInt(t))},c=function(t){return!!t.match(/.+@.+/)};function a(t,n){var e,o=t,c=null===(e=Object(i.a)())||void 0===e?void 0:e.pathname;if(c){var a=c.split("/"+Object(u.a)()+"/")[1];if(a){var s=a.split("/")[0];s&&n.filter((function(t){return t(s)})).length>0&&(o=Object(r.a)(o,s))}}return Object(r.b)(o)}},732:function(t,n,e){"use strict";function r(t){return t>=200&&t<300}e.d(n,"a",(function(){return r}))},752:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(24),i=e(27),u=e(186);function o(t){var n=Object(r.a)(),e=Object(u.a)()+Object(i.a)("/owa")+"/",o=n.search&&n.search.length>0;e+=o?n.search:"?";for(var c=Object.keys(t),a=o,s=0;s<c.length;s++)a?e+="&":a=!0,e+=c[s]+"="+t[c[s]];return e}},757:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(4),i=e(632);function u(){var t=Object(r.b)();Object(i.a)(t);var n=Object(r.h)(t);return n.length>0?"?"+n:""}},758:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r,i=e(27);function u(){return r||(r=Object(i.a)("/people")+"/"),r}},765:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(48),i=e(27);function u(t){return(Object(i.a)("/"+(t||Object(r.a)()))+"/").replace(/^\//,"")}},940:function(t,n,e){"use strict";e.r(n);var r=e(2217);function i(t,n,e,i){return Object(r.f)(e,n,i,t)}e.d(n,"makeOwsPrimeRequest",(function(){return r.f})),e.d(n,"makePostRequest",(function(){return r.d})),e.d(n,"makePatchRequest",(function(){return r.c})),e.d(n,"makePutRequest",(function(){return r.e})),e.d(n,"makeGetRequest",(function(){return r.b})),e.d(n,"makeDeleteRequest",(function(){return r.a})),e.d(n,"sendOwsPrimeRequest",(function(){return i}))}}]);
//# sourceMappingURL=owa.OwsGateway.js.map
self.scriptsLoaded['owa.OwsGateway.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OwsGateway.js'] = (new Date()).getTime();