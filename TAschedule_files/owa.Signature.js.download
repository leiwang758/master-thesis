self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Signature.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[919],{11065:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n(319),i=n(3),u=n(2198),c=Object(i.mutatorAction)("setDefaultSignatureName",(function(t,e){e?Object(u.a)().defaultReplySignatureName=t:Object(u.a)().defaultSignatureName=t})),o=Object(i.mutatorAction)("setLegacySignatureInStore",(function(t,e){"html"==t?Object(u.a)().legacySignature.html=e:"txt"==t&&(Object(u.a)().legacySignature.txt=e)})),l=Object(i.mutatorAction)("setRoamingSignatureInStore",(function(t){var e=Object(u.a)().roamingSignatureMap;if("htm"==t.secondaryKey)(n=e.get(t.name))?n.html=t:n={html:t,txt:null},e.set(t.name,n);else if("txt"==t.secondaryKey){var n;(n=e.get(t.name))?n.txt=t:n={html:null,txt:t},e.set(t.name,n)}})),s=n(96),g=n(6778),b=n(11),m=n(15067);var f,d=n(5342);function v(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return f||(f=Object(r.b)(d.a+"?settingname="+d.d+","+d.f+","+d.e+","+d.c+","+d.b,null,!1,{"x-outlook-client":"owa"}).then((function(t){var e;t.forEach((function(t){switch(t.name){case d.d:o("html",t);break;case d.f:o("txt",t);break;case d.e:e=t.value,n=t.value,Object(r.b)(d.a+"?settingname="+n,null,!1,{"x-islargesetting":!0}).then((function(t){t.forEach((function(t){l(t)}))}));break;case d.c:c(t.value,!1);break;case d.b:c(t.value,!0)}var n})),""==e&&function(){var t,e,n=Object(u.a)(),a=n.roamingSignatureMap,r=n.legacySignature,i=Object(s.h)().UserOptions,o=i.AutoAddSignature,f=i.AutoAddSignatureOnReply;if(null===(t=r.html)||void 0===t?void 0:t.value){var d={name:Object(b.b)(m.a),value:r.html.value,secondaryKey:"htm"};if(l(d),null===(e=r.txt)||void 0===e?void 0:e.value){var v={name:Object(b.b)(m.a),value:r.txt.value,secondaryKey:"txt"};l(v)}Object(g.c)(a),Object(g.d)(),o&&(c(Object(b.b)(m.a),!1),Object(g.b)(Object(b.b)(m.a))),f&&(c(Object(b.b)(m.a),!0),Object(g.a)(Object(b.b)(m.a)))}}()}))),[2,f]}))}))}var O=n(4309),j=n(77),S=n(30);function h(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,e;return Object(a.__generator)(this,(function(n){if(Object(j.i)("cmp-roaming-signature")){if(null===(t=Object(u.a)()).legacySignature.html||null===t.legacySignature.txt)return[2,v()]}else if(null===(e=Object(S.a)().UserOptions).SignatureHtml||null===e.SignatureText)return[2,O.a.importAndExecute()];return[2,Promise.resolve()]}))}))}n.d(e,"loadSignature",(function(){return h}))},15067:function(t){t.exports=JSON.parse('{"a":"Lmb"}')},2198:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return c}));var a=n(20),r=n(3),i={legacySignature:{html:null,txt:null},roamingSignatureMap:new a.ObservableMap,defaultSignatureName:"",defaultReplySignatureName:""},u=Object(r.createStore)("signature",i),c=u()},4309:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n(74),r=new a.c((function(){return n.e(849).then(n.bind(null,6922))})),i=new a.a(r,(function(t){return t.loadSignatureInUserOptions}))},5342:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"e",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return u})),n.d(e,"d",(function(){return c})),n.d(e,"f",(function(){return o}));var a="/ows/beta/OutlookCloudSettings/settings/account",r="roaming_signature_list",i="roaming_new_signature",u="roaming_reply_signature",c="signaturehtml",o="signaturetxt"},6778:function(t,e,n){"use strict";n.d(e,"c",(function(){return b})),n.d(e,"d",(function(){return m})),n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return d}));var a=n(0),r=n(2198),i=n(319),u=n(5342),c=n(30),o=621355968e9,l=1e4,s="encoding:utf-8",g={"x-outlook-client":"owa",Accept:"application/json","x-overridetimestamp":!0};function b(t){var e=[];t.forEach((function(t,n){e.push.apply(e,Object(a.__spread)(function(t){var e=t.html.name,n=t.txt?t.txt.value:"";return[v(e,t.html.value,"Blob","RoamingSetting","htm",!0,"roaming_signature_list"),v(e,n,"Blob","RoamingSetting","txt",!0,"roaming_signature_list")]}(t)))})),e.length>0&&Object(i.c)(u.a,e,null,!0,Object(a.__assign)(Object(a.__assign)({},g),{"x-islargesetting":!0}))}function m(){var t=r.b.roamingSignatureMap,e=[];t.forEach((function(t){var n;(null===(n=t.html)||void 0===n?void 0:n.name)&&e.push(t.html.name)}));var n=[v(u.e,e.join(),"BlobArray","RoamingSetting",u.e,!1)];Object(i.c)(u.a,n,null,!0,g)}function f(t){var e=[v(u.c,t,"String","RoamingSetting",u.c,!1)];Object(i.c)(u.a,e,null,!0,g)}function d(t){var e=[v(u.b,t,"String","RoamingSetting",u.b,!1)];Object(i.c)(u.a,e,null,!0,g)}function v(t,e,n,a,r,i,u){var g={name:t,value:e,type:n,scope:Object(c.a)().SessionSettings.UserEmailAddress,itemClass:a,timestamp:o+Date.now()*l,secondaryKey:r,metadata:s};return u&&(g.parentSetting=u),i&&(g["value@is.Large"]=i),g}}}]);
//# sourceMappingURL=owa.Signature.js.map
self.scriptsLoaded['owa.Signature.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Signature.js'] = (new Date()).getTime();