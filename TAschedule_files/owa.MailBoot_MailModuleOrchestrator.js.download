self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailModuleOrchestrator.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[643],{1347:function(e,n,t){"use strict";t.d(n,"l",(function(){return u})),t.d(n,"d",(function(){return a})),t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return f})),t.d(n,"c",(function(){return l})),t.d(n,"e",(function(){return b})),t.d(n,"i",(function(){return h})),t.d(n,"h",(function(){return v})),t.d(n,"f",(function(){return p})),t.d(n,"j",(function(){return O})),t.d(n,"k",(function(){return j})),t.d(n,"g",(function(){return g}));var r,c,i=t(33),o=t(30),u=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],a=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],s={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function d(){return Object(o.a)().SessionSettings.IsPremiumConsumerMailbox}function f(){return Object(o.a)().IsConsumerChild}function l(){return Object(o.a)().SessionSettings.IsShadowMailbox}function b(){return void 0!==c?c:c=function(){var e=Object(o.a)(),n=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return n?n.toLowerCase():"en-us";var t=e.AdMarket.toLowerCase();return u.indexOf(t)>-1?t:s[t.split("-")[1]]||t}()}function h(e){return null!=e?e.toUpperCase().split("-"):[]}function v(e){return h(e)[1]||"US"}function p(){return Object(i.a)("ANON")}function O(){return Object(i.a)("MUID")}function j(){return!!Object(i.a)("TOptOut")}function g(){return r||(r="https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}},1443:function(e,n,t){"use strict";var r=t(3),c=Object(r.action)("updateIsSuiteHeaderRendered",(function(e){return{isRendered:e}})),i=Object(r.action)("updateShySuiteHeaderMode",(function(e){return{isShy:e}})),o=Object(r.action)("setIsFlexPaneShown",(function(e){return{isShown:e}})),u=Object(r.createStore)("suiteHeaderStore",{isRendered:!1,isShy:!1,isFlexPaneShown:!1});Object(r.mutator)(c,(function(){u().isRendered=!0})),Object(r.mutator)(i,(function(e){var n=e.isShy;u().isShy=n})),Object(r.mutator)(o,(function(e){u().isFlexPaneShown=e.isShown}));function a(){return u().isShy}function s(){return u().isRendered}function d(){return u().isFlexPaneShown}t.d(n,"e",(function(){return c})),t.d(n,"f",(function(){return i})),t.d(n,"d",(function(){return o})),t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return s})),t.d(n,"a",(function(){return d}))},1453:function(e,n,t){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.Init=1]="Init",e[e.LeftNavResizeExpand=2]="LeftNavResizeExpand",e[e.ToggleExpand=3]="ToggleExpand",e[e.ToggleCollapse=4]="ToggleCollapse",e[e.WindowResize=5]="WindowResize",e[e.ToggleFolderPane=6]="ToggleFolderPane",e[e.DateRangeTypeChange=7]="DateRangeTypeChange",e[e.CalendarViewTypeChange=8]="CalendarViewTypeChange",e[e.OwaSuiteHeaderFlexPane=9]="OwaSuiteHeaderFlexPane"}(r||(r={}));var c=r,i=t(3),o=Object(i.createStore)("OwaLayout",{browserWidthBucket:null,areDisplayAdsEnabled:!1}),u=Object(i.mutatorAction)("setBrowserWidthBucket",(function(e){o().browserWidthBucket=e})),a=t(2);function s(e,n,t){var r=Object(a.m)(e);return n&&(r>1900?r-=305:r>990&&(r-=165)),t&&(r-=320),r>=1600?1600:r>=1400?1599:r>=1366?1399:r>=1301?1365:r>=1239?1300:r>=1200?1238:r>=1080?1199:r>=1e3?1079:r>=919?999:r>=900?918:r>=866?899:r>=769?865:r>=692?768:r>=686?691:r>=580?685:r>=555?579:r>=542?554:r>=500?541:r>=419?499:418}var d=Object(i.action)("onAvailableWidthBucketChanged",(function(e,n){return{availableWidthBucket:e,source:n}})),f=Object(i.mutatorAction)("setAreDisplayAdsEnabled",(function(e){o().areDisplayAdsEnabled=e}));function l(){return o().areDisplayAdsEnabled}var b=t(1443);function h(e){window.addEventListener("resize",v),f(e),p(c.Init)}function v(){p(c.WindowResize)}function p(e){var n=s(e!=c.Init,l(),Object(b.a)());o().browserWidthBucket!=n&&(u(n),n<=418?O():j(),d(n,e))}function O(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflowX="auto")}function j(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflow="hidden")}var g=t(55);function y(){return S()}function S(){return Object(g.l)()||Object(g.d)()}function w(){var e=o().browserWidthBucket;return e||void 0}Object(i.orchestrator)(b.d,(function(e){var n=s(!1,l(),e.isShown);u(n),d(n,c.OwaSuiteHeaderFlexPane)})),t.d(n,"a",(function(){return c})),t.d(n,"f",(function(){return h})),t.d(n,"b",(function(){return O})),t.d(n,"e",(function(){return j})),t.d(n,"d",(function(){return y})),t.d(n,"g",(function(){return S})),t.d(n,"h",(function(){return d})),t.d(n,"c",(function(){return w}))},1564:function(e,n,t){"use strict";var r=t(74),c={sequentialIndex:"0",nonSequentialIndex:"-1"};t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return a})),t.d(n,"d",(function(){return c}));var i=new r.c((function(){return t.e(832).then(t.bind(null,17522))})),o=new r.a(i,(function(e){return e.registerComponent})),u=new r.a(i,(function(e){return e.resetFocus})),a=new r.a(i,(function(e){return e.setFocusToSynchronous}))},1626:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(77),c=t(96);function i(){return Object(r.i)("mail-oneView")&&Object(c.r)()}},17292:function(e,n,t){"use strict";t.r(n);var r=t(2220),c=t(2221),i=t(281),o=t(1290),u=t(1407),a=Object(i.action)("onReadingPanePositionOptionSaved")((function(){Object(r.a)(!0),Object(c.a)(!Object(u.c)()),o.X.rowInfoForVLV.clear()})),s=t(1586),d=t(1450),f=Object(i.action)("onReplyOrReplyAllOrForwardMessage")((function(){var e=Object(d.d)();!Object(u.c)()||e&&e.type!=d.a.Primary||(Object(s.z)(!0),Object(s.y)(!1))})),l=Object(i.action)("onSelectMessageAd")((function(){Object(s.z)(!0),Object(s.y)(!Object(u.c)())})),b=t(1970),h=t(1564),v=t(1463);function p(e){if(Object(u.c)())switch(e){case v.b.MailList:Object(b.a)();break;case v.b.ReadingPane:case v.b.ConversationAttachmentWell:}h.b.importAndExecute()}Object(v.l)().eventManager.on(v.g.CloseEvent,p);var O=t(2886),j=t(3),g=(Object(j.orchestrator)(O.a,(function(e){3==e.event&&(Object(s.y)(!0),Object(s.z)(!Object(u.c)()))})),t(0)),y=t(74),S=t(1859),w=t(1828),m=Object(y.e)(s.w,"CLONE_CLIENT_READING_PANE_POSITION_CHANGE",(function(e){return Object(g.__awaiter)(void 0,void 0,void 0,(function(){var e,n,t,r,c;return Object(g.__generator)(this,(function(i){return e=Object(w.a)(),n=Object(u.c)(),t=!n||Object(S.a)()&&1==(null===(c=null==e?void 0:e.selectedRowKeys)||void 0===c?void 0:c.size),r=!n||!t,Object(s.z)(t),Object(s.y)(r),o.X.rowInfoForVLV.clear(),[2]}))}))})),I=t(3167),k=t(1877),_=t(3397),A=t(266),P=Object(y.e)(b.a,"closeImmersiveReadingPaneClone",(function(e){if(!Object(u.c)())throw new Error("closeImmersiveReadingPane should only be called with reading pane off");var n=Object(w.a)(),t=Object(_.b)(n.tableQuery);if("messageSuggestion"!==t){var r=e.source||"Unknown";Object(A.q)("Immersive_ReadingPaneClosed",[r,"mail"===t]);var c=Object(S.a)();if(Object(s.y)(!0),Object(s.z)(!1),c&&1==n.selectedRowKeys.size){var i=Object(g.__spread)(n.selectedRowKeys.keys())[0];k.h.importAndExecute(i,n)}}else Object(I.a)("CommandBar")}));t.d(n,"onReadingPanePositionOptionSaved",(function(){return a})),t.d(n,"onReplyOrReplyAllOrForwardMessage",(function(){return f})),t.d(n,"onSelectMessageAd",(function(){return l})),t.d(n,"onSxSPreviewPaneClose",(function(){return p})),t.d(n,"onClientReadingPanePositionChangeOrchestrator",(function(){return m})),t.d(n,"closeImmersiveReadingPaneOrchestrator",(function(){return P}))},1811:function(e,n,t){"use strict";var r=t(1626),c=t(77),i=t(1347),o=t(681);function u(){return Object(c.i)("auth-cloudCache")&&(Object(i.b)()||Object(i.c)())&&Object(o.a)()||Object(r.a)()}t.d(n,"a",(function(){return u}))},1859:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(1468);function c(){return Object(r.a)().showReadingPane}},1877:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"j",(function(){return u})),t.d(n,"k",(function(){return a})),t.d(n,"d",(function(){return s})),t.d(n,"c",(function(){return d})),t.d(n,"f",(function(){return f})),t.d(n,"b",(function(){return l})),t.d(n,"i",(function(){return b})),t.d(n,"e",(function(){return h})),t.d(n,"h",(function(){return v})),t.d(n,"g",(function(){return p}));var r=t(74),c=t(2150),i=new r.c((function(){return Promise.all([t.e(21),t.e(55),t.e(649)]).then(t.bind(null,3979))})),o=new r.a(i,(function(e){return e.clearAutoMarkAsReadTimer})),u=new r.a(i,(function(e){return e.setAutoMarkAsReadTimer})),a=new r.a(i,(function(e){return e.toggleRowReadState})),s=new r.b(i,(function(e){return e.markItemsAsReadBasedOnNodeIds})),d=new r.a(i,(function(e){return e.markItemAsReadFromReadingPane})),f=new r.a(i,(function(e){return e.onKeyboardMarkAsRead})),l=new r.a(i,(function(e){return e.markAsReadInTable})),b=new r.a(i,(function(e){return e.onSingleSelectionChanged})),h=new r.b(i,(function(e){return e.markReadOnTableViewChange})),v=new r.a(i,(function(e){return e.onReadingPaneClosed})),p=new r.a(i,(function(e){return e.onNavigateAwayViaUpDown}));Object(r.f)(c.b,i,(function(e){return e.onItemPartDeselectedOrchestrator}))},1899:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1407),c=t(1859);function i(){return Object(r.c)()&&Object(c.a)()}},1994:function(e,n,t){"use strict";var r=function(){function e(){this.eventDictionary={}}return e.prototype.on=function(e,n,t){return(this.eventDictionary[e]||(this.eventDictionary[e]=[])).push({callback:n,callbackThis:t}),this},e.prototype.emit=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];var r=(this.eventDictionary[e]||[]).slice();return r.forEach((function(e){return e.callback.apply(e.callbackThis,n)})),this},e.prototype.off=function(e,n){var t=this.eventDictionary[e];if(t){var r=t.filter((function(e){return e.callback!==n}));r.length?this.eventDictionary[e]=r:delete this.eventDictionary[e]}return this},e.prototype.once=function(e,n,t){var r=this,c=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return r.off(e,c),n.apply(t,i)};return(this.eventDictionary[e]||(this.eventDictionary[e]=[])).push({callback:c,callbackThis:t}),this},e}();n.a=r},2008:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(3),c=Object(r.action)("setShowFolderPane",(function(e){return{showFolderPane:e}}))},2018:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Initial=0]="Initial",e[e.Adaptive=1]="Adaptive",e[e.Show=2]="Show",e[e.Hide=3]="Hide",e[e.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},2043:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Blank=0]="Blank",e[e.Loading=1]="Loading",e[e.Error=2]="Error",e[e.Custom=3]="Custom",e[e.Image=4]="Image",e[e.Wac=5]="Wac",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.Text=8]="Text",e[e.NativePdf=9]="NativePdf",e[e.PdfJs=10]="PdfJs",e[e.IFrame=11]="IFrame"}(r||(r={}))},2087:function(e,n,t){"use strict";t.d(n,"b",(function(){return c})),t.d(n,"a",(function(){return i})),t.d(n,"d",(function(){return o})),t.d(n,"e",(function(){return u})),t.d(n,"c",(function(){return a}));var r=t(0);function c(e){return Object(r.__assign)({},e)}function i(e){return Object(r.__assign)({},e)}function o(e){return Object(r.__assign)({},e)}function u(e){return Object(r.__assign)({},e)}function a(e){return Object(r.__assign)({},e)}},2088:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return c})),t.d(n,"c",(function(){return i}));var r=350,c=270,i=418},2113:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(0);function c(e){return Object(r.__assign)({__type:"UnifiedGroupIdentity:#Exchange"},e)}},2148:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1453),c=t(1407);function i(){var e=Object(r.c)();return Object(c.a)()?e<=541:e<=918}},2150:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return i}));var r=t(3),c=Object(r.action)("CLOSE_DEEPLINK_READING_PANE"),i=Object(r.action)("ON_ITEM_PART_DESELECTED",(function(e,n){return{itemId:e,tableView:n}}))},2191:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(1468);function c(){return Object(r.a)().showFolderPane}},2536:function(e,n,t){"use strict";var r=t(760),c=t(554),i=t(0);function o(e){return Object(i.__assign)({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function u(e){return Object(i.__assign)({__type:"SearchFolderScopeType:#Exchange"},e)}var a=t(2113),s=t(1351);var d=t(30),f=t(1301),l=t(2087),b=t(1306),h=t(2466);t.d(n,"a",(function(){return w})),t.d(n,"b",(function(){return m})),t.d(n,"c",(function(){return I}));var v={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){var e,n,t=[];t.push(Object(l.b)({folderId:Object(f.a)(b.j),kind:"PrimaryMailbox"}));var r=Object(h.b)("primary");try{for(var c=Object(i.__values)(r),o=c.next();!o.done;o=c.next()){var u=o.value;t.push(Object(l.b)({folderId:u,kind:"PrimaryMailbox"}))}}catch(n){e={error:n}}finally{try{o&&!o.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return t},getSearchScopeType:function(e){var n,t,o=Object(s.a)(e.folderId);return n="none"!=o?Object(r.a)({Id:o}):Object(c.a)({Id:e.folderId}),[(t={FolderScope:u({BaseFolderId:n}),IsDeepTraversal:!0},Object(i.__assign)({__type:"PrimaryMailboxSearchScopeType:#Exchange"},t))]}},p={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){var e,n=[],t=Object(d.a)();return(null===(e=null==t?void 0:t.SessionSettings)||void 0===e?void 0:e.IsExplicitLogon)||n.push(Object(l.a)({folderId:Object(f.a)(b.d),kind:"ArchiveMailbox"})),n.push(Object(l.a)({folderId:Object(f.a)(b.a),kind:"ArchiveMailbox"})),n},getSearchScopeType:function(e){var n,t,a=Object(s.a)(e.folderId);return n="none"!=a?Object(r.a)({Id:a}):Object(c.a)({Id:e.folderId}),"archivemsgfolderroot"==a?[(t={ArchiveTypes:16777215},Object(i.__assign)({__type:"LargeArchiveSearchScopeType:#Exchange"},t))]:[o({FolderScope:u({BaseFolderId:n})})]}},O={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},j={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(n={GroupIdentity:Object(a.a)({Type:0,Value:e.groupId})},Object(i.__assign)({__type:"SingleGroupSearchScopeType:#Exchange"},n))];var n}},g={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},y={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},S=function(e){switch(e.kind){case"PrimaryMailbox":return v;case"ArchiveMailbox":return p;case"SharedFolders":return O;case"Group":return j;case"Calendar":return g;case"PublicFolder":return y;default:throw new Error("Unregistered search scope")}},w=function(e){return S(e).getKey(e)},m=function(e){return S(e).getSearchScopeList()},I=function(e){return S(e).getSearchScopeType(e)}},2851:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(1468);function c(){return Object(r.a)().showListPane}},2886:function(e,n,t){"use strict";var r=t(3),c=Object(r.action)("OnComposeLifecycleEvent",(function(e,n){return{viewState:e,event:n}}));n.a=c},3033:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(2536);function c(e,n){return!(!e||!n)&&Object(r.a)(e)===Object(r.a)(n)}},3397:function(e,n,t){"use strict";var r=t(0);function c(e,n,t,c,i,o,u,a,s,d){return{folderId:null,type:1,listViewType:i,searchNumber:e,queryString:n,searchScope:t,pillSuggestions:Object(r.__spread)(c.values()),includeAttachments:o,fromDate:u,toDate:a,scenarioType:"mail",lastIndexFetched:0,searchProvider:s,viewFilter:d||"All"}}function i(e){var n=e;return 1==e.type?n.scenarioType:void 0}var o=t(1306),u=t(1305),a=t(1301),s=t(2087),d=t(3033);function f(e){var n=e;return Object(u.m)(n.folderId)?Object(d.a)(n.searchScope,Object(s.a)({folderId:Object(a.a)(o.b),kind:"ArchiveMailbox"})):Object(d.a)(n.searchScope,Object(s.b)({folderId:Object(a.a)(o.h),kind:"PrimaryMailbox"}))}t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return f}))},681:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(24),c=t(48);function i(){var e,n=null===(e=Object(r.a)())||void 0===e?void 0:e.pathname;if(n){var t=n.split("/"+Object(c.a)()+"/")[1];if(t){var i=t.split("/")[0];if(i&&!isNaN(parseInt(i)))return!0}}return!1}}}]);
//# sourceMappingURL=owa.MailBoot~MailModuleOrchestrator.js.map
self.scriptsLoaded['owa.MailBoot~MailModuleOrchestrator.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailModuleOrchestrator.js'] = (new Date()).getTime();