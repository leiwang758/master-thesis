self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~TimePanelCalendar~WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[276],{3388:function(e,t,n){"use strict";var r=n(3),a=n(72),i=Object(r.action)("updateSelectedCalendarView",(function(e){return{updatedView:e}})),c=Object(r.action)("updateIsTaskListSelected",(function(e){return Object(a.c)({name:"updateIsTaskListSelected",customData:{isSelected:e}},{isSelected:e})})),u=Object(r.action)("updateIsDatePickerExpanded",(function(e){return Object(a.c)({name:"updateIsDatePickerExpanded",customData:{isExpanded:e}},{isExpanded:e})})),s=n(96),d=n(4188),o=Object(r.createStore)("calendarListSettingsStore",{selectedView:Object(d.a)().initialCalendarView,isDatePickerExpanded:Object(s.s)(),isTaskListSelected:!0});function l(){return o().selectedView}function b(){return o().isTaskListSelected}function f(){return o().isDatePickerExpanded}var O=n(2108),j=n(290);function w(e){o().isDatePickerExpanded=e}function v(e){o().isTaskListSelected=e}Object(r.mutator)(u,(function(e){return w(e.isExpanded)})),Object(r.mutator)(O.j,(function(e){var t=e.settings,n=e.userIdentity;Object(j.d)().userIdentity===n&&null!==t.isTimePanelDatePickerExpanded&&void 0!==t.isTimePanelDatePickerExpanded&&w(e.settings.isTimePanelDatePickerExpanded)})),Object(r.mutator)(c,(function(e){return v(e.isSelected)})),Object(r.mutator)(O.j,(function(e){var t=e.settings,n=e.userIdentity;Object(j.d)().userIdentity===n&&null!==t.isTimePanelCalendarViewTaskListSelected&&void 0!==t.isTimePanelCalendarViewTaskListSelected&&v(e.settings.isTimePanelCalendarViewTaskListSelected)}));var S=Object(r.action)("updateSelectedCalendarViewInStore",(function(e){return{updatedView:e}})),m=(Object(r.mutator)(S,(function(e){var t=e.updatedView;o().selectedView=t})),n(0)),p=n(677),g=n(56),I=Object(p.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(p.a)(1e3)}),_=null;Object(r.orchestrator)(u,(function(e){return Object(m.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(m.__generator)(this,(function(r){switch(r.label){case 0:t=e.isExpanded,r.label=1;case 1:return r.trys.push([1,3,,4]),_&&_.cancel(),[4,(_=I((function(){return Object(O.d)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),g.g.warn("updateIsDatePickerExpandedOrchestrator: updateIsTimePanelDatePickerExpandedService with retry failed: "+n),[3,4];case 4:return _=null,[2]}}))}))}));var h=Object(p.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(p.a)(1e3)}),D=null;Object(r.orchestrator)(c,(function(e){return Object(m.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(m.__generator)(this,(function(r){switch(r.label){case 0:t=e.isSelected,r.label=1;case 1:return r.trys.push([1,3,,4]),D&&D.cancel(),[4,(D=h((function(){return Object(O.c)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),g.g.warn("updateIsTaskListSelectedOrchestrator: updateIsTimePanelCalendarViewTaskListSelectedService with retry failed: "+n),[3,4];case 4:return D=null,[2]}}))}))}));var E=Object(p.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(p.a)(1e3)}),T=null;Object(r.orchestrator)(i,(function(e){return Object(m.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(m.__generator)(this,(function(r){switch(r.label){case 0:t=e.updatedView,S(t),r.label=1;case 1:return r.trys.push([1,3,,4]),T&&T.cancel(),[4,(T=E((function(){return Object(O.e)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),g.g.warn("updateSelectedCalendarViewOrchestrator: updateSelectedCalendarView with retry failed: "+n),[3,4];case 4:return T=null,[2]}}))}))}));Object(r.orchestrator)(O.j,(function(e){var t=e.settings,n=e.userIdentity;Object(j.d)().userIdentity===n&&t.timePanelSelectedCalendarView&&S(t.timePanelSelectedCalendarView)}));n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return f}))},4510:function(e,t,n){"use strict";var r,a=n(3),i=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS_IN_STORE",(function(e,t){return{calendarIds:e,userIdentity:t}})),c=Object(a.action)("SET_TIME_PANEL_CONFIG_LOAD_STATE",(function(e,t){return{loadState:e,userIdentity:t}})),u=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",(function(e,t){return{calendarIds:e,userIdentity:t}})),s=Object(a.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED");!function(e){e[e.Loaded=0]="Loaded",e[e.Failed=1]="Failed"}(r||(r={}));var d=n(2108),o=(Object(a.orchestrator)(d.b,(function(e){c(r.Failed,e.userIdentity),s()})),n(20)),l=Object(a.createStore)("timePanelSelectedCalendarIdsStore",{configLoadStates:new o.ObservableMap,calendarIdsMap:new o.ObservableMap}),b=n(1489);function f(){return Object(b.c)(l().calendarIdsMap)}function O(e){return e?function(e){var t=f().get(e);return t?t.length:0}(e):Object(b.d)(f()).length}function j(){return O()>0}var w=n(1753),v=(Object(a.orchestrator)(w.f,(function(){j()||s()})),n(0));function S(){return l().configLoadStates}var m=n(389),p=n(290);function g(){var e=S(),t=0===e.size,n=new o.ObservableMap;if(t)return n;var a=Object(w.b)(),i=f();return Object(v.__spread)([Object(p.d)().userIdentity],Object(m.n)().map((function(e){return e.userIdentity}))).forEach((function(t){j()&&e.get(t)!==r.Failed?n.set(t,i.get(t)):n.set(t,a.get(t))})),n}var I=n(677),_=n(56),h=n(96),D=Object(I.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(I.a)(1e3)}),E={};Object(a.orchestrator)(u,(function(e){return Object(v.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(v.__generator)(this,(function(r){switch(r.label){case 0:return t=e.calendarIds,n=e.userIdentity,Object(p.d)().userIdentity===n&&1===O()&&1===O(n)&&0===t.length?[2]:j()?[3,2]:[4,T()];case 1:r.sent(),r.label=2;case 2:return P(t,n),[2]}}))}))}));function T(){return Object(v.__awaiter)(this,void 0,void 0,(function(){return Object(v.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all(Object(h.e)().map((function(e){var t;P(null!==(t=Object(w.b)().get(e))&&void 0!==t?t:[],e,!0)})))];case 1:return e.sent(),[2]}}))}))}var y=1e3;function P(e,t,n){var r;return Object(v.__awaiter)(this,void 0,void 0,(function(){var a,c,u,o,l,f;return Object(v.__generator)(this,(function(O){switch(O.label){case 0:a=Object(b.b)(e),c=g().get(t),O.label=1;case 1:return O.trys.push([1,3,4,5]),i(a,t),n||s(),null===(r=E[t])||void 0===r||r.cancel(),u=D((function(){return Object(d.g)(a,t)})),j=u.retriableFunc,w=y,v=!1,l={cancel:function(){o.cancel(),u.cancel()},updateFunc:(o={delayFunc:function(){return new Promise((function(e,t){return function(e,t){setTimeout((function(){if(!v)return j(),e()}),w)}(e)}))},cancel:function(){return v=!0}}).delayFunc},E[t]=l,[4,l.updateFunc()];case 2:return O.sent(),[3,5];case 3:return f=O.sent(),_.g.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+f),i(c,t),n||s(),[3,5];case 4:return delete E[t],[7];case 5:return[2]}var j,w,v}))}))}Object(a.orchestrator)(d.j,(function(e){var t,n=e.settings,a=e.userIdentity;c(r.Loaded,a),(null===(t=n.timePanelCalendarIds)||void 0===t?void 0:t.length)>0&&i(n.timePanelCalendarIds,a),s()})),Object(a.mutator)(c,(function(e){var t=e.userIdentity,n=e.loadState;l().configLoadStates.set(t,n)})),Object(a.mutator)(i,(function(e){var t=e.calendarIds,n=e.userIdentity;l().calendarIdsMap.set(n,Object(b.b)(t))}));function L(){return Object(b.d)(g())}n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return L}))},9575:function(e,t,n){"use strict";var r=n(3),a=n(72),i=Object(r.action)("updateWasSuggestionDisabled",(function(e){return Object(a.c)({name:"updateWasSuggestionDisabledSetting",options:{isCore:!0},customData:{wasDisabled_1:e}},{wasDisabled:e})})),c=Object(r.createStore)("focusTimeSettingsStore",{wasSuggestionDisabled:!1});function u(){return c().wasSuggestionDisabled}var s=n(2108),d=n(290);Object(r.mutator)(i,(function(e){c().wasSuggestionDisabled=e.wasDisabled})),Object(r.mutator)(s.j,(function(e){var t=e.settings,n=e.userIdentity;Object(d.d)().userIdentity===n&&t.wasFocusTimeSuggestionDisabled&&(c().wasSuggestionDisabled=t.wasFocusTimeSuggestionDisabled)}));var o=n(0),l=n(677),b=n(56),f=Object(l.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(l.a)(1e3)}),O=null;Object(r.orchestrator)(i,(function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:t=e.wasDisabled,r.label=1;case 1:return r.trys.push([1,3,,4]),O&&O.cancel(),[4,(O=f((function(){return Object(s.i)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),b.g.warn("updateWasSuggestionDisabledOrchestrator: updateWasFocusTimeSuggestionDisabledService with retry failed: "+n),[3,4];case 4:return O=null,[2]}}))}))})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u}))}}]);
//# sourceMappingURL=owa.MailBoot~TimePanelCalendar~WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.MailBoot~TimePanelCalendar~WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~TimePanelCalendar~WorkloadScenarioSettings.js'] = (new Date()).getTime();