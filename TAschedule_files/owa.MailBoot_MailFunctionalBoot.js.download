self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[637],{12937:function(e){e.exports=JSON.parse('{"a":"eEc"}')},1331:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function o(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},1333:function(e,t,n){"use strict";var r=n(0),o=n(1394),i=n(389),a=n(669),c=n(266),u=n(10),s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";function b(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,b,v,O,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(i.k)(e)){if(b.accountState==i.b.AccessRevoked)return[2,null];if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.c)(b.accountState,b.accountProviderType),[2,null]}return t?(n[s]=t,n[f]=t):b&&(n[s]=b.anchorMailbox),b?(v=b.token,!(O=Object(a.g)(b.tokenExpiry))&&v?[3,2]:(Object(c.q)("getAndUpdateAccessToken",{tokenExpiry:Object(u.y)(b.tokenExpiry,Object(u.Pb)()),isTokenExpired_1:O,isTokenInvalid_2:!v},{isCore:!0}),[4,o.a.importAndExecute(b.accountId,e,v)])):[3,3];case 1:(v=r.sent())||(v=""),r.label=2;case 2:p=void 0,"Outlook"==b.accountProviderType?(p='MSAuth1.0 usertoken="'+v+'", type="MSACT"',n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(p="Bearer "+v,n[l]=2..toString()),n[d]=p,r.label=3;case 3:return[2,n]}}))}))}var v=n(1331),O=n(56);function p(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(v.a)(),o=n,[4,j(e,t)];case 1:return o.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function j(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,[4,b(e.mailboxInfo.userIdentity,w(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(v.b)(o,i),[2,o]}}))}))}function w(e,t){var n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&O.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return w}))},1334:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},1394:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(74),o=n(1334);n.d(t,"b",(function(){return o.a}));var i=new r.c((function(){return n.e(1356).then(n.bind(null,1689))})),a=new r.a(i,(function(e){return e.getAndUpdateAccessToken}))},1410:function(e,t,n){"use strict";var r=n(0),o=n(1331);function i(e){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":e}}function a(e,t){t&&e&&Object(o.b)(t,i(e))}function c(e,t){var n,o=null!=t?t:{},i=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",a(e,i),Object(r.__assign)(Object(r.__assign)({},o),{headers:i})}var u=n(389),s=n(1333),d=n(68),l=n(339);function f(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(r.__generator)(this,(function(n){return[2,Object(d.b)().then((function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e?Object(u.r)(e.userIdentity)?[4,Object(s.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return t=r.sent(),l(n,t),[3,3];case 2:"GroupMailbox"!=e.type&&"TeamsMailbox"!=e.type||(o=i(e.mailboxSmtpAddress),l(n,o)),r.label=3;case 3:return[2,n]}}))}))}))]}))}))}function b(){return Object(d.b)().then((function(e){return e.prefer='exchange.Behavior="CalendarInternal"',e}))}function v(e){return void 0===e&&(e=null),Object(u.r)(e)?b().then((function(t){return Object(s.a)(e).then((function(e){return Object.keys(e).forEach((function(n){return t[n]=e[n]})),t}))})):Promise.resolve({})}var O=n(42);function p(e,t,n){var r=new Headers;return n&&r.set("X-OWA-CANARY",Object(O.a)()),t&&r.set("X-OWA-ActionName",t),e&&a(e,r),r}n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return p}))},1517:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return b}));var r=n(266),o="WebPushSetup";function i(e){O("vipMailEnabled",e)}function a(e){O("mailOption",e)}function c(e){O("reminderOption",e)}function u(e){O("enabled",e)}function s(e,t){O("disabled",e),O("allClients",t)}function d(e){(window.webPushOptics.enabled||window.webPushOptics.disabled)&&(O("result",e),v())}function l(){O("lightning","ignored"),v()}function f(e){O("permission",e)}function b(e){O("roaming",e)}function v(){Object(r.q)(o,window.webPushOptics,{isCore:!0}),window.webPushOptics={}}function O(e,t){window.webPushOptics[e]=t}window.webPushOptics={}},1573:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}));var r=n(74),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(23),n.e(791)]).then(n.bind(null,4507))})),i=new r.a(o,(function(e){return e.bootStrapWebPushService})),a=new r.b(o,(function(e){return e.userInitiatedWebPushSetupWorkflow})),c=new r.b(o,(function(e){return e.userInitiatedWebPushDisableWorkflow})),u=new r.b(o,(function(e){return e.unsubscribe})),s=new r.b(o,(function(e){return e.loadWebPushOptions})),d=Object(r.d)(o,(function(e){return e.WebPushDiscovery}))},1661:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1410);function o(e){return{headers:Object(r.e)(e,"GroupMailbox")}}},1702:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r,o=n(3),i=Object(o.createStore)("webPushStore",{currentView:0,webPushPermission:null===(r=window.Notification)||void 0===r?void 0:r.permission})(),a=Object(o.createStore)("localWebPushUserSettingStore",{userPreferenceIdentifier:null,lastSessionDate:null,uniqueDaysSessionCount:0,enabled:null,mailEnabled:null,reminderEnabled:null,vipMailEnabled:null,lastCheckboxUnchecked:null,promptCount:0,lastPromptDate:null})();function c(){return a}},17171:function(e,t,n){"use strict";n.r(t);var r=n(1301),o=n(3757),i=n(1290),a=n(77);function c(e){return Object(i.T)(Object(r.a)("inbox"))||Object(a.i)("rp-reactions")}var u=n(1318);function s(e){var t=Object(r.a)("inbox");return Object(i.T)(t)&&!Object(u.isPersonaInFavorites)(null,e.SenderSmtpEmailAddress)}var d=n(627),l=n(11),f=n(12937);var b=n(9570),v=n(2744),O=n(3),p=n(2550),j=n(7289);Object(O.orchestrator)(j.a,(function(e){var t={Subject:e.taskNewEventTitle,IsAllDayEvent:!0};p.g.importAndExecute("GetStarted","GetStarted",t)}));var w=n(1608),m=n(8482);Object(O.orchestrator)(m.a,(function(){w.f.importAndExecute("mail","attachments")}));var h=n(8483);Object(O.orchestrator)(h.a,(function(){w.f.importAndExecute("mail","messageContent")}));var I=n(8480);Object(O.orchestrator)(I.a,(function(){w.f.importAndExecute("general","timeAndLanguage")}));var g=n(1892),S=n(8481),x=n(8487),E=n(2886);Object(O.orchestrator)(S.a,(function(e){g.c.importAndExecute("GetStarted",void 0,void 0,e.taskSendEmailSubject,e.taskSendEmailBody)})),Object(O.orchestrator)(E.a,(function(e){1==e.event&&Object(x.a)()}));var P=n(8484),y=n(8488),C=n(74),N=new C.c((function(){return Promise.all([n.e(196),n.e(284),n.e(685)]).then(n.bind(null,17339))})),A=new C.a(N,(function(e){return e.showPersonalizationCard}));Object(O.orchestrator)(P.a,(function(){A.importAndExecute(y.a)}));var k=n(5948),_=n(4177),R=new C.c((function(){return n.e(309).then(n.bind(null,17555))})),M=new C.a(R,(function(e){return e.loadSenders})),T=n(9763),D=n(2752),L=new C.c((function(){return n.e(834).then(n.bind(null,17277))})),V=new C.a(L,(function(e){return e.subscribeToHierarchyNotification}));Object(C.f)(D.a,L,(function(e){return e.onNewFolderNotificationOrchestrator})),Object(C.f)(D.b,L,(function(e){return e.onUpdateFolderNotificationOrchestrator}));var U=n(20),K=n(1297),W=n(3032),F=n(56);function G(e,t){var n=function(e){var t={},n=K.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){F.d("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(W.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(l.f)(n.parentInternetMessageId))break;n=K.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){var n=new U.ObservableMap({});return t.forEach((function(t){var r=K.a.conversationNodes.get(t),o=t===e?i.a.CheckMark:i.a.None;n.set(r.internetMessageId,o)})),n}(e,t);for(var r=new U.ObservableMap({}),o=!1,a=!1,c=0,u=0;u<t.length;u++){var s=K.a.conversationNodes.get(t[u]);s&&(n[s.internetMessageId]?(o?c+1===Object.keys(n).length?(r.set(s.internetMessageId,i.a.BusEnd),a=!0):r.set(s.internetMessageId,i.a.BusStop):(r.set(s.internetMessageId,i.a.BusStart),o=!0),c++):!o||a?r.set(s.internetMessageId,i.a.None):r.set(s.internetMessageId,i.a.NoStop))}return r}var B=n(1505),X=n(4247),z=Object(O.action)("FOCUS_ITEM_PART",(function(e,t){return{nodeId:e,mailListItemSelectionSource:t}})),H=n(1501),q=n(7271),J=n(1305),Y=n(2554);function Q(){var e=H.a.expandedConversationViewState;e.expandedRowKey=null,e.focusedNodeId=null,e.selectedNodeIds=[],e.allNodeIds=[],e.shouldBeExpanded=!1,e.busStopStateMap=new U.ObservableMap({}),e.latestNodeIdsInEachFork=null}Object(O.mutator)(B.s,(function(e){var t=e.nodeId,n=H.a.expandedConversationViewState,r=n.selectedNodeIds,o=n.allNodeIds;H.a.expandedConversationViewState.focusedNodeId=t,r.indexOf(t)>-1?r.splice(r.indexOf(t),1):r.push(t),1===r.length&&(H.a.expandedConversationViewState.busStopStateMap=G(r[0],o))})),Object(O.mutator)(B.h,(function(e){H.a.expandedConversationViewState.busStopStateMap=new U.ObservableMap({})})),Object(O.mutator)(z,(function(e){H.a.expandedConversationViewState.focusedNodeId=e.nodeId})),Object(O.mutator)(B.p,(function(e){var t=e.rowKey,n=e.nodeIdToSelect,r=e.allNodeIds,o=H.a.expandedConversationViewState;o.selectedNodeIds=[n],o.busStopStateMap=G(n,r),o.expandedRowKey=t,o.focusedNodeId=n,o.allNodeIds=r})),Object(O.mutator)(B.t,(function(e){e.mailListItemSelectionSource===J.b.MailListItemCheckbox&&Q()})),Object(O.mutator)(X.a,(function(e){Q()})),Object(O.mutator)(B.i,(function(e){Q()})),Object(O.mutator)(B.k,(function(e){Q()})),Object(O.mutator)(B.a,(function(e){Q();var t=H.a.expandedConversationViewState;t.latestNodeIdsInEachFork=e.latestItemIdsInForks,t.expandedRowKey=e.rowKey})),Object(O.mutator)(B.q,(function(e){var t=H.a.expandedConversationViewState,n=e.rowKey,r=e.mailListItemSelectionSource;t.expandedRowKey!=n?Object(Y.d)()?(t.shouldBeExpanded=!0,t.expandedRowKey=n,t.latestNodeIdsInEachFork=[]):r===J.b.MailListItemTwisty&&(t.shouldBeExpanded=!0,t.expandedRowKey=n,t.latestNodeIdsInEachFork=null):r===J.b.MailListItemTwisty&&Object(Y.a)(n)&&(Q(),t.shouldBeExpanded=!0,t.expandedRowKey=n)})),Object(O.mutator)(B.o,(function(e){Q(),H.a.expandedConversationViewState.expandedRowKey=e.rowKey})),Object(O.mutator)(q.a,(function(e){if(1===H.a.expandedConversationViewState.selectedNodeIds.length){var t=H.a.expandedConversationViewState.selectedNodeIds[0],n=J.u.conversations.get(e.conversationId).conversationNodeIds;H.a.expandedConversationViewState.busStopStateMap=G(t,n)}}));var Z,$=n(0),ee=n(2894),te=n(9765),ne=n(1812),re=n(1407),oe=n(5499),ie=n(1445),ae=n(1438),ce=n(9691),ue=n(9571);Object(O.orchestrator)(B.b,(function(e){le(e.itemId,e.tableView,e.nodeId,e.allNodeIds,e.mailListItemSelectionSource)}));Object(O.orchestrator)(B.e,(function(e){if(1!=e.listViewType){var t=i.X.expandedConversationViewState,n=e.mailListItemSelectionSource==J.b.MailListItemTwisty;Object(Y.d)()&&t.expandedRowKey!=e.rowKey?pe(e.rowKey,e.tableView,n):t.expandedRowKey==e.rowKey&&(t.shouldBeExpanded?t.latestNodeIdsInEachFork?pe(e.rowKey,e.tableView,n):ve(e.rowKey,e.tableView):!t.latestNodeIdsInEachFork&&n&&Oe())}})),Object(O.orchestrator)(B.c,(function(e){Object(Y.c)(e.rowKey)&&Oe()})),Object(O.orchestrator)(B.m,(function(e){for(var t=i.b.getConversationId(e.rowKey,e.tableView),n=J.u.conversations.get(t),r=null,o=null,a=n.conversationNodeIds.indexOf(i.X.expandedConversationViewState.selectedNodeIds[0])+1;a<n.conversationNodeIds.length;a++){var c=n.conversationNodeIds[a],u=Object(ee.a)(c,Object(Y.a)(e.rowKey));if(u){o=u.ItemId.Id,r=c;break}}r?le(o,e.tableView,r,n.conversationNodeIds,J.b.RowRemoval):be(e.rowKey,e.tableView)}));var se=0,de=!0;function le(e,t,n,r,o){if(Z&&(clearTimeout(Z),Z=null),Object(te.a)(t,!0,o,void 0),o!==J.b.KeyboardUpDown||Object(re.c)())fe(e,t);else{var a=Date.now(),c=a-se;se=a,(de||c<=500)&&(de=!1,Z=setTimeout((function(){Z=null,de=!0,fe(e,t)}),250))}var u=i.X.expandedConversationViewState;B.p(u.expandedRowKey,n,r,t.id,u.selectedNodeIds)}function fe(e,t){if(Object(ie.a)())ne.o.importAndExecute({Id:e,mailboxInfo:Object(ae.b)(t)},!0,null,!1);else{var n=i.b.getRowClientItemId(i.X.expandedConversationViewState.expandedRowKey,t);ne.s.importAndExecute(null==n?void 0:n.Id,e,!0)}}function be(e,t,n){var r,o,a=n;if(!a||0==a.length){var c=i.b.getConversationId(e,t);a=J.u.conversations.get(c).conversationNodeIds}try{for(var u=Object($.__values)(a),s=u.next();!s.done;s=u.next()){var d=s.value,l=Object(ee.a)(d,Object(Y.a)(e));if(l){le(l.ItemId.Id,t,d,a,J.b.RowRemoval);break}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}}function ve(e,t){B.o(e),Object(oe.a)(t,!1),be(e,t)}function Oe(){B.i()}function pe(e,t,n){var r=i.b.getRowClientItemId(e,t),o=r.Id;Object(ce.c)(o)?je(o,e,t,n):Object(ue.b)(r,"CreateConversationRelationMap").then((function(){je(o,e,t,n)}))}function je(e,t,n,r){return Object($.__awaiter)(this,void 0,void 0,(function(){var o,a;return Object($.__generator)(this,(function(c){switch(c.label){case 0:return o=Object(i.K)(t,n.id),[4,Object(ce.b)(e,o.itemIds)];case 1:return(a=c.sent()).length>1?(B.a(t,a),be(t,n,a)):r?ve(t,n):B.a(t,[]),[2]}}))}))}var we=n(6521),me=n(6547),he=(Object(O.orchestrator)(me.a,(function(e){Object(we.a)(),1===Object(i.J)().expandedConversationViewState.selectedNodeIds.length&&B.h()})),n(8427)),Ie=n(2747),ge=(Object(O.orchestrator)(he.a,(function(e){if(i.X.expandedConversationViewState.expandedRowKey){var t=J.u.conversations.get(e.conversationId);B.p(i.X.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(Ie.a)())}})),n(7304)),Se=n(4416),xe=n(5625),Ee=n(1575),Pe=Object(O.action)("FOCUS_ROW_IN_DIRECTION",(function(e,t,n){return{tableView:e,selectionDirection:t,mailListItemSelectionSource:n}}));function ye(e,t,n){return Object(Ee.a)()?1===e&&n===i.d.Next||0===e&&n===i.d.Previous:e===t-1&&n===i.d.Next||e===t-2&&n===i.d.Previous}Object(O.orchestrator)(ge.a,(function(e){var t=e.selectionDirection,n=e.tableView,r=e.mailListItemSelectionSource,o=e.shouldSelect,a=Object($.__read)(function(e,t){var n=i.X.expandedConversationViewState,r=n.focusedNodeId,o=n.allNodeIds;if(!r)return[null,null];var a,c,u=o.indexOf(r);e===i.d.Next?(a=o.length-1,c=1):(a=0,c=-1);var s=Object(i.K)(t.focusedRowKey,t.id).id,d=i.X.conversationItems.get(s);for(;u!==a;){if(u+=c,Object(Se.a)(d.id)&&ye(u,o.length,e))return Object(xe.a)(d.clientId),["loading",null];var l=o[u],f=Object(ee.a)(l,Object(Y.a)(t.focusedRowKey));if(f)return[l,f]}return[null,null]}(t,n),2),c=a[0],u=a[1];"loading"!==c&&(c?o?B.b(c,u.ItemId.Id,i.X.expandedConversationViewState.allNodeIds,n,r):z(c,r):i.X.expandedConversationViewState.expandedRowKey&&t===i.d.Previous?B.c(i.X.expandedConversationViewState.expandedRowKey):o?B.n(n,t,r):Pe(n,t,r))}));var Ce=n(9766),Ne=n(4989),Ae=n(4594),ke=n(4593),_e=(Object(O.orchestrator)(Pe,(function(e){var t=e.tableView,n=e.selectionDirection,r=Object(Ce.a)(t,n);if(null!==r){var o=t.rowKeys[r];Object(Ne.a)(t,o),Object(ke.a)(t,o),Object(Ae.a)(t,null),B.i()}})),n(7305));Object(O.orchestrator)(_e.a,(function(e){var t=e.tableView,n=e.mailListItemSelectionSource,r=i.X.expandedConversationViewState.focusedNodeId;r?B.s(r):B.t(t,t.focusedRowKey,!0,n)}));var Re=n(1455),Me=n(5468),Te=n(7306);Object(O.orchestrator)(Te.a,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys,o=e.mailListItemSelectionSource;if(n.length>0&&o===Re.a.KeyboardEnter){if(1!==n.length)return;B.b(n[0],Object(Me.a)(n[0],Object(Y.a)(r[0])),i.X.expandedConversationViewState.allNodeIds,t,o)}else{if(1!==r.length)return;B.q(t,r[0],!0,o)}}));var De=n(29);var Le=n(318),Ve=n(2592),Ue=n(5852),Ke=n(3575),We=n(4287),Fe=n(8535),Ge=n(3574),Be=n(2230),Xe=n(2922),ze=n(3125),He=n(3577),qe=new C.c((function(){return Promise.all([n.e(265),n.e(871)]).then(n.bind(null,17226))})),Je=new C.a(qe,(function(e){return e.evaluatePlaywrightMailActions})),Ye=n(30),Qe=n(7029),Ze=n(1741),$e=n(1319);function et(){var e;Object(Ye.a)().IsMonitoring&&Je.importAndExecute(),V.importAndExecute(),Object(b.a)(!0),Object(a.i)("fwk-mailtoProtocolHandler")&&(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.registerProtocolHandler)&&window.navigator.registerProtocolHandler("mailto",""+Object(d.l)()+Object(d.j)()+"deeplink/compose?mailtouri=%s",Object(l.b)(f.a)),Xe.b.importAndExecute({condition:Object(a.i)("fwk-devTools")||Object(a.i)("sea-contextFeedback"),task:function(){return T.b.importAndExecute()}},tt,{condition:Object(a.i)("sea-clientWarmup")&&Object($e.u)(),task:function(){return Ze.l.importAndExecute()}},{condition:Object(a.i)("tri-spotlight2"),task:function(){return Ve.i.importAndExecute()}},(function(){return We.a.importAndExecute()}),{condition:Object(Le.a)(),task:function(){return M.importAndExecute()}},(function(){return Fe.b.importAndExecute()}),(function(){return Fe.a.importAndExecute()}),{condition:Object(Ge.j)(),task:function(){return Ge.d.importAndExecute()}},(function(){return Ge.e.importAndExecute()}),{condition:Object(Qe.a)(),task:function(){return k.c.importAndExecute()}},{condition:Object(a.i)("mc-personalization"),task:function(){Ue.b.importAndExecute()},idle:!0},{task:function(){return Ke.c.importAndExecute()},idle:!0},{condition:Object(ne.f)(),task:function(){return _.a.importAndExecute()},idle:!0},{task:function(){return v.d.importAndExecute()},idle:!0},{condition:Object(Be.e)(window),task:function(){return Be.j.importAndExecute(window)},idle:!0},{task:function(){return ze.a.importAndExecute()},idle:!0},{condition:Object(u.isNewsEnabled)(),task:function(){return He.e.importAndExecute()}},{condition:Object(a.i)("auth-activityFeed")&&Object(a.i)("auth-activityFeedWeveSignal"),task:function(){return v.e.importAndExecute()},idle:!0},{condition:Object(a.i)("rp-projectionPopout"),task:function(){return ne.h.importAndExecute()},idle:!0}).then((function(){Xe.a.importAndExecute()}))}function tt(){var e,t;Object(o.g)(s),Object(o.f)(c),e={isOWALogon:!0},Object(De.a)("ConnectedAccountsNotification",e,t)}var nt=n(1894);Object(O.orchestrator)(o.c,(function(e){return Object($.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,o,a,c;return Object($.__generator)(this,(function(u){switch(u.label){case 0:return t=e.notification,Object(i.P)(Object(i.G)())?(n=Object(J.g)().conversations.get(t.conversationId),r={Id:t.conversationId,mailboxInfo:Object(ae.a)()},n?[3,2]:[4,nt.d.importAndExecute(r,"LoadLikedConversation")]):[3,3];case 1:u.sent(),u.label=2;case 2:return rt(r,t.subject),[3,6];case 3:return o=Object(J.g)().items.get(t.itemId),a={Id:t.itemId,mailboxInfo:Object(ae.a)()},(null==o?void 0:o.NormalizedBody)?(rt(a,t.subject),[3,6]):[3,4];case 4:return c={Id:t.itemId,mailboxInfo:Object(ae.a)()},[4,nt.e.importAndExecute(c,"LoadLikedItem")];case 5:u.sent(),rt(c,t.subject),u.label=6;case 6:return[2]}}))}))}));function rt(e,t){ne.p.importAndExecute(e,t,[],!0,null)}var ot=n(8525),it=n(96);Object(O.orchestrator)(o.d,(function(e){var t=e.notification,n=1===Object(it.h)().UserOptions.GlobalListViewTypeReact?t.ItemId:t.ConversationId;Object(ot.a)("inbox",n)}));n.d(t,"setupMailModulePostRender",(function(){return et}))},1723:function(e,t,n){"use strict";n(1661);var r=n(1532),o=n(3),i=Object(o.action)("EDIT_GROUP_SUCCESS",(function(e,t){return{groupSmtp:e,photoUrl:t}})),a=Object(o.action)("ADD_GROUP_MEMBER_SUCCESS",(function(e){return{groupSmtp:e}})),c=Object(o.action)("MEMBER_MANAGEMENT_SUCCESS",(function(e){return{groupSmtp:e}})),u=Object(o.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),s=Object(o.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),d=Object(o.action)("DELETE_GROUP_SUCCESS",(function(e){return{groupSmtp:e}})),l=n(1652);n.d(t,"m",(function(){return r.a})),n.d(t,"l",(function(){return i})),n.d(t,"j",(function(){return a})),n.d(t,"n",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"o",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"g",(function(){return l.g})),n.d(t,"c",(function(){return l.c})),n.d(t,"d",(function(){return l.d})),n.d(t,"a",(function(){return l.a})),n.d(t,"e",(function(){return l.e})),n.d(t,"f",(function(){return l.f})),n.d(t,"i",(function(){return l.i})),n.d(t,"b",(function(){return l.b})),n.d(t,"h",(function(){return l.h}))},1727:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d}));var r=n(1702),o=n(2201),i=n(281),a=n(1732),c=Object(i.select)({store:function(){return r.b}})((function(e){return null!=e.store&&null==e.store.enabled&&e.store.uniqueDaysSessionCount>=a.b&&e.store.lastPromptDate!=Object(o.a)().toDateString()&&e.store.promptCount<=a.a})),u=Object(i.select)({store:function(){return r.b}})((function(e){return e.store.mailEnabled||e.store.reminderEnabled})),s=Object(i.select)({store:function(){return r.b}})((function(e){var t,n,r;return{newMail:null!==(t=e.store.mailEnabled)&&void 0!==t&&t,reminder:null!==(n=e.store.reminderEnabled)&&void 0!==n&&n,vipMailOnly:null!==(r=e.store.vipMailEnabled)&&void 0!==r&&r}})),d=Object(i.select)({store:function(){return r.b}})((function(e){return e.store.reminderEnabled&&e.store.enabled}))},1732:function(e,t,n){"use strict";var r=n(1702),o=n(2201),i=n(281),a=n(9),c="WebPushUserSettings",u=5;function s(e,t){for(var n=d(e),r=-1,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t.userPreferenceIdentifier){r=o;break}if(r>=0)n[r]=t;else{if(r=n.length,n.length>=u){r=0;var i=new Date(n[0].lastSessionDate);for(o=1;o<n.length;++o){var s=new Date(n[o].lastSessionDate);s.getTime()<i.getTime()&&(i=s,r=o)}}n[r]=t}!function(e,t){if(t.length>0){var n=JSON.stringify(t);Object(a.e)(e,c,n)}else Object(a.d)(e,c)}(e,n)}function d(e){var t=Object(a.a)(e,c),n=new Array;try{var r=JSON.parse(t);null!=r&&(n=r)}catch(t){Object(a.d)(e,c)}return n}var l=n(1727),f=n(77);n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return v})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return w})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return I}));var b=4,v=3,O=Object(i.select)({store:function(){return r.b}})(Object(i.action)("loadLocalWebPushUserSetting")((function(e,t,n){var r=function(e,t){for(var n=d(e),r=null,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t){r=n[o];break}return r}(e,t);if(null!=r)Object.keys(r).forEach((function(e){n.store[e]=r[e]})),I(e);else{var o=function(e,t){for(var n=d(e),r=null,o=0;o<n.length;++o)n[o].userPreferenceIdentifier<t&&(r?n[o].userPreferenceIdentifier>r.userPreferenceIdentifier&&(r=n[o]):r=n[o]);return r}(e,t);o&&(n.store.lastCheckboxUnchecked=o.lastCheckboxUnchecked,n.store.mailEnabled=o.mailEnabled,n.store.reminderEnabled=o.reminderEnabled,n.store.vipMailEnabled=o.vipMailEnabled),n.store.userPreferenceIdentifier=t,s(e,n.store)}}))),p=Object(i.select)({store:function(){return r.b}})(Object(i.action)("incrementUniqueDaysSessionCount")((function(e,t){var n=Object(o.a)().toDateString();t.store.lastSessionDate!=n&&(t.store.lastSessionDate=n,t.store.uniqueDaysSessionCount<b&&t.store.uniqueDaysSessionCount++,s(e,t.store))}))),j=Object(i.select)({store:function(){return r.b}})(Object(i.action)("resetLocalWebpushUserSetting")((function(e,t,n){n.store.userPreferenceIdentifier=t,n.store.enabled=!1,n.store.promptCount=0,n.store.lastPromptDate=null,n.store.uniqueDaysSessionCount=0,s(e,n.store)}))),w=Object(i.select)({store:function(){return r.b}})(Object(i.action)("updateLocalWebPushEnabledStatus")((function(e,t,n,r){r.store.enabled=t,r.store.userPreferenceIdentifier=n,t&&I(e),s(e,r.store)}))),m=Object(i.select)({store:function(){return r.b}})(Object(i.action)("incrementLocalWebPushPromptCount")((function(e,t){t.store.promptCount++,t.store.lastPromptDate=Object(o.a)().toDateString(),s(e,t.store)}))),h=Object(i.select)({store:function(){return r.b}})(Object(i.action)("resetLocalWebPushPromptCount")((function(e,t){t.store.promptCount=0,t.store.lastPromptDate=null,s(e,t.store)}))),I=Object(i.select)({store:function(){return r.b}})(Object(i.action)("validateAndUpdateCheckboxOptions")((function(e,t){if(t.store.enabled){if(!Object(l.b)())if(t.store.lastCheckboxUnchecked){switch(t.store.lastCheckboxUnchecked){case"NewMail":t.store.mailEnabled=!0;break;case"Reminder":t.store.reminderEnabled=!0}t.store.lastCheckboxUnchecked=null}else t.store.mailEnabled=!0,t.store.reminderEnabled=!0;1!=t.store.mailEnabled||null!=t.store.reminderEnabled&&null!=t.store.reminderEnabled||(t.store.reminderEnabled=!0)}Object(f.i)("auth-scheduleTimerForReminderWebPush")||Object(f.i)("auth-sendReminderWebPush")||(t.store.reminderEnabled=null,t.store.lastCheckboxUnchecked=null),s(e,t.store)})))},2028:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(20),o=n(3),i={clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap},a=Object(o.createStore)("protection",i),c=a()},2094:function(e,t,n){"use strict";function r(e,t){return e+"_"+(null!=t.enabledTimeInUTCMs?t.enabledTimeInUTCMs:"")}n.d(t,"a",(function(){return r}))},2112:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Unknown="Unknown",e.Like="Like",e.AtMention="AtMention",e.GroupMention="GroupMention",e.MeMention="MeMention",e.FileMention="FileMention",e.GroupAtAllMention="GroupAtAllMention",e.TxpRentalCarReservation="TxpRentalCarReservation",e.TxpFlightReservation="TxpFlightReservation",e.TxpLodgingReservation="TxpLodgingReservation",e.TxpFoodEstablishmentReservation="TxpFoodEstablishmentReservation",e.TxpEventReservation="TxpEventReservation",e.TxpParcelDelivery="TxpParcelDelivery",e.TxpInvoice="TxpInvoice",e.TxpServiceReservation="TxpServiceReservation",e.UserAtMentioned="UserAtMentioned",e.TaskNotificationInsight="TaskNotificationInsight",e.FollowUpNotificationInsight="FollowUpNotificationInsight",e.OutOfRoutineNotificationInsight="OutOfRoutineNotificationInsight",e.RealTimeFlightUpdate="RealTimeFlightUpdate",e.YammerLiveEventNotification="YammerLiveEventNotification",e.Reactions="Reactions"}(r||(r={}))},2161:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(77),o=n(55),i=n(30),a=n(1379),c=function(e){return!(!Object(r.i)("fwk-webPushNotification")&&!Object(r.i)("fwk-webPushNotificationV2"))&&(!(!e.navigator||null==e.navigator.serviceWorker||null==e.PushManager)&&((Object(o.e)()||Object(o.h)()||Object(r.i)("fwk-webPushNotificationExtended")&&(Object(o.f)()||Object(o.j)()))&&!Object(i.a)().SessionSettings.IsUserCultureRightToLeft&&(1==Object(a.b)()||2==Object(a.b)())))}},2201:function(e,t,n){"use strict";function r(){return new Date}n.d(t,"a",(function(){return r}))},2230:function(e,t,n){"use strict";var r=n(1517);n.d(t,"m",(function(){return r.b})),n.d(t,"l",(function(){return r.a})),n.d(t,"q",(function(){return r.i})),n.d(t,"n",(function(){return r.d})),n.d(t,"p",(function(){return r.g})),n.d(t,"o",(function(){return r.f}));var o=n(2094);n.d(t,"b",(function(){return o.a}));var i=n(1702);n.d(t,"a",(function(){return i.a}));var a=n(1732);n.d(t,"k",(function(){return a.e})),n.d(t,"r",(function(){return a.i}));var c=n(1727);n.d(t,"c",(function(){return c.b})),n.d(t,"d",(function(){return c.c}));var u=n(2161);n.d(t,"e",(function(){return u.a}));var s=n(1573);n.d(t,"j",(function(){return s.f})),n.d(t,"i",(function(){return s.e})),n.d(t,"h",(function(){return s.d})),n.d(t,"g",(function(){return s.c})),n.d(t,"f",(function(){return s.b}))},2316:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(30),o=n(77);function i(){var e;return(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(o.i)("cmp-proxy-address")}},2406:function(e,t,n){"use strict";var r=n(3),o=Object(r.createStore)("SkypeStore",{unreadConversationCount:0,isRecentsInitialized:!1,isSwcInitialized:!1,isGlimpseOpen:!1})();t.a=o},2550:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"g",(function(){return v}));var r=n(1789),o=n(74),i=new o.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(6),n.e(18),n.e(24),n.e(27),n.e(31),n.e(43),n.e(137),n.e(170),n.e(184),n.e(277),n.e(928)]).then(n.bind(null,3707))}));Object(o.f)(r.d,i,(function(e){return e.openTimePanelOrchestrator}));var a=Object(o.d)(i,(function(e){return e.TimePanel})),c=Object(o.d)(i,(function(e){return e.TimePanelHeaderBar})),u=new o.a(i,(function(e){return e.loadTimePanelData})),s=new o.a(i,(function(e){return e.openEventDetailsView})),d=(new o.a(i,(function(e){return e.openAttendeeTrackingView})),new o.a(i,(function(e){return e.closeAttendeeTrackingView})),new o.a(i,(function(e){return e.openTasksView}))),l=new o.a(i,(function(e){return e.openCalendarView})),f=new o.a(i,(function(e){return e.openConflictsView})),b=new o.a(i,(function(e){return e.closeConflictsView})),v=new o.a(i,(function(e){return e.openEventQuickComposeView}))},2615:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("saveReadingPanePositionOption")},2670:function(e,t,n){"use strict";var r=n(3),o=Object(r.actionCreator)("ADD_CHAT_TAB",(function(e){return{chatConversationId:e}}));t.a=o},2744:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return s}));var r=n(74),o=n(2112);n.d(t,"c",(function(){return o.a}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(6),n.e(15),n.e(17),n.e(100),n.e(117),n.e(149),n.e(202),n.e(300)]).then(n.bind(null,4168))})),a=Object(r.d)(i,(function(e){return e.ActivityFeed})),c=new r.a(i,(function(e){return e.initializeActivityFeed})),u=Object(r.d)(i,(function(e){return e.ActivityFeedTitle})),s=new r.a(i,(function(e){return e.postWeveSignal}))},2844:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(77),o=n(1379);function i(){return Object(r.i)("rp-skypeInTabs")&&1==Object(o.b)()}},2872:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var r=n(74),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(7),n.e(10),n.e(18),n.e(701)]).then(n.bind(null,5793))})),i=new r.a(o,(function(e){return e.loadCLPUserLabels})),a=(new r.a(o,(function(e){return e.addAuditActionToViewState})),new r.b(o,(function(e){return e.showJustificationModal}))),c=new r.a(o,(function(e){return e.loadItemCLPInfo})),u=new r.b(o,(function(e){return e.updateItemCLPInfo})),s=new r.b(o,(function(e){return e.logReadCLPLabel})),d=new r.b(o,(function(e){return e.triggerCLPAutoLabeling})),l=(new r.b(o,(function(e){return e.constructCLPAuditAction})),Object(r.d)(o,(function(e){return e.CLPSubjectHeaderLabel}))),f=Object(r.d)(o,(function(e){return e.CLPMandatoryLabelModal}))},2886:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("OnComposeLifecycleEvent",(function(e,t){return{viewState:e,event:t}}));t.a=o},2894:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1297),o=n(3032);function i(e,t){return t?r.a.items.get(e):Object(o.b)(e)}},3070:function(e,t,n){"use strict";var r=n(77),o=n(2028),i=n(318);t.a=function(){var e=o.b.clpLabels;return Object(r.i)("cmp-clp")&&e.length>0&&e.some((function(e){return e.isLabelEnabled}))&&!Object(i.a)()}},3105:function(e,t,n){"use strict";var r=n(74),o=n(3),i=n(2615),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(6),n.e(7),n.e(8),n.e(11),n.e(13),n.e(15),n.e(17),n.e(18),n.e(21),n.e(22),n.e(26),n.e(27),n.e(29),n.e(28),n.e(33),n.e(41),n.e(49),n.e(45),n.e(864)]).then(n.bind(null,16782))})),c=(new r.a(a,(function(e){return e.saveReadingPaneOptionQuick})),n(2604)),u=n(1970),s=n(2220),d=n(2221),l=n(281),f=n(1407),b=Object(l.action)("onPrintRow")((function(){Object(f.c)()&&(Object(d.a)(!0),Object(s.a)(!1))})),v=Object(l.action)("onNewMessage")((function(e){e||(Object(d.a)(!0),Object(s.a)(!Object(f.c)()))})),O=n(3167);n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return O.a}));var p=new r.c((function(){return Promise.all([n.e(47),n.e(55),n.e(643)]).then(n.bind(null,17292))})),j=new r.a(p,(function(e){return e.onReplyOrReplyAllOrForwardMessage})),w=(new r.b(p,(function(e){return e.onSxSPreviewPaneClose})),new r.a(p,(function(e){return e.onReadingPanePositionOptionSaved}))),m=new r.a(p,(function(e){return e.onSelectMessageAd}));function h(){Object(o.orchestrator)(i.a,(function(){w.importAndExecute()}))}Object(r.f)(c.a,p,(function(e){return e.onClientReadingPanePositionChangeOrchestrator})),Object(r.f)(u.a,p,(function(e){return e.closeImmersiveReadingPaneOrchestrator}))},3119:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.createStore)("whatsNewStore",{cards:null,disablePauseInboxTryIt:!1})},3120:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("OPEN_PAUSE_INBOX")},3167:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("exitSearch",(function(e){return{actionSource:e}}))},3279:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_REMINDER_CLICKED",(function(e,t){return{itemId:e,reminderType:t}}))},3419:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_LIKE_NOTIFICATION_CLICKED",(function(e){return{notification:e}}))},3420:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_NEW_MAIL_NOTIFICATION_NAVIGATED",(function(e){return{notification:e}}))},3421:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Read="Read",e.Unread="Unread"}(r||(r={}))},3574:function(e,t,n){"use strict";var r=n(74),o=n(2844),i=n(77),a=function(){return!Object(i.i)("fwk-partner-code-off")&&!Object(i.i)("fwk-skypeSuite")&&Object(i.i)("fwk-skypeConsumer")},c=n(2670),u=n(2406);n.d(t,"a",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"h",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"g",(function(){return O})),n.d(t,"f",(function(){return p})),n.d(t,"c",(function(){return o.a})),n.d(t,"j",(function(){return a})),n.d(t,"b",(function(){return c.a})),n.d(t,"k",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(0),n.e(3),n.e(743)]).then(n.bind(null,17209))})),d=Object(r.d)(s,(function(e){return e.SkypeGlimpse})),l=new r.a(s,(function(e){return e.updateIsGlimpseOpen})),f=new r.b(s,(function(e){return e.shouldShowUnreadConversationCount})),b=new r.a(s,(function(e){return e.beginSkypeInitialization})),v=new r.a(s,(function(e){return e.createOnSwcReadyEvent})),O=new r.a(s,(function(e){return e.onNotificationReceived})),p=new r.a(s,(function(e){return e.onHideNotificationReceived}))},3575:function(e,t,n){"use strict";var r=n(74),o=n(3119),i=n(3421);function a(){var e=Object(o.a)();return e.cards?Object.keys(e.cards).filter((function(t){return e.cards[t].status===i.a.Unread})).length:0}var c=n(3120);n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(0),n.e(21),n.e(27),n.e(28),n.e(45),n.e(792)]).then(n.bind(null,17140))})),s=Object(r.d)(u,(function(e){return e.WhatsNewFluentPane})),d=new r.a(u,(function(e){return e.initializeWhatsNewIfNecessary})),l=new r.a(u,(function(e){return e.openPremiumDashboard}))},3589:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=[];function o(e){r.push(e)}function i(e){return r.reduce((function(t,n){return t||n(e)}),!1)}},3590:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=[];function o(e){r.push(e)}function i(e){return r.reduce((function(t,n){return t||n(e)}),!1)}},3757:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r=n(74),o=n(3589);n.d(t,"g",(function(){return o.a}));var i=n(3590);n.d(t,"f",(function(){return i.a}));var a=n(3419);n.d(t,"c",(function(){return a.a}));var c=n(3420);n.d(t,"d",(function(){return c.a}));var u=n(3279);n.d(t,"e",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(6),n.e(24),n.e(27),n.e(31),n.e(43),n.e(89),n.e(170),n.e(204),n.e(609)]).then(n.bind(null,7600))})),d=Object(r.d)(s,(function(e){return e.NotificationPane})),l=new r.b(s,(function(e){return e.onDismissAutomaticReplyNotification}))},4287:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(74),o=new r.c((function(){return Promise.all([n.e(137),n.e(276),n.e(793)]).then(n.bind(null,6941))})),i=new r.a(o,(function(e){return e.loadWorkloadScenarioSettings}))},429:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},4416:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1297);function o(e){var t=r.a.conversations.get(e);return null==t?void 0:t.canLoadMore}},4427:function(e){e.exports=JSON.parse('{"e":"Axa","a":"Bxa","n":"Dxa","p":"Exa","u":"Gxa","q":"Hxa","m":"Ixa","j":"Jxa","s":"Kxa","r":"Lxa","h":"Mxa","o":"Nxa","k":"Oxa","t":"Pxa","i":"Qxa","g":"Rxa","l":"Sxa","f":"Txa","d":"Uxa","b":"Vxa","c":"Wxa"}')},468:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(429),o=n(3),i=n(544),a=n(4),c={state:r.a.NotStarted,isPopoutV2:Object(a.a)(i.a)==i.b},u=Object(o.createStore)("popoutChild",c);u()},476:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c}));var r,o=2,i=[window.location.origin];function a(e,t,n){var r={version:o,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function c(e){if(i.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&o==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow",e[e.DeeplinkReady=4]="DeeplinkReady"}(r||(r={}))},4774:function(e,t,n){"use strict";var r=n(2770),o=n(72);t.a=Object(o.d)("expandCollapsedItemsRollUp",r.a.RPCountExpCollItemsRollUp)((function(e,t){void 0===t&&(t=!1),e.conversationNodeIdsInCollapsedItemsRollUp=[]}))},5625:function(e,t,n){"use strict";var r=n(4774),o=n(2770),i=n(1481),a=n(3049),c=n(266),u=n(72),s=n(1894),d=n(1297),l=n(3456),f=n(281);t.a=Object(u.d)("loadMore",o.a.RPCountLoadMore)(Object(f.select)({conversations:function(){return d.a.conversations},conversationReadingPaneViewState:function(e){return Object(i.a)(e.Id)}})((function(e,t){if(e&&t.conversations.has(e.Id)){var n=t.conversations.get(e.Id);n.isLoadMoreInProgress=!0,n.maxItemsToReturn=n.maxItemsToReturn+s.a,n.syncState="";var o=Object(c.s)();return o&&o.addCustomData([(i=n.maxItemsToReturn,u=Math.ceil((i-20)/10),Object(l.a)(u))]),Object(a.b)(t.conversationReadingPaneViewState)&&Object(r.a)(t.conversationReadingPaneViewState,!0),s.d.importAndExecute(e,"LoadMore")}var i,u;return Promise.resolve()})))},5654:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1505),o=n(1290),i=n(1828),a=n(1455);function c(e){var t=Object(i.a)(),n=Object(o.E)([e],t)[0];t.rowKeys.includes(n)&&Object(r.q)(t,n,!0,a.a.RouteHandler)}},5655:function(e,t,n){"use strict";var r=n(20),o=n(3),i={usageSuggestions:new r.ObservableMap},a=Object(o.createStore)("personalization",i)();t.a=a},5852:function(e,t,n){"use strict";var r=n(74),o=n(5655);function i(e){var t;return null===(t=o.a.usageSuggestions)||void 0===t?void 0:t.get(e)}n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return i}));var a=new r.c((function(){return n.e(874).then(n.bind(null,17268))})),c=new r.a(a,(function(e){return e.initializePersonalizationSuggestions})),u=(new r.a(a,(function(e){return e.postPersonalizationSuggestionFeedback})),new r.a(a,(function(e){return e.postPersonalizationUsageSignals})))},630:function(e,t,n){"use strict";var r=n(74),o=n(769),i=n(634),a=n(47),c=n(1),u=n(633),s=n(468),d=n(77),l=n(429),f=n(943),b=n(948),v=Object(a.a)((function(e){c.useEffect((function(){Object(d.i)("rp-popoutsDebug")||O()}),[]);return c.createElement("div",{className:b.view},Object(s.a)().state==l.a.Loading?c.createElement("span",null,c.createElement(f.a,null),e.loadingString):c.createElement("button",{onClick:O},"Get Data"))}));function O(){Object(u.a)()}function p(e,t,n,r){var o="";if(r)o="readimid/",o+=encodeURIComponent(btoa(r));else{if(o=n?"readconv/":"read/",e&&"GroupMailbox"==e.type){o+="group/";var i=e.mailboxSmtpAddress.split("@");o+=i[1]+"/"+i[0]+"/"}o+=encodeURIComponent(n||t)}return o}var j=n(627);function w(e){var t=e&&e!==window;return Object(j.v)()||t}n.d(t,"h",(function(){return h})),n.d(t,"c",(function(){return o.a})),n.d(t,"i",(function(){return i.a})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return l.a})),n.d(t,"f",(function(){return s.a})),n.d(t,"d",(function(){return u.b})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return w}));var m=new r.c((function(){return n.e(884).then(n.bind(null,17235))})),h=new r.b(m,(function(e){return e.bootPopout}))},633:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r,o=n(0),i=n(634),a=n(476),c=n(429),u=n(468),s=!1;function d(){Object(i.a)(c.a.Loading),r?r():s=!0}function l(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return s?[3,2]:[4,new Promise((function(e){r=function(){e()}}))];case 1:t.sent(),t.label=2;case 2:return[2,Object(u.a)().isPopoutV2?new Promise((function(t,n){var r=function(n){var o=Object(a.b)(n);if(o&&o.type==a.a.SetData){window.removeEventListener("message",r);var i=void 0;try{i=e?e(o.serializedData):JSON.parse(o.serializedData)}catch(e){}t(i)}};window.addEventListener("message",r);try{var o=window.opener;Object(a.c)(o,a.a.PopoutReady,null)}catch(e){t(null)}})):Promise.resolve(null)]}}))}))}},634:function(e,t,n){"use strict";var r=n(468),o=n(3),i=n(429),a=n(476);t.a=Object(o.mutatorAction)("setPopoutChildState",(function(e){var t=Object(r.a)();t.state=e,e==i.a.Ready&&t.isPopoutV2&&window.opener&&Object(a.c)(window.opener,a.a.DeeplinkReady,null)}))},6521:function(e,t,n){"use strict";var r=n(0),o=n(4190),i=n(3571),a=n(4307),c=n(1502),u=n(1504),s=n(2086),d=n(1445),l=n(281),f=n(1290);t.a=Object(l.select)({composeViewState:function(){return u.a.viewStates.get(u.a.primaryComposeId)},conversationItems:function(){return f.X.conversationItems}})(Object(l.action)("reloadReadingPane")((function(e){var t,n,u=Object(f.G)(),l=u?Object(r.__spread)(u.selectedRowKeys.keys()):[];if(1==l.length){var b=f.b.getRowIdToShowInReadingPane(l[0],u),v=Object(s.a)(l,u)[0],O=u.tableQuery.listViewType;if(1===O||Object(d.a)())(null===(t=e.composeViewState)||void 0===t?void 0:t.isInlineCompose)?c.r.importAndExecute(e.composeViewState).then((function(){Object(i.a)(b,v,a.a)})):Object(i.a)(b,v,a.a);else if(0===O){var p=e.conversationItems.get(b.Id);(null===(n=e.composeViewState)||void 0===n?void 0:n.isInlineCompose)?c.r.importAndExecute(e.composeViewState).then((function(){Object(o.b)(b,v,p.subject)})):Object(o.b)(b,v,p.subject)}}})))},6547:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("ON_CONVERSATION_OPTION_SAVED");t.a=o},7271:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",(function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}}))},7289:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),o=n(4427),i=n(11),a=Object(r.action)("ADD_FIRST_EVENT",(function(){return{taskNewEventTitle:Object(i.b)(o.l)}}))},7304:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{selectionDirection:e,tableView:t,mailListItemSelectionSource:n,shouldSelect:r}}))},7305:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_KEYBOARD_TOGGLE_SELECT",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}}))},7306:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n,mailListItemSelectionSource:r}}))},769:function(e,t,n){"use strict";var r=n(0),o=n(55),i=600,a=800,c=8,u=25,s={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},d=-1;function l(e,t,n){try{t=function(e){var t=u*(1+(d=(d+1)%c)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),i),width:Math.max(8*Math.pow(window.innerWidth,2/3),a)};return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s),n),e)}(t);var l=(n||window).open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map((function(t){return t+"="+("boolean"==typeof(n=e[t])?n?"1":"0":n?String(n):void 0);var n})).join(",")}(t));return(Object(o.e)()||Object(o.f)())&&l.moveTo(t.left,t.top),l}catch(e){return null}}var f=n(767);var b=n(2),v=n(627),O=n(544),p="version";var j=n(72),w=n(630),m=n(266);t.a=Object(j.d)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,o,i){return[(t||"").split("/")[0],i]}})((function(e,t,n,r,o,i,a){var c=function(e){var t=null,n=void 0,r=null,o=null;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,Object(f.b)().isAvailable&&(t=e.projectionTabId||null),r=e.projectionTargetWindow,o=e.projectionParentWindow)),{deeplinkCallback:void 0===n?function(){return Promise.resolve(null)}:"function"==typeof n?n:function(){return Promise.resolve(n)},projectionTabId:t,projectionTargetWindow:r,projectionParentWindow:o}}(n),u=c.deeplinkCallback,s=c.projectionTabId,d=c.projectionTargetWindow,j=c.projectionParentWindow,h=new m.b(s?"PopoutProjectionPerf":"PopoutDeeplinkPerf"),I=s?"about:blank":function(e,t,n,r){var o;void 0===r&&(r={});var i=((o={})[p]=Object(b.p)(),o[O.a]=O.b,o);return Object.keys(r).map((function(e){i[e]=r[e]})),Object(v.p)(e,t,n,i)}(e,t,o,a),g=d||l(I,r,j);g&&w.h.import().then((function(t){return t(e,g,s,u,h)}))}))},8427:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_ITEM_PART_SELECTED",(function(e,t){return{conversationNodeId:e,conversationId:t}}))},8480:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("CONFIRM_TIMEZONE")},8481:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),o=n(4427),i=n(11),a=n(30),c=Object(r.action)("SEND_AN_EMAIL",(function(){return{taskSendEmailSubject:Object(i.c)(Object(i.b)(o.s),Object(a.a)().SessionSettings.UserEmailAddress),taskSendEmailBody:Object(i.c)(Object(i.b)(o.r),Object(a.a)().SessionSettings.UserEmailAddress)}}))},8482:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("ADD_STORAGE_ACCOUNT")},8483:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("SETUP_SIGNATURE")},8484:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("SHOW_PERSONALIZATION_MODAL")},8487:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("COMPLETE_SEND_AN_EMAIL")},8488:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("COMPLETE_PERSONALIZATION")},8525:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5498),o=n(5654);function i(e,t){Object(r.a)(e),Object(o.a)(t)}},8535:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(74),o=new r.c((function(){return Promise.all([n.e(0),n.e(223),n.e(450)]).then(n.bind(null,11041))})),i=new r.a(o,(function(e){return e.subscribeToBulkActionNotification})),a=new r.a(o,(function(e){return e.findBulkActionItemAction}))},948:function(e,t,n){var r=n(949),o=n(130);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},949:function(e,t,n){(t=e.exports=n(129)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}},9691:function(e,t,n){"use strict";var r=n(0),o=n(1894),i=n(1305),a=n(290);function c(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:c=null===(t=i.u.conversations)||void 0===t?void 0:t.get(e),r.label=1;case 1:return!c||null!=c&&c.canLoadMoreForRelationMap?(c&&(c.isLoadMoreInProgress=!0,c.maxItemsToReturn=c.maxItemsToReturn+o.a,c.syncState=""),[4,o.d.importAndExecute({Id:e,mailboxInfo:Object(a.d)()},"CreateConversationRelationMap")]):[3,3];case 2:return r.sent(),c||(c=null===(n=i.u.conversations)||void 0===n?void 0:n.get(e))?[3,1]:[3,3];case 3:return[2]}}))}))}function u(e){var t,n,o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,u,s,d,l,b,v,O;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return[4,c(e)];case 1:if(p.sent(),!(a=null===(t=i.u.conversations)||void 0===t?void 0:t.get(e)))return[2,null];if(u=null==a?void 0:a.conversationNodeIds,s=null==u?void 0:u.length,!u||!s||0==s)return[2,null];for(d=Object(r.__spread)(u),"ChronologicalNewestOnBottom"===a.conversationSortOrder||d.reverse(),l=i.u.conversationNodes.get(d[0]),b=new Map,l&&(null===(n=null==l?void 0:l.itemIds)||void 0===n?void 0:n[0])&&b.set(null===(o=l.itemIds)||void 0===o?void 0:o[0],{internetMessageId:l.internetMessageId,childrenItemIds:[]}),v=1;v<s;)O=i.u.conversationNodes.get(d[v]),f(b,O),v+=1;return[2,b]}}))}))}function s(e){var t,n=null===(t=i.u.conversations)||void 0===t?void 0:t.get(e);if(!n)return!1;var r=n.conversationNodeIds,o=null==r?void 0:r.length;return!(!r||!o||0==o)}function d(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,u(e)];case 1:return o=r.sent(),a=null===(n=i.u.conversations)||void 0===n?void 0:n.get(e),o?(c=[],null==o||o.forEach((function(e,n){var r;if(0===e.childrenItemIds.length)for(var i=n,a=e;i;){if(t.includes(i)&&a&&(null===(r=null==a?void 0:a.childrenItemIds)||void 0===r?void 0:r.length)<2){c.push(i);break}var u=null==a?void 0:a.parentItemId;u?(a=null==o?void 0:o.get(u),i=u):i=null}})),[2,"ChronologicalNewestOnBottom"===(null==a?void 0:a.conversationSortOrder)?c:c.reverse()]):[2,[]]}}))}))}function l(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,u(e)];case 1:if(n=r.sent(),o=[t],n)for(i=t;i;)o.push(i),a=n.get(i),i=null==a?void 0:a.parentItemId;return[2,o]}}))}))}function f(e,t){var n,o,i;if(t){var a=null===(i=t.itemIds)||void 0===i?void 0:i[0];if(a){var c;try{for(var u=Object(r.__values)(e),s=u.next();!s.done;s=u.next()){var d=Object(r.__read)(s.value,2),l=d[0],f=d[1];if(f.internetMessageId===t.parentInternetMessageId){f.childrenItemIds.push(a),c=l;break}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}e.set(a,{internetMessageId:t.internetMessageId,parentItemId:c,childrenItemIds:[]})}}}n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l}))}}]);
//# sourceMappingURL=owa.MailBoot~MailFunctionalBoot.js.map
self.scriptsLoaded['owa.MailBoot~MailFunctionalBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();