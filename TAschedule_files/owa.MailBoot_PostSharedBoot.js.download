self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~PostSharedBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[698],{186:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(24);function a(){var e=Object(r.a)(),t=e.origin;return t||(t=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")),t}},2348:function(e,t,n){"use strict";var r=n(74),a=n(0),o=n(3),c=function(e,t,n){var r=null;return{init:function(c){var i;return null!==r?c:(r=Object(o.createStore)(e,t),n(r()),Object(a.__assign)(Object(a.__assign)({},c),((i={})[e]=r,i)))},getIfInitialized:function(){return r?r():null}}};n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return c}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(8),n.e(11),n.e(14),n.e(18),n.e(37),n.e(51),n.e(53),n.e(54),n.e(108),n.e(127),n.e(540)]).then(n.bind(null,17200))})),s=Object(r.d)(i,(function(e){return e.DiagnosticsPanel})),u=new r.a(i,(function(e){return e.registerDiagnostics})),l=(new r.b(i,(function(e){return e.setSelectedPivot})),new r.b(i,(function(e){return e.getDiagnosticsLogState}))),d=new r.b(i,(function(e){return e.initializeDefaultDiagnostics})),f=Object(r.d)(i,(function(e){return e.DiagnosticsHost})),h=(Object(r.d)(i,(function(e){return e.DiagnosticsInspector})),Object(r.d)(i,(function(e){return e.TwoColumnInspector})))},432:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(73);function a(e){return Object(r.a)(e,[r.c])}},447:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();n.d(t,"a",(function(){return r}))},5385:function(e,t,n){"use strict";n.r(t);var r=n(77),a=n(0),o=n(2);function c(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:e=Object(o.z)()+"scripts/ThirdPartyNotices.txt",r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch(e,{credentials:"same-origin"})];case 2:return[4,r.sent().text()];case 3:return t=r.sent(),n=document.createComment("\nTHIRD-PARTY SOFTWARE NOTICES\nThis file is based on or incorporates material from the projects listed below (Third Party Code). The original copyright notice and the license under which Microsoft received such Third Party Code, are set forth below. Such licenses and notices are provided for informational purposes only. Microsoft licenses the Third Party Code to you under the licensing terms for the Microsoft product. Microsoft reserves all other rights not expressly granted under this agreement, whether by implication, estoppel or otherwise.\n\nYou may find a copy of the Corresponding Source code, if and as required under the Third Party Code License, either bundled with the Microsoft product or at http://3rdpartysource.microsoft.com. If not bundled with the product, you may also obtain a copy of the source code for a period of one year after our last shipment of this product.\n\n=============\n\n"+t),document.head.appendChild(n),[3,5];case 4:return r.sent(),[3,5];case 5:return[2]}}))}))}var i=n(74),s=new i.c((function(){return n.e(539).then(n.bind(null,17473))})),u=new i.a(s,(function(e){return e.setupDevTools})),l=n(315),d=n(4),f=n(627),h=["bO","bR","sessionId","anonRetry"];var b=n(2348),p=n(2595),v=n(266),O=n(447);var g=n(111),m=n(7919),j={concurrency:3,delay:1,pulse:1},C="ttiConcurrency",w="ttiDelay",k="ttiPulse",y="ttiMonkey",T=45e3,E=6e4,S=-1,R=null,I=null,M=null,N=0,P=!1,U=S,_=S;function D(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,o,c,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:t=0,a.label=1;case 1:return t<e.length?(n=e[t],o="function"==typeof n?n:n.task,c="function"==typeof n||!("condition"in n)||n.condition,i="function"!=typeof n&&n.idle,c?Object(r.i)("fwk-tti-governor")?[3,2]:(o(),[3,4]):[3,4]):[3,5];case 2:return N++,[4,x(i)];case 3:a.sent().add(o),a.label=4;case 4:return++t,[3,1];case 5:return[2]}}))}))}function W(){P=!0,Object(r.i)("fwk-tti-governor-monkey")&&(_=V(y,Math.floor(Math.random()*N)))}function x(e){return e?(I||(I=A(Promise.race([m.a.importAndExecute(),Object(g.a)(T)]))),I):(R||(R=A()),R)}function A(e){var t=function(){M||(M={concurrency:V(C,j.concurrency),pulse:V(k,j.pulse),delay:V(w,j.delay)});return M}();return(e||Object(g.a)(t.delay)).then((function(){return e=t.concurrency,n=L,r=t.pulse,new O.a(e,n,r);var e,n,r}))}function V(e,t){var n=t;return Object(r.i)("fwk-devTools")&&(n=parseInt(Object(d.a)(e))||t),n}function L(e){return++U==_?setTimeout(e,E):e(),P&&U==N-1&&(Object(v.q)("ttiGovernEnd",Object(a.__assign)(Object(a.__assign)({},M),{monkey:_})),P=!1),Promise.resolve()}function F(e,t){return["branch","ring","version"].some((function(n){return!!Object(d.d)(n,e.location)&&(t.push(n+"="+Object(d.a)(n,e.location)),!0)})),t.join("&")}var H,q=n(56);!function(e){e[e.Normal=0]="Normal",e[e.CacheCorrupt=1]="CacheCorrupt",e[e.TooManyInstallError=2]="TooManyInstallError"}(H||(H={}));var G,z=H;!function(e){e[e.Install=0]="Install",e[e.UnInstall=1]="UnInstall"}(G||(G={}));var B,Y=G;!function(e){e[e.CacheProgress=0]="CacheProgress",e[e.Error=1]="Error"}(B||(B={}));var $,Q=B;!function(e){e[e.Checking=0]="Checking",e[e.Downloading=1]="Downloading",e[e.Progress=2]="Progress",e[e.Error=3]="Error",e[e.Cached=4]="Cached",e[e.NoUpdate=5]="NoUpdate",e[e.Obsolete=6]="Obsolete",e[e.UpdateReady=7]="UpdateReady",e[e.Idle=8]="Idle",e[e.UnCached=9]="UnCached",e[e.CleanupError=10]="CleanupError",e[e.CleanupSuceeded=11]="CleanupSuceeded",e[e.ManifestDate=12]="ManifestDate"}($||($={}));var J,K,X=$,Z=((J={})[X.Error]="ER",J[X.Cached]="C",J[X.NoUpdate]="NU",J[X.Obsolete]="OB",J[X.UpdateReady]="UR",J);!function(e){e[e.CacheInstalled=0]="CacheInstalled",e[e.CacheFailed=1]="CacheFailed",e[e.CacheCleared=2]="CacheCleared"}(K||(K={}));var ee=K,te=n(9);function ne(e,t){return e+"_"+t}var re="SWCacheErrorCount";function ae(e,t,n){var r=ne(t.appName,re);0==n?Object(te.d)(e,r):Object(te.e)(e,r,""+n)}function oe(e,t){var n=parseInt(Object(te.a)(e,ne(t.appName,re)));return isNaN(n)?0:n}var ce="CacheVersion",ie="AttemptedCacheVersion";function se(e,t,n){if(n.cacheMessage&&(n.targetClient==t.appName||"global"==n.targetClient)){var r=n.cacheMessage;q.g.info("[SW Client] Cache Event: "+r.cacheEvent);var a=null;switch(r.cacheEvent){case X.Progress:t.resourcesCached++;break;case X.Error:a=ee.CacheFailed;break;case X.Cached:case X.NoUpdate:case X.UpdateReady:a=ee.CacheInstalled;break;case X.Obsolete:a=ee.CacheCleared;break;case X.CleanupError:t.cacheCleanupStatus=1;break;case X.CleanupSuceeded:t.cacheCleanupStatus=2,t.numberOfCachesCleaned=r.cachesCleaned?r.cachesCleaned.length:0;break;case X.ManifestDate:Object(te.e)(e,"OwaSWManifestDate",r.resource)}var o=r.cacheEvent==X.Obsolete;null!=a&&(function(e,t,n,r){switch(n){case ee.CacheInstalled:Object(te.e)(e,ne(t.appName,ce),r),ae(e,t,0);break;case ee.CacheFailed:Object(te.e)(e,ne(t.appName,ie),r),ae(e,t,oe(e,t)+1);break;case ee.CacheCleared:Object(te.e)(e,ne(t.appName,ce),null),Object(te.e)(e,ne(t.appName,ie),null),ae(e,t,0)}}(e,t,a,o?null:r.cacheVersion),function(e,t){Object(v.q)("SWCache",{ev:Z[t.cacheEvent],cv:t.cacheVersion,e:t.error,r:t.resource,st:t.status,stk:t.stack,rc:e.resourcesCached,ccs:e.cacheCleanupStatus,ncc:e.numberOfCachesCleaned,ch:e.cacheHealth,app:e.appName}),e.resourcesCached=0,e.cacheCleanupStatus=0,e.numberOfCachesCleaned=0}(t,r)),o&&t.cacheHealth>z.Normal&&(t.cacheHealth=z.Normal,pe())}}var ue=n(5),le=n(48),de=n(432),fe=15,he=null,be=null;function pe(){var e=Object(de.a)("/"+Object(le.a)())+"/",t=["manifestVersion=2"];Object(ue.e)()===ue.b.SriEnabled&&t.push("srienabled=true");var n=""+e+he.appName+"cache.manifest?"+F(window,t),a=Y.Install;he.cacheHealth>z.Normal&&(a=Y.UnInstall);var c={source:he.appName,action:a,bootResourcesOnly:!0,language:he.userLanguage,darkMode:void 0!==he.darkMode&&he.darkMode,manifestUrl:n,proxyFetchAlways:Object(r.i)("fwk-sw-proxyFetchAlways"),rootUrl:e,dynamicRequestHeaders:Object(o.G)()?{"x-native-host":"true"}:void 0,dynamicQueryString:ve()};he.serviceWorkerRegistration.active.postMessage(c)}function ve(){if(Object(o.G)()){var e=Object(d.a)("hxVersion");if(e)return"hxVersion="+e}}function Oe(e){if(e.data){var t=e.data;t.messageType==Q.CacheProgress?se(be,he,t):t.messageType==Q.Error&&function(e){null!=e.error&&q.d("[SW Client] ServiceWorker Unhandled Exception",e.error)}(t)}}var ge=n(55),me=n(30),je="activated",Ce=null,we=null,ke=null,ye=null;function Te(e,t,n){we=(ke=e).navigator.serviceWorker,ye=t;var a,o,c,i=Object(f.i)("mail")+"/sw.js",s=[];Object(r.i)("fwk-sw-proxyFetchAlways")&&(a=Object(ge.a)(),o=a.browser,c=a.browserVersion,("Chrome"==o||"Edge Anaheim"==o)&&c&&c.length>0)&&s.push("fa=1"),(Object(r.i)("fwk-sw-v2")||Object(d.d)("swV2"))&&s.push("swVersion=2");var u=F(e,s);return u&&(i+="?"+u),n.addCustomData({url:i}),we.register(i,{scope:"/"}).then((function(){return we.ready.then(Ee)}))}function Ee(e){return q.g.info("[SW Client] ready fired, state: "+e.active.state),(Ce=e).active?Se():new Promise((function(e){we.oncontrollerchange=function(){Se(),e()}}))}function Se(){return Ce.active.state==je?Re():new Promise((function(e){Ce.active.onstatechange=function(){Ce.active.state==je&&(Ce.active.onstatechange=null,Re(),e())}}))}function Re(){var e,t,n=Object(me.a)();return e={serviceWorkerContainer:we,serviceWorkerRegistration:Ce,appName:ye,userLanguage:n.SessionSettings.UserLanguage,darkMode:n.UserOptions.IsDarkModeTheme},t=ke,he||((he=e).serviceWorkerContainer.onmessage=Oe,oe(window,he)>fe&&(he.cacheHealth=z.TooManyInstallError)),be=t,pe(),Promise.resolve()}function Ie(e,t){var n;return Object(a.__awaiter)(this,void 0,void 0,(function(){var o,c,i,s,u;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:if(o=new v.b("RegisterServiceWorker"),!(c=null===(n=e.navigator)||void 0===n?void 0:n.serviceWorker))return[3,7];if(i=function(){var e,t=Object(ge.a)().browser;Object(r.i)("fwk-prefetch-code-off")?e="Error_PrefetchDisabled":"Chrome"==t||"Edge Anaheim"==t?Object(r.i)("fwk-prefetch-code-off-chromium")&&!Object(ge.o)([77])&&(e="Error_ChromeMinVersion"):"Edge"==t?Object(ge.o)([17,17134])||(e="EdgeMinVersion"):"Safari"==t?Object(ge.o)([11,1])||(e="SafariMinVersion"):"Firefox"!=t&&(e="UnsupportedBrowser:"+t);return e}())return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Te(e,t,o)];case 2:return a.sent(),[3,4];case 3:return u=a.sent(),s=u,[3,4];case 4:return[3,6];case 5:c.getRegistrations&&c.getRegistrations().then((function(e){for(var t=0;t<e.length;++t)e[t].unregister()})),a.label=6;case 6:return[3,8];case 7:i="SWNotAvailable",a.label=8;case 8:return o.addCustomData([i||"success"]),s?o.endWithError("ClientError",s):i?o.endWithError("ServerError"):o.end(),[2]}}))}))}function Me(e,t,n){D({condition:!!((null===window||void 0===window?void 0:window.location)&&window.history),task:function(){return function(e,t){for(var n=Object(d.b)(e),r=!1,a=0;a<h.length;a++){var o=h[a];n[o]&&(delete n[o],r=!0)}if(r){var c=Object(l.stringify)(n);c&&(c="?"+c);var i=""+Object(f.l)()+e.pathname+c+e.hash;t.replaceState(null,null,i)}}(window.location,window.history)}},p.a,(function(){return v.k.importAndExecute(e)}),{condition:Object(r.i)("fwk-devTools"),task:function(){u.importAndExecute(),b.g.import().then((function(e){e()}))}},{task:function(){return Ie(window,t)},idle:!0,condition:t&&(!n||Object(r.i)(n))},{idle:!0,task:c})}n.d(t,"setupSharedPostBoot",(function(){return Me})),n.d(t,"govern",(function(){return D})),n.d(t,"enableGovernReport",(function(){return W}))},627:function(e,t,n){"use strict";var r=n(432),a=n(27),o=n(73);function c(e){return Object(o.a)(e,[o.b])}var i=n(19),s=n(48);function u(e){return Object(i.b)(Object(i.c)(Object(i.a)(Object(s.a)()||"",e)))}var l,d,f,h=n(757),b=n(752),p=n(132);function v(){return l||(l=Object(a.a)("/calendar")+"/"),l}function O(){return d||(d=Object(a.a)("/mail")+"/"),d}function g(){return f||(f=Object(a.a)("/files")+"/"),f}var m,j,C,w=n(758);function k(e){return m&&j===e||(j=e,m=e?Object(a.a)("/people/group/owner")+"/":Object(a.a)("/people/group/member")+"/"),m}function y(){return C||(C=Object(a.a)("/people/group/deleted")+"/"),C}function T(e){return window.location.origin+v()+"showPeek/item/"+encodeURIComponent(e)}var E=n(311),S=n(765),R=n(4),I=n(632),M=Object(S.a)().split("/").slice(1).join("/")+"deeplink/";function N(e,t,n,r){n&&((r=r||{}).minus="");var a="";if(r){var o=Object(R.b)();Object(I.a)(o),Object.keys(r).filter((function(e){return e})).forEach((function(e){return o[e]=r[e]})),a="?"+Object(R.h)(o)}var c={pathname:"/"+e+"/"+M+t,search:a};return E.format(c)}var P,U,_=n(156),D=n(30),W="https://to-do.microsoft.com";function x(e){var t,n,r=Object(D.a)(),a=r.UserOptions,o=null===(t=r.SessionSettings)||void 0===t?void 0:t.UserPrincipalName,c=W,i={};return(null===(n=null==a?void 0:a.ReactOptinSettings)||void 0===n?void 0:n.TasksRedirectUrl)&&(c=a.ReactOptinSettings.TasksRedirectUrl,o&&(i.auth_upn=o)),e&&(i.utm_source=e),Object.keys(i).length>0?Object(p.a)(c,i):c}function A(){return P||(P=Object(a.a)("/spaces")+"/"),P}function V(){return U||(U=Object(a.a)("/eventify")+"/"),U}var L=n(186);n.d(t,"i",(function(){return r.a})),n.d(t,"s",(function(){return a.a})),n.d(t,"e",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"r",(function(){return h.a})),n.d(t,"w",(function(){return i.a})),n.d(t,"a",(function(){return i.b})),n.d(t,"n",(function(){return b.a})),n.d(t,"u",(function(){return p.a})),n.d(t,"c",(function(){return v})),n.d(t,"j",(function(){return O})),n.d(t,"f",(function(){return g})),n.d(t,"o",(function(){return w.a})),n.d(t,"h",(function(){return k})),n.d(t,"g",(function(){return y})),n.d(t,"b",(function(){return T})),n.d(t,"p",(function(){return N})),n.d(t,"v",(function(){return _.a})),n.d(t,"t",(function(){return x})),n.d(t,"m",(function(){return A})),n.d(t,"d",(function(){return V})),n.d(t,"l",(function(){return L.a})),n.d(t,"q",(function(){return s.a}))},632:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=["hostApp","isanonymous","cspoff","frameName","opxInstanceId"];function a(e){e&&Object.keys(e).forEach((function(t){r.includes(t)&&delete e[t]}))}},752:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(24),a=n(27),o=n(186);function c(e){var t=Object(r.a)(),n=Object(o.a)()+Object(a.a)("/owa")+"/",c=t.search&&t.search.length>0;n+=c?t.search:"?";for(var i=Object.keys(e),s=c,u=0;u<i.length;u++)s?n+="&":s=!0,n+=i[u]+"="+e[i[u]];return n}},757:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),a=n(632);function o(){var e=Object(r.b)();Object(a.a)(e);var t=Object(r.h)(e);return t.length>0?"?"+t:""}},758:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,a=n(27);function o(){return r||(r=Object(a.a)("/people")+"/"),r}},7919:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(74),a=new r.c((function(){return n.e(943).then(n.bind(null,10384))})),o=new r.a(a,(function(e){return e.tti}))}}]);
//# sourceMappingURL=owa.MailBoot~PostSharedBoot.js.map
self.scriptsLoaded['owa.MailBoot~PostSharedBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~PostSharedBoot.js'] = (new Date()).getTime();