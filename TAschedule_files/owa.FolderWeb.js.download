self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FolderWeb.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[417,419],{10479:function(e,r,n){"use strict";n.r(r),n.d(r,"foldersWeb",(function(){return a}));var t=n(0),o=n(2344),i=n(1308),d=n(1406),u=n(6763),a=function(e,r,n,a){return Object(t.__awaiter)(void 0,void 0,void 0,(function(){var e,a,l,s,c,f;return Object(t.__generator)(this,(function(t){switch(t.label){case 0:return e=[],(null===(c=r.options)||void 0===c?void 0:c.additionalProperties)?(e=r.options.additionalProperties.map((function(e){return Object(i.a)({FieldURI:e})}))).push(Object(i.a)({FieldURI:"ParentFolderId"})):a="Folder",[4,Object(u.a)(e,r.ids,a,null===(f=r.options)||void 0===f?void 0:f.mailboxInfo,n.requestOptions)];case 1:return l=t.sent(),[4,Object(d.a)(l)];case 2:if(t.sent(),s=[],l.forEach((function(e){var n;null===(n=e.Folders)||void 0===n||n.forEach((function(e){var n=Object(o.c)(e,r.options.mailboxInfo);n&&s.push(n)}))})),0===s.length)throw new Error("foldersWeb: failed to get folders");return[2,s]}}))}))}},1306:function(e,r,n){"use strict";n.d(r,"f",(function(){return t})),n.d(r,"d",(function(){return o})),n.d(r,"j",(function(){return i})),n.d(r,"a",(function(){return d})),n.d(r,"g",(function(){return u})),n.d(r,"b",(function(){return a})),n.d(r,"h",(function(){return l})),n.d(r,"l",(function(){return s})),n.d(r,"k",(function(){return c})),n.d(r,"i",(function(){return f})),n.d(r,"c",(function(){return v})),n.d(r,"e",(function(){return p}));var t=["journal","outbox","syncissues"],o="archivemsgfolderroot",i="msgfolderroot",d="archivedeleteditems",u="deleteditems",a="archiverecoverableitemsdeletions",l="recoverableitemsdeletions",s="msgfolderroot",c="sharedFolderTree",f="primaryFolderTree",v="archiveFolderTree",p="favorites"},1308:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"PropertyUri:#Exchange"},e)}},1406:function(e,r,n){"use strict";n.d(r,"a",(function(){return d}));var t=n(0),o=n(1414),i=n(1415);function d(e){var r,n;if(!e)return Promise.reject(Object(o.a)("500","Server returned a null response!",null));var d=Array.isArray(e)?e:[e];try{for(var u=Object(t.__values)(d),a=u.next();!a.done;a=u.next()){var l=a.value;if(l&&!Object(i.a)(l))return Promise.reject(Object(o.a)(l.ResponseCode,l.StackTrace,l.MessageText))}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}return Promise.resolve()}},1414:function(e,r,n){"use strict";function t(e,r,n){var t="ResponseCode="+e;r&&(t+=", Stacktrace="+r);var o=new Error(t);return o.responseCode=e,o.fetchErrorType="ServerFailure",n&&(o.diagnosticInfo="MessageText= "+n),o}n.d(r,"a",(function(){return t}))},1415:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t="Success";function o(e){return e&&e.ResponseClass==t}},16826:function(e,r,n){"use strict";n.r(r),n.d(r,"folderWeb",(function(){return i}));var t=n(0),o=n(10479),i=function(e,r,n,i){return Object(t.__awaiter)(void 0,void 0,void 0,(function(){var d;return Object(t.__generator)(this,(function(t){switch(t.label){case 0:return d={ids:[r.id],options:r.options},[4,Object(o.foldersWeb)(e,d,n,i)];case 1:return[2,t.sent()[0]]}}))}))}},2344:function(e,r,n){"use strict";var t=function(e,r){var n,t;if(e.ExtendedProperty)for(var o=0;o<e.ExtendedProperty.length;o++){var i=e.ExtendedProperty[o];if((null===(n=null==i?void 0:i.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===r||(null===(t=null==i?void 0:i.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===r)return i.Value}},o=function(e){var r=t(e,"SourceWellKnownFolderType");return r&&parseInt(r,10)||-1},i=function(e){return t(e,"0x7018")||null},d=function(e){return"false"!==t(e,"0x10f4")},u=n(1306),a=n(56);function l(e,r,n,t,o,i,a){var l,c=e.RootFolder;if(!c||!c.Folders||!c.ParentFolder)throw new Error("folderHierarchyWeb: failed to get folders");var f=[];null==c||c.Folders.forEach((function(e){if(e&&function(e,r,n){if(t=null==e?void 0:e.__type,"Folder:#Exchange"!=t)return!1;var t;if((null==e?void 0:e.DistinguishedFolderId)&&u.f.indexOf(e.DistinguishedFolderId)>=0)return!1;if(d(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!r;if("notes"===e.DistinguishedFolderId)return!!n;return!0}(e,t,o)){var n=s(e,r);if(n&&(f.push(n),null==a?void 0:a[n.FolderId.Id])){var i=a[n.FolderId.Id];n.ReplicaList=i,n.mailboxInfo.auxiliaryMailboxGuid=i[0]}}}));var v=function(e,r){return"SharedMailbox"===r?void 0:e}((null===(l=null==c?void 0:c.ParentFolder)||void 0===l?void 0:l.DistinguishedFolderId)||"none",r.type);c.ParentFolder.DistinguishedFolderId=v;var p=s(c.ParentFolder,r);return i&&function(e,r,n){if(e){var t={},o={},i=[];t[e.FolderId.Id]=e,i.push(e.FolderId.Id),r.forEach((function(e){e&&(t[e.FolderId.Id]=e,i.push(e.FolderId.Id))})),i.forEach((function(e){var r,n=t[e],i=null===(r=n.ParentFolderId)||void 0===r?void 0:r.Id;n.DistinguishedFolderId&&(o[n.DistinguishedFolderId]=e);var d=i&&t[i];d&&d.childFolderIds.push(e)}));var d=[];n.forEach((function(e){var r=o[e];r&&d.push(r)}));for(var u=e.childFolderIds||[],a=0;a<u.length;a++){var l=u[a]||null;l&&-1==d.indexOf(l)&&d.push(l)}e.childFolderIds=d}}(p,f,n),{__typename:"FolderHierarchyResult",Folders:f,RootFolder:p,IndexedPagingOffset:c.IndexedPagingOffset,TotalItemsInView:c.TotalItemsInView,IncludesLastItemInRange:c.IncludesLastItemInRange}}function s(e,r){var n=e,t=n.FolderId,d=n.ParentFolderId,u=n.DisplayName,l=n.ArchiveTag,s=n.PolicyTag,p=n.ChildFolderCount,I=n.UnreadCount,h=n.TotalCount,F=n.FolderClass,g=n.DistinguishedFolderId;if(!t||!d)return a.g.warn("mapOWSFolderToGql: ignoring folder with missing folderId or missing parentFolderId"),null;var b=p||0,y=f(t);return{id:y.Id,__typename:"MailFolder",type:n.__type,FolderId:y,ParentFolderId:f(d),DisplayName:u||"",DistinguishedFolderId:g||null,FolderClass:F||"IPF.Note",UnreadCount:I||0,TotalCount:h||0,ArchiveTag:l?v(l):null,PolicyTag:s?v(s):null,hasChildren:b>0,remoteFolderDisplayName:i(n),sourceWellKnownFolderType:o(n),ReplicaList:n.ReplicaList,PermissionSet:n.PermissionSet,size:c(n),childFolderIds:[],treeType:null,pausedTotalCount:null,principalSMTPAddress:null,mailboxInfo:{type:r.type,userIdentity:r.userIdentity,mailboxSmtpAddress:r.mailboxSmtpAddress,auxiliaryMailboxGuid:r.auxiliaryMailboxGuid}}}function c(e){var r,n;return null===(n=null===(r=e.ExtendedProperty)||void 0===r?void 0:r[0])||void 0===n?void 0:n.Value}function f(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function v(e){return{__typename:"RetentionTagType",IsExplicit:e.IsExplicit,Value:e.Value}}n.d(r,"a",(function(){return o})),n.d(r,"b",(function(){return l})),n.d(r,"c",(function(){return s}))},2499:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"FolderResponseShape:#Exchange"},e)}},2619:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"GetFolderRequest:#Exchange"},e)}},2662:function(e,r,n){"use strict";var t=n(29),o=n(0);function i(e,r){var n;return void 0===e||e.__type||(n=e,e=Object(o.__assign)({__type:"GetFolderJsonRequest:#Exchange"},n)),Object(t.a)("GetFolder",e,r)}n.d(r,"a",(function(){return i}))},443:function(e,r,n){"use strict";var t=n(0);function o(e,r){return e?Object(t.__assign)({mailboxInfo:e},r):null!=r?r:void 0}n.d(r,"a",(function(){return o}))},554:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"FolderId:#Exchange"},e)}},6763:function(e,r,n){"use strict";n.d(r,"a",(function(){return s}));var t=n(0),o=n(443),i=n(554),d=n(2499),u=n(2619),a=n(2662),l=n(317);function s(e,r,n,s,c){return Object(t.__awaiter)(this,void 0,void 0,(function(){return Object(t.__generator)(this,(function(t){return[2,Object(a.a)({Header:Object(l.b)(),Body:Object(u.a)({FolderShape:Object(d.a)({BaseShape:"IdOnly",AdditionalProperties:e}),ShapeName:n,FolderIds:r.map((function(e){return Object(i.a)({Id:e})}))})},Object(o.a)(s,c)).then((function(e){var r,n;return null===(n=null===(r=e.Body)||void 0===r?void 0:r.ResponseMessages)||void 0===n?void 0:n.Items}))]}))}))}}}]);
//# sourceMappingURL=owa.FolderWeb.js.map
self.scriptsLoaded['owa.FolderWeb.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FolderWeb.js'] = (new Date()).getTime();