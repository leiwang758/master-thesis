self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AgendaView~CalendarSublimityAssets~MailFilterActions~MailFlaggedEmailLightning~TimePanelCal~c7eef3c0.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[78],{1571:function(e,t,r){"use strict";var n,u,i;!function(e){e[e.CompletedDateTime=0]="CompletedDateTime",e[e.OrderDateTime=1]="OrderDateTime",e[e.CommittedOrder=2]="CommittedOrder"}(n||(n={})),function(e){e.LinkedEntities="LinkedEntities"}(u||(u={})),function(e){e[e.MyDay=0]="MyDay",e[e.DueDate=1]="DueDate",e[e.FolderId=2]="FolderId"}(i||(i={}));var a=r(266),o=r(11),c=r(319),l=r(56),s="/ows/todo/api/v1",d="tasks",m=s+"/tasks/{0}",f=s+"/tasks/{0}",O=s+"/taskfolders/{0}",p=s+"/taskfolders",b=s+"/taskfolders/{0}/tasks",y=s+"/tasks/{0}/subtasks",D=f+"/subtasks/{1}",j=m+"/subtasks/{1}",T=r(10),v=r(1658),C=r(1858),h=r(5055);var S={OrderDateTime:{propertyName:"OrderDateTime",getValue:function(e){return e?e.toISOString():null}},IsReminderOn:{propertyName:"IsReminderOn"},ReminderDateTime:{propertyName:"ReminderDateTime",getValue:function(e){return g(e)}},CompletedDateTime:{propertyName:"CompletedDateTime",getValue:function(e){return g(e)}},DueDateTime:{propertyName:"DueDateTime",getValue:function(e){return g(e)}},IsCompleted:{propertyName:"IsCompleted"},Subject:{propertyName:"Subject"},Status:{propertyName:"Status"},Importance:{propertyName:"Importance"},Note:{propertyName:"Body",getValue:function(e){return function(e){return{Content:e||"",ContentType:"Text"}}(e)}},LinkedEmail:{propertyName:"LinkedEntity",getValue:function(e){return function(e){if(!e)return null;return function(e){return{Id:Object(v.a)(e.Id),WebLink:Object(h.a)(e.Id),EntityType:C.c,EntitySubtype:e.EntitySubtype,DisplayName:e.DisplayName,Preview:{RestId:Object(v.a)(e.Id)}}}(e)}(e)}},CommittedDay:{propertyName:"CommittedDay",getValue:function(e){return e?Object(T.sb)(e):null}},CommittedOrder:{propertyName:"CommittedOrder",getValue:function(e){return e?e.toISOString():null}},CreatedWithLocalId:{propertyName:"CreatedWithLocalId"}};function g(e){return null===e?null:{DateTime:Object(T.qb)(e),TimeZone:e.tz}}function k(e,t){if(!e)return null;var r=Object.keys(e).map((function(r){return function(e,t,r){if(r&&null===t)return null;return function(e,t){var r=S[e];if(!r)return null;var n=r.getValue?r.getValue(t):t;return{key:r.propertyName,value:n}}(e,t)}(r,e[r],t)})).filter((function(e){return!!e}));if(0===r.length)return null;var n={};return r.forEach((function(e){n[e.key]=e.value})),n}function I(e,t){return k(e,t)}var _=r(30);function E(){var e=Object(_.a)().UserOptions.TimeZone;return{Prefer:Object(o.c)('outlook.timezone="{0}"',e)}}var N=r(0);function R(e){return Object(N.__assign)(Object(N.__assign)({},e),{CompletedDateTime:e.CompletedDateTime?Object(T.lc)(e.CompletedDateTime):void 0,OrderDateTime:e.OrderDateTime?Object(T.lc)(e.OrderDateTime):void 0})}function F(e,t,r){var n=Object(o.c)(y,e),u=I(t,!0);return u?Object(c.d)(n,u,null,!1,E()).then((function(e){return e?R(e):null})).catch((function(e){return l.d("[CreateSubtaskService] API returned error",e),null})):(Object(a.q)("CreateSubtaskServiceEmptyRequest",r,{isCore:!0}),null)}function w(e){var t=Object(C.h)(Object(N.__assign)(Object(N.__assign)({},e),{OrderDateTime:e.OrderDateTime?Object(T.lc)(e.OrderDateTime):null,FolderType:"Other"}));return e.FolderType&&"com.microsoft.outlook.email.commitment"===e.FolderType.toLowerCase()&&(t.FolderType="Commitments"),e.FolderType&&"com.microsoft.outlook.email.flagged"===e.FolderType.toLowerCase()&&(t.FolderType="FlaggedEmails"),t}function L(e){return Object(c.d)(p,{Name:e.Name},null,!1,E()).then((function(e){return e.Id?w(e):null})).catch((function(e){return null}))}function q(e,t){return k(e,t)}function V(e){var t,r,n,u,i=Object(N.__assign)(Object(N.__assign)({},e),{__type:"Todo",ReminderDateTime:e.ReminderDateTime?Object(T.lc)(e.ReminderDateTime.DateTime):void 0,CompletedDateTime:e.CompletedDateTime?Object(T.lc)(e.CompletedDateTime.DateTime):void 0,DueDateTime:e.DueDateTime?Object(T.lc)(e.DueDateTime.DateTime):void 0,OrderDateTime:e.OrderDateTime?Object(T.lc)(e.OrderDateTime):void 0,Status:e.Status,Subtasks:e.Subtasks?e.Subtasks.map(R):void 0,Importance:e.Importance,Note:(null===(t=e.Body)||void 0===t?void 0:t.Content)&&"Text"==e.Body.ContentType?e.Body.Content:void 0,LinkedEmail:x(e.LinkedEntities),CommittedDay:e.CommittedDay?(r=e.CommittedDay,n=Object(T.mc)(r),u=Object(T.lc)(Object(T.Cb)(n),Object(T.xb)(n),Object(T.lb)(n)),u):void 0,CommittedOrder:e.CommittedOrder?Object(T.lc)(e.CommittedOrder):void 0,CreatedWithLocalId:e.CreatedWithLocalId?e.CreatedWithLocalId:void 0});return e?i:null}function x(e){if(!e)return null;var t,r=e.filter((function(e){return e.EntityType==C.c}));return 0==r.length?null:(t=r[0],{Id:Object(v.b)(t.Id),EntitySubtype:t.EntitySubtype,DisplayName:t.DisplayName})}function W(e,t,r){void 0===t&&(t=null);var n=t||d,u=Object(o.c)(b,n);return q(e,!0)?Object(c.d)(u,q(e,!0),null,!1,E()).then((function(e){return e.Id?V(e):null})).catch((function(e){return l.d("[CreateTaskService] API returned error",e),null})):(Object(a.q)("CreateTaskServiceEmptyRequest",r,{isCore:!0}),null)}var A=r(336);function P(e,t){var r=Object(o.c)(j,e,t);return Object(c.a)(r,null,null,!0,E()).then((function(e){return Object(A.a)(e.status)})).catch((function(e){return!1}))}function B(e){var t=Object(o.c)(m,e);return Object(c.a)(t,null,null,!0,E()).then((function(e){return Object(A.a)(e.status)})).catch((function(e){return!1}))}function G(){return Object(c.b)(p,void 0,!1,E()).then((function(e){return(null==e?void 0:e.Value)?e.Value.map((function(e){return w(e)})):null})).catch((function(e){return null}))}function M(e){return e&&e.type===i.MyDay}function $(e){return e&&e.type===i.DueDate}function z(e){return e&&e.type===i.FolderId}var K=r(267);function Q(e){var t=e.filters,r=e.orderBy,u=e.expand,i=function(e){if(M(e))return"smartlists/myday";if($(e))return"smartlists/duedate";if(z(e)){var t=e.folderId;return"taskfolders/"+(t||"tasks")}return Object(K.a)(e)}(e),a=function(e){switch(e){case n.CompletedDateTime:return"CompletedDateTime/DateTime desc";case n.OrderDateTime:case n.CommittedOrder:return"OrderDateTime/DateTime desc";default:Object(K.a)(e)}}(r),o=[u].join(","),c=t.taskStatusFilters.length>0?"&$filter="+t.taskStatusFilters.map(U).join(" or "):"";return"/ows/todo/api/v1/"+i+"/tasks/?"+function(e){var t="",r=e.customQueryOptions.maxPageSize;r&&(t+="&maxpagesize="+r);if(M(e)){var n=e.customQueryOptions.date,u=Object(T.sb)(n);return t+"&date="+u}if($(e)){var i=e.customQueryOptions,a=i.startDate,o=i.endDate,c=Object(T.sb)(a),l=Object(T.sb)(o);return t+"&startDate="+c+"&endDate="+l}if(z(e))return t;return Object(K.a)(e)}(e)+c+"&$orderby="+a+"&$expand="+o}function U(e){return"Status "+e.equalityOperator+" '"+e.status+"'"}function Y(e,t){var r=this;return Object(c.b)(e,null,!1,E(),!0,void 0,t).then((function(e){return Object(N.__awaiter)(r,void 0,void 0,(function(){return Object(N.__generator)(this,(function(t){if(function(e){return null==e?void 0:e.Value}(e))return[2,e];throw new Error(Object(o.c)("The service response {0} is not of the expected GetTaskResponse type",e))}))}))})).catch((function(e){var t=function(e){if(e instanceof Error)return e;var t=null;try{t=JSON.stringify(e)}catch(e){t="[getErrorFromObject]: Unable to parse Error Message"}return new Error(t)}(e);return l.g.warn(e),{errorResponse:t,Value:[]}}))}var Z="com.microsoft.teams.message";function J(e){return!!e.Source&&e.Source.substring(0,Z.length)===Z}function H(e){return Object(N.__awaiter)(this,void 0,void 0,(function(){var t;return Object(N.__generator)(this,(function(r){switch(r.label){case 0:return"GET_TASKS_IN_FOLDER",[4,Y(Q(e),"GET_TASKS_IN_FOLDER")];case 1:return(t=r.sent()).errorResponse&&z(e)?("GET_TASKS_IN_FOLDER_RETRY",function(e){var t;if(1===(null===(t=e.filters.taskStatusFilters)||void 0===t?void 0:t.length)){var r=e.filters.taskStatusFilters[0];if("Completed"===r.status&&"ne"===r.equalityOperator)return!0}return!1}(e)&&(e.filters.taskStatusFilters=[{status:"NotStarted",equalityOperator:"eq"},{status:"InProgress",equalityOperator:"eq"},{status:"Deferred",equalityOperator:"eq"},{status:"WaitingOnOthers",equalityOperator:"eq"}]),[4,Y(Q(e),"GET_TASKS_IN_FOLDER_RETRY")]):[3,3];case 2:t=r.sent(),r.label=3;case 3:return t.Value=t.Value.filter((function(e){return!J(e)})),[2,t]}}))}))}function X(e,t,r){var n=Object(o.c)(D,e,t);return Object(c.c)(n,r,null,!0,E()).then((function(e){return Object(A.a)(e.status)})).catch((function(e){return!1}))}function ee(e,t){var r=Object(o.c)(O,e);return Object(c.c)(r,t,null,!0,E()).then((function(e){return Object(A.a)(e.status)})).catch((function(e){return!1}))}function te(e,t){var r=Object(o.c)(f,t);return Object(c.c)(r,e,null,!0,E()).then((function(e){return Object(A.a)(e.status)})).catch((function(e){return!1}))}r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return i})),r.d(t,"d",(function(){return F})),r.d(t,"e",(function(){return L})),r.d(t,"f",(function(){return W})),r.d(t,"g",(function(){return P})),r.d(t,"h",(function(){return B})),r.d(t,"k",(function(){return G})),r.d(t,"l",(function(){return H})),r.d(t,"p",(function(){return X})),r.d(t,"q",(function(){return ee})),r.d(t,"r",(function(){return te})),r.d(t,"i",(function(){return I})),r.d(t,"j",(function(){return q})),r.d(t,"m",(function(){return E})),r.d(t,"o",(function(){return V})),r.d(t,"n",(function(){return J}))},5055:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(752);function u(e){var t={viewmodel:"ReadMessageItem",ItemID:encodeURIComponent(e),ispopout:"1"};return Object(n.a)(t)}}}]);
//# sourceMappingURL=owa.MailBoot~AgendaView~CalendarSublimityAssets~MailFilterActions~MailFlaggedEmailLightning~TimePanelCal~c7eef3c0.js.map
self.scriptsLoaded['owa.MailBoot~AgendaView~CalendarSublimityAssets~MailFilterActions~MailFlaggedEmailLightning~TimePanelCal~c7eef3c0.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AgendaView~CalendarSublimityAssets~MailFilterActions~MailFlaggedEmailLightning~TimePanelCal~c7eef3c0.js'] = (new Date()).getTime();