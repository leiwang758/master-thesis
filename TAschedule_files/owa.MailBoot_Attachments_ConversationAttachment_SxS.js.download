self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Attachments~ConversationAttachment~SxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[152,450],{10536:function(e,t,n){"use strict";var a=n(281);t.a=Object(a.action)("setShouldShowActionsContainer")((function(e,t){e.shouldShowActionsContainer=t}))},10537:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1485),r=n(1352);function o(e){var t=Object(r.a)(e.attachmentId);return!!t&&(!!Object(a.d)(t.model)||t.download.url&&t.info&&t.info.allowDownload)}},10538:function(e,t,n){"use strict";t.a={SurfaceAction:"Surface action",ContextMenu:"Context menu"}},10539:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var a=n(9142),r=n(11),o=n(266),c=n(1752),i=n(7239),d=n(2333),u=n(10538),l=n(1352),s=n(3655),f=n(3048);function m(e,t){var n=Object(l.a)(e.attachmentId),a=Object(s.a)(n);Object(o.q)("AddToCalendar",[t],{cosmosOnlyData:JSON.stringify({size:n.model.Size,fileType:a})}),n.model.Size>10485760||!e.attachmentId||!e.attachmentId.Id?Object(d.a)(e,0,15):(Object(c.B)(Object(c.j)(n.model.Size),.1,(function(t){Object(c.x)(e,t)}),e.attachmentId),Object(i.a)(e,0))}function b(e){var t=Object(l.a)(e.attachmentId);return Object(f.a)(c.a.ImportCalendarEventAttachment,e)&&t&&13===t.attachmentClass?{name:Object(r.b)(a.a),key:"AddToCalendar",onClick:function(){m(e,u.a.ContextMenu)}}:null}},10624:function(e){e.exports=JSON.parse('{"a":"Erb"}')},10625:function(e){e.exports=JSON.parse('{"a":"bsb"}')},1352:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1674);function r(e){return Object(a.a)().attachments.get(e.Id)}},1437:function(e,t,n){"use strict";var a=n(74),r={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return i})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return r}));var o=new a.c((function(){return Promise.all([n.e(3),n.e(23),n.e(665)]).then(n.bind(null,17186))})),c=new a.a(o,(function(e){return e.subscribe})),i=new a.a(o,(function(e){return e.unsubscribe})),d=new a.b(o,(function(e){return e.getChannelId})),u=(new a.b(o,(function(e){return e.getChannelReady})),new a.a(o,(function(e){return e.setup}))),l=new a.a(o,(function(e){return e.initializeNotificationManager})),s=new a.b(o,(function(e){return e.getNotificationEmitter}))},1479:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0);function r(e){return Object(a.__assign)({__type:"IndexedPageView:#Exchange"},e)}},15015:function(e){e.exports=JSON.parse('{"a":"fsb","c":"gsb","d":"hsb","b":"isb","e":"jsb"}')},15016:function(e,t,n){var a=n(15017),r=n(130);"string"==typeof a&&(a=[[e.i,a]]);for(var o=0;o<a.length;o++)r.loadStyles(a[o][1],!1);a.locals&&(e.exports=a.locals)},15017:function(e,t,n){(t=e.exports=n(129)(!1)).push([e.i,'._2KRgryadS8K-_TLdBoNKmd{font-size:14px;color:"[theme:neutralSecondary, default:#666666]";height:25px;width:26px}html[dir] ._2KRgryadS8K-_TLdBoNKmd{padding:4px;text-align:center}._2KRgryadS8K-_TLdBoNKmd:focus,._2KRgryadS8K-_TLdBoNKmd:hover,._1eq1P1PoHUzBriyfNWVd1T{color:"[theme:neutralSecondary, default:#666666]"}._1eq1P1PoHUzBriyfNWVd1T{display:block}.HDG8P1QaVRBOeSU0W5zmW{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW{right:26px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW{left:26px}.HDG8P1QaVRBOeSU0W5zmW:focus,.HDG8P1QaVRBOeSU0W5zmW:hover{color:"[theme:white, default:#ffffff]"}html[dir] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir] .HDG8P1QaVRBOeSU0W5zmW:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-right-radius:2px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-left-radius:2px}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{right:52px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{left:52px}._2ebptdF8eCnt_2-FT7dzaH{font-size:14px}html[dir] ._2ebptdF8eCnt_2-FT7dzaH{margin:0}html[dir] .IPPU7NtLHAzlPwHTIXmXp:focus,html[dir] .IPPU7NtLHAzlPwHTIXmXp:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] .rPIl3tr-13EegQ4JcXUy_,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq,html[dir] ._17q1sDoo-1SD8o99_vx_Wl,html[dir] ._1H8nRWpPKM9iogJAm6ze6p,html[dir] ._3bO0ii_CywH_7ysZAUsxkB,html[dir] ._1E-xlZkNQ0oWd42XQohXqv{margin:0;background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .rPIl3tr-13EegQ4JcXUy_:focus,html[dir] .rPIl3tr-13EegQ4JcXUy_:hover,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:focus,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:hover,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:focus,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:hover,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:focus,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:hover,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:focus,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:hover,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:focus,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:hover{background:"[theme:themeTertiary, default:#71AFE5]"}html[dir] .rPIl3tr-13EegQ4JcXUy_{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}',""]),t.locals={actionButton:"_2KRgryadS8K-_TLdBoNKmd",actionButtonForDocViewInCompose:"_1eq1P1PoHUzBriyfNWVd1T",actionButtonForImageView:"HDG8P1QaVRBOeSU0W5zmW",extraRightPadding:"_2RdXhaKvBvt2MX9AyW7pcR",icon:"_2ebptdF8eCnt_2-FT7dzaH",default:"IPPU7NtLHAzlPwHTIXmXp",edit:"rPIl3tr-13EegQ4JcXUy_",notSelectedAndSaving:"_3vsJWDG9Ae71RWCd-gnOXq",selected:"_17q1sDoo-1SD8o99_vx_Wl",selectedAndPending:"_1H8nRWpPKM9iogJAm6ze6p",selectedAndSaving:"_3bO0ii_CywH_7ysZAUsxkB",thematic:"_1E-xlZkNQ0oWd42XQohXqv"}},1644:function(e,t){e.exports=function(e){return e instanceof Date}},1670:function(e,t,n){var a=n(1644),r=36e5,o=6e4,c=2,i=/[T ]/,d=/:/,u=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],s=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],m=/^-(\d{2})$/,b=/^-?(\d{3})$/,v=/^-?(\d{2})-?(\d{2})$/,h=/^-?W(\d{2})$/,p=/^-?W(\d{2})-?(\d{1})$/,O=/^(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,g=/([Z+-].*)$/,I=/^(Z)$/,S=/^([+-])(\d{2})$/,C=/^([+-])(\d{2}):?(\d{2})$/;function A(e,t,n){t=t||0,n=n||0;var a=new Date(0);a.setUTCFullYear(e,0,4);var r=7*t+n+1-(a.getUTCDay()||7);return a.setUTCDate(a.getUTCDate()+r),a}e.exports=function(e,t){if(a(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?c:Number(n);var _=function(e){var t,n={},a=e.split(i);d.test(a[0])?(n.date=null,t=a[0]):(n.date=a[0],t=a[1]);if(t){var r=g.exec(t);r?(n.time=t.replace(r[1],""),n.timezone=r[1]):n.time=t}return n}(e),T=function(e,t){var n,a=l[t],r=f[t];if(n=s.exec(e)||r.exec(e)){var o=n[1];return{year:parseInt(o,10),restDateString:e.slice(o.length)}}if(n=u.exec(e)||a.exec(e)){var c=n[1];return{year:100*parseInt(c,10),restDateString:e.slice(c.length)}}return{year:null}}(_.date,n),x=T.year,y=function(e,t){if(null===t)return null;var n,a,r,o;if(0===e.length)return(a=new Date(0)).setUTCFullYear(t),a;if(n=m.exec(e))return a=new Date(0),r=parseInt(n[1],10)-1,a.setUTCFullYear(t,r),a;if(n=b.exec(e)){a=new Date(0);var c=parseInt(n[1],10);return a.setUTCFullYear(t,0,c),a}if(n=v.exec(e)){a=new Date(0),r=parseInt(n[1],10)-1;var i=parseInt(n[2],10);return a.setUTCFullYear(t,r,i),a}if(n=h.exec(e))return o=parseInt(n[1],10)-1,A(t,o);if(n=p.exec(e)){o=parseInt(n[1],10)-1;var d=parseInt(n[2],10)-1;return A(t,o,d)}return null}(T.restDateString,x);if(y){var D,W=y.getTime(),P=0;return _.time&&(P=function(e){var t,n,a;if(t=O.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*r;if(t=w.exec(e))return n=parseInt(t[1],10),a=parseFloat(t[2].replace(",",".")),n%24*r+a*o;if(t=j.exec(e)){n=parseInt(t[1],10),a=parseInt(t[2],10);var c=parseFloat(t[3].replace(",","."));return n%24*r+a*o+1e3*c}return null}(_.time)),_.timezone?D=function(e){var t,n;if(t=I.exec(e))return 0;if(t=S.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=C.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(_.timezone):(D=new Date(W+P).getTimezoneOffset(),D=new Date(W+P+D*o).getTimezoneOffset()),new Date(W+P+D*o)}return new Date(e)}},2314:function(e,t,n){"use strict";function a(e,t){(t||window).open(e,"_blank")}n.d(t,"a",(function(){return a}))},2418:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2314),r=n(266),o=n(67);function c(e,t,n,c){var i;if(Object(r.q)("downloadFileFromUrl",{isBrowserIE:Object(o.g)(),urlLength:e.length}),t||Object(o.g)())Object(a.a)(e);else{var d=document.createElement("a");d.style.display="none",d.href=e,d.download=c||"",n||(n=(null===(i=document.activeElement)||void 0===i?void 0:i.parentElement)||document.body),n.appendChild(d),d.click(),n.removeChild(d)}}},3048:function(e,t,n){"use strict";function a(e,t){return-1!==t.strategy.supportedMenuActions.indexOf(e)}n.d(t,"a",(function(){return a}))},3113:function(e,t,n){"use strict";var a=n(74),r=n(1587),o=n(0),c=n(1485),i=n(1352),d=n(2418),u=n(2019);function l(e,t,n){return Object(o.__awaiter)(this,void 0,void 0,(function(){var a,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return(a=Object(i.a)(e))?Object(c.d)(a.model)?[4,u.e.import()]:[3,2]:[2];case 1:return o.sent()(a.model),[3,3];case 2:(r=a.download.url)&&Object(d.a)(r,t,n),o.label=3;case 3:return[2]}}))}))}n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return r.c})),n.d(t,"b",(function(){return l}));var s=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(18),n.e(23),n.e(30),n.e(28),n.e(34),n.e(41),n.e(42),n.e(48),n.e(47),n.e(64),n.e(65),n.e(68),n.e(92),n.e(104),n.e(154),n.e(152),n.e(153),n.e(216),n.e(215),n.e(214),n.e(314)]).then(n.bind(null,17480))})),f=new a.a(s,(function(e){return e.clickAttachment})).importAndExecute,m=new a.a(s,(function(e){return e.previewAttachment}))},4425:function(e,t,n){"use strict";function a(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return a}))},4488:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.saveToCloud=0]="saveToCloud",e[e.download=1]="download",e[e.addToCalendar=2]="addToCalendar",e[e.editAndReply=3]="editAndReply",e[e.openNewTabAndSaveToCloud=4]="openNewTabAndSaveToCloud",e[e.openAndEdit=5]="openAndEdit"}(a||(a={}))},4785:function(e){e.exports=JSON.parse('{"a":"csb"}')},4855:function(e){e.exports=JSON.parse('{"f":"irb","a":"jrb","e":"krb","d":"lrb","c":"mrb","b":"nrb"}')},7452:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return s}));var a=n(10536),r=n(4766),o=n(4767),c={},i=null;function d(e,t){c[e.attachmentId.Id]&&(clearTimeout(c[e.attachmentId.Id]),c[e.attachmentId.Id]=null),i=e.attachmentId.Id,Object(a.a)(e,!0),t&&!Object(o.a)(e)&&Object(r.a)(e,!0)}function u(e,t){c[e.attachmentId.Id]&&clearTimeout(c[e.attachmentId.Id]),c[e.attachmentId.Id]=setTimeout((function(){Object(a.a)(e,!1),t&&!Object(o.a)(e)&&Object(r.a)(e,!1),e.attachmentId.Id===i&&(i=null),c[e.attachmentId.Id]=null}),40)}function l(e,t){Object(a.a)(e,!0),t&&!Object(o.a)(e)&&Object(r.a)(e,!0)}function s(e,t){e.attachmentId.Id!==i&&(Object(a.a)(e,!1),t&&!Object(o.a)(e)&&Object(r.a)(e,!1))}},7453:function(e){e.exports=JSON.parse('{"a":"Eob"}')},7454:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(1352),r=n(1345),o=n(4425);function c(e){var t=Object(a.a)(e),n=Object(r.c)(t.model.Name||"");return""!==Object(o.a)(n)&&"Visio"!==Object(o.a)(n)}},7455:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(267),r=n(1752),o=n(10537),c=n(77),i=n(318),d=n(4488),u=n(3048),l=n(7454),s=n(7456);function f(e,t){if(0!==t.ongoingAction||!t.strategy.showActionsMenu)return!0;switch(e){case d.a.addToCalendar:return!1;case d.a.download:return!Object(u.a)(r.a.Download,t)||!Object(o.a)(t);case d.a.saveToCloud:case d.a.openNewTabAndSaveToCloud:return!t.isReadOnly||!function(e,t){var n,a=Object(i.a)()&&"GroupMailbox"===(null===(n=e.attachmentId.mailboxInfo)||void 0===n?void 0:n.type),o=!1;o=t===d.a.openNewTabAndSaveToCloud?Object(s.a)()&&Object(l.a)(e.attachmentId):Object(c.i)("woven-saveToCloud2-viewInOneDrive")||Object(c.i)("woven-saveToCloud2-editInOneDrive")||Object(c.i)("woven-saveToCloud2-editInApp")||Object(c.i)("woven-saveToCloud2-editOnline")||Object(c.i)("woven-saveToCloud2-openFolder")||Object(c.i)("wvn-productizeSTCHoverActionOnly")||m()||Object(c.i)("wvn-productizeSTCHoverAndCloudWithTeaching")||Object(c.i)("wvn-productizeSTCChicletAndPreview")||Object(s.a)();return o&&Object(u.a)(r.a.SaveToCloud,e)&&Object(r.t)(e)&&!a}(t,e);case d.a.editAndReply:return!t.isReadOnly||!Object(l.a)(t.attachmentId);case d.a.openAndEdit:return!t.isReadOnly||!(m()||Object(c.i)("wvn-productizeSTCHoverAndCloudWithTeaching")||Object(c.i)("wvn-productizeSTCChicletAndPreview"))||2!==t.actionMessage&&3!==t.actionMessage;default:return Object(a.a)(e)}}function m(){var e=Object(c.i)("wvn-chicletEditOptions")||Object(c.i)("wvn-chicletEditOptionsNoDownload");return Object(c.i)("wvn-productizeSTCHoverAndCloud")&&!e}},7456:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(562),r=n(77);function o(){return Object(r.i)("woven-newTabExperiment")&&Object(a.d)()}},791:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0);function r(e){return Object(a.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},804:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(29),r=n(791);function o(e,t){return void 0===e||e.__type||(e=Object(r.a)(e)),Object(a.a)("FindItem",e,t)}},805:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0);function r(e){return Object(a.__assign)({__type:"FindItemRequest:#Exchange"},e)}},9140:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"g",(function(){return l}));var a=n(74),r=n(9141);n.d(t,"f",(function(){return r.a}));var o=n(4488);n.d(t,"e",(function(){return o.a}));var c=n(9609);n.d(t,"a",(function(){return c.a}));var i=n(4855);n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return i.e}));var d=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(18),n.e(23),n.e(30),n.e(28),n.e(34),n.e(41),n.e(42),n.e(48),n.e(47),n.e(64),n.e(65),n.e(68),n.e(92),n.e(104),n.e(154),n.e(152),n.e(153),n.e(216),n.e(215),n.e(214),n.e(314)]).then(n.bind(null,16609))})),u=Object(a.d)(d,(function(e){return e.AttachmentView})),l=new a.b(d,(function(e){return e.getContextMenus}))},9141:function(e,t,n){"use strict";t.a={OnClick:{name:"AttachmentOnClick",customData:function(e){return[e]}}}},9142:function(e){e.exports=JSON.parse('{"a":"Crb"}')},9143:function(e,t,n){"use strict";var a=n(1305);t.a=function(e){var t,n,r=e&&Object(a.v)(e);return null===(n=null===(t=(null==r?void 0:r.From)||(null==r?void 0:r.Sender))||void 0===t?void 0:t.Mailbox)||void 0===n?void 0:n.EmailAddress}},9609:function(e,t,n){"use strict";var a=n(47),r=n(674),o=n(93),c=n(1463),i=n(56),d=n(1),u=n(4488),l=n(7452),s=n(267),f=n(11),m=n(9142),b=n(7453),v=n(15015),h=n(7454);var p=n(7455),O=n(0),w=n(266),j=n(1752),g=n(10538),I=n(10539),S=n(1485),C=n(1352),A=n(3655),_=n(3113),T=n(2418),x=n(361),y=n(4118),D=n(2019),W=n(765),P=n(24),R="/"+Object(O.__spread)(["mail"],Object(W.a)().split("/").slice(1)).join("/")+"deeplink/saveAndEdit/";var E=n(9143);function z(e,t,n,a){var r,o,d,l=Object(c.k)(a);switch(e){case u.a.addToCalendar:Object(I.a)(t,g.a.SurfaceAction);break;case u.a.download:!function(e,t){var n,a;Object(O.__awaiter)(this,void 0,void 0,(function(){var r,o,c,d,u,l,s,f;return Object(O.__generator)(this,(function(m){switch(m.label){case 0:return(r=Object(C.a)(e.attachmentId))?Object(S.d)(r.model)?[4,D.e.import()]:[3,2]:(i.d("AttachmentSurfaceActionButton.downloadAttachment attachmentModel is null"),[2]);case 1:return m.sent()(r.model),[3,3];case 2:Object(T.a)(r.download.url,e.isCloudy,document.body),m.label=3;case 3:return o=Object(A.a)(r),Object(w.q)("AttachmentDownload",{entryPoint:"SurfaceAction",isCloudy:e.isCloudy,isCompose:!e.isReadOnly},{cosmosOnlyData:JSON.stringify({size:r.model.Size,fileType:o,attachmentId:null===(n=r.model.AttachmentId)||void 0===n?void 0:n.Id})}),c=null==t?void 0:t.Id,u=(d=w.n).importAndExecute,l=["SavedAttachment"],f={},(s=c)?[4,Object(y.a)(c)]:[3,5];case 4:s=m.sent(),m.label=5;case 5:return u.apply(d,l.concat([(f.itemId=s,f.customProperties={FileId:null===(a=r.model.AttachmentId)||void 0===a?void 0:a.Id,FileType:o,Destination:"Local",Sender:Object(E.a)(c)},f)])),[2]}}))}))}(t,n);break;case u.a.saveToCloud:!function(e,t,n){var a,r=Object(C.a)(e.attachmentId);if(!r)return void i.d("AttachmentSurfaceActionButton.saveToCloud attachmentModel is null");Object(w.q)("AttachmentSaveToCloud",{entryPoint:"SurfaceAction"},{cosmosOnlyData:JSON.stringify({size:r.model.Size,fileType:Object(A.a)(r),attachmentId:null===(a=r.model.AttachmentId)||void 0===a?void 0:a.Id}),isCore:!0}),Object(j.B)(Object(j.p)(e.attachmentId),.1,(function(t){Object(j.x)(e,t)}),e.attachmentId),Object(j.u)(e,(function(t){Object(j.C)(e.attachmentId,t)}),"SurfaceAction",t,Object(E.a)(null==t?void 0:t.Id),n)}(t,n,l);break;case u.a.editAndReply:!function(e,t,n){Object(O.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(O.__generator)(this,(function(r){switch(r.label){case 0:return[4,_.d.import()];case 1:return n=r.sent(),Object(w.q)("WovenEditAndReplyFromSurface",{},{isCore:!0}),a={viewState:e,attachmentSelectionSource:c.b.ReadingPane,parentItemId:t,isDraft:!1,isEdit:!0,onBeforePreview:function(){return null},createImageGallery:function(){return null},instrumentationContext:null,targetWindow:window},n(a),[2]}}))}))}(t,n);break;case u.a.openNewTabAndSaveToCloud:!function(e,t,n){Object(O.__awaiter)(this,void 0,void 0,(function(){var a,r;return Object(O.__generator)(this,(function(o){return a=Object(x.a)(),function(e,t,n){var a=""+R;a+=encodeURIComponent(null==n?void 0:n.Id)+"/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)+"/"+Object(P.a)().search,window.open(a,"_blank")}(e.attachmentId.Id,a,t),r=new w.b("WovenNewTabSaveToCloud",{isCore:!0}),Object(j.B)(4*Object(j.p)(e.attachmentId),.1,(function(t){Object(j.x)(e,t)}),e.attachmentId),Object(j.D)(e,(function(t){Object(j.C)(e.attachmentId,t),t?r.end():r.endWithError("ServerError")}),"PencilExperiment",t,a,Object(E.a)(null==t?void 0:t.Id),n),[2]}))}))}(t,n,l);break;case u.a.openAndEdit:r=t,o=Object(C.a)(r.attachmentId).model.AttachmentOriginalUrl,d=-1===o.indexOf("?")?"?":"&",window.open(o+d+"web=1","_blank"),Object(w.q)("WovenOpenAndEditFromSurface",{},{isCore:!0});break;default:Object(s.a)(e)}}var B=n(1854),N=n(15016),U=n(388).bind(N);t.a=Object(a.a)((function(e){var t=d.useContext(B.a),n=e.action,a=e.attachmentViewState,O=e.customClassName,w=e.isForImageView,j=e.previewState;if(Object(p.a)(n,a))return null;var g=void 0,I=function(e){switch(e){case c.a.Edit:return N.edit;case c.a.NotSelectedAndSaving:return N.notSelectedAndSaving;case c.a.OtherSaving:return N.attachmentView;case c.a.Selected:return N.selected;case c.a.SelectedAndPending:return N.selectedAndPending;case c.a.SelectedAndSaving:return N.selectedAndSaving;default:return N.default}}(j);if(w){var S={extraRightPadding:H(n,a)};g=U([N.actionButton,N.actionButtonForImageView,O,S])}else g=a.isReadOnly?U([N.actionButton,I,O]):U([N.actionButton,I,N.actionButtonForDocViewInCompose,O]);var C=function(e,t){switch(e){case u.a.addToCalendar:return"AddEvent";case u.a.download:return"Download";case u.a.saveToCloud:return"CloudUpload";case u.a.openNewTabAndSaveToCloud:return"Edit";case u.a.editAndReply:return"PencilReply";case u.a.openAndEdit:return Object(h.a)(t)?"CloudEdit":"Cloud";default:return Object(s.a)(e)}}(n,a.attachmentId),A=function(e,t){switch(e){case u.a.addToCalendar:return Object(f.b)(m.a);case u.a.download:return Object(f.b)(b.a);case u.a.saveToCloud:return Object(f.b)(v.d);case u.a.openNewTabAndSaveToCloud:return Object(f.b)(v.c);case u.a.editAndReply:return Object(f.b)(v.a);case u.a.openAndEdit:return Object(h.a)(t)?Object(f.b)(v.b):Object(f.b)(v.e);default:return Object(s.a)(e)}}(n,a.attachmentId);return d.createElement(r.a,{onFocus:function(){return Object(l.b)(e.attachmentViewState,e.isForImageView)},onBlur:function(){e.shouldNotHandleOnBlur||Object(l.a)(e.attachmentViewState,e.isForImageView)},onKeyDown:function(n){n.keyCode!==o.a.enter&&n.keyCode!==o.a.space||(i.g.info("AttachmentSurfaceActionButton.keyDown enter|space"),n.stopPropagation(),z(e.action,e.attachmentViewState,e.parentItemId,t))},ariaLabel:A,title:A,onClick:function(n){i.g.info("AttachmentSurfaceActionButton.onclick"),n.stopPropagation(),z(e.action,e.attachmentViewState,e.parentItemId,t)},className:g,iconProps:{iconName:C,styles:{root:N.icon}}})}));function H(e,t){return(e===u.a.saveToCloud||e===u.a.editAndReply||e===u.a.openNewTabAndSaveToCloud||e===u.a.openAndEdit)&&!Object(p.a)(u.a.download,t)}}}]);
//# sourceMappingURL=owa.MailBoot~Attachments~ConversationAttachment~SxS.js.map
self.scriptsLoaded['owa.MailBoot~Attachments~ConversationAttachment~SxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Attachments~ConversationAttachment~SxS.js'] = (new Date()).getTime();