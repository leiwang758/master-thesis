self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentModelStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[313,450],{1301:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(49);function i(t){if(!t)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(t)}},1307:function(t,n,e){"use strict";function r(t){if(!t)return null;var n=t.lastIndexOf(".");return n>0?t.substr(n).toLowerCase():null}function i(t){var n=r(t);return n?n.replace(".",""):null}function c(t){var n;return(null===(n=i(t))||void 0===n?void 0:n.substring(0,4))||""}e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return c}))},1331:function(t,n,e){"use strict";function r(t,n){Object.keys(n).forEach((function(e){return t.set(e,n[e])}))}function i(t){var n=null!=t?t:{headers:new Headers};return n.datapoint=n.datapoint||{},n.datapoint.mailbox="Default",n}e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return i}))},1333:function(t,n,e){"use strict";var r=e(0),i=e(1394),c=e(389),u=e(669),o=e(266),a=e(10),s="X-AnchorMailbox",f="Authorization",d="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function b(t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,b,v,p,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(e={},b=Object(c.k)(t)){if(b.accountState==c.b.AccessRevoked)return[2,null];if(b.accountState==c.b.AccountDeprovisioned||b.accountState==c.b.AccountNotFound)return Object(c.c)(b.accountState,b.accountProviderType),[2,null]}return n?(e[s]=n,e[l]=n):b&&(e[s]=b.anchorMailbox),b?(v=b.token,!(p=Object(u.g)(b.tokenExpiry))&&v?[3,2]:(Object(o.q)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(b.tokenExpiry,Object(a.Pb)()),isTokenExpired_1:p,isTokenInvalid_2:!v},{isCore:!0}),[4,i.a.importAndExecute(b.accountId,t,v)])):[3,3];case 1:(v=r.sent())||(v=""),r.label=2;case 2:h=void 0,"Outlook"==b.accountProviderType?(h='MSAuth1.0 usertoken="'+v+'", type="MSACT"',e[d]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(h="Bearer "+v,e[d]=2..toString()),e[f]=h,r.label=3;case 3:return[2,e]}}))}))}var v=e(1331),p=e(56);function h(t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(v.a)(),i=e,[4,m(t,n)];case 1:return i.headers=r.sent(),e.authNeededOnUnAuthorized=!1,e.datapoint=e.datapoint||{},e.datapoint.mailbox="Connected",[2,e]}}))}))}function m(t,n){var e;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=n&&(null===(e=t.headers)||void 0===e?void 0:e.set)?new Headers(t.headers):new Headers,[4,b(t.mailboxInfo.userIdentity,O(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return c=r.sent(),Object(v.b)(i,c),[2,i]}}))}))}function O(t,n){var e="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return e&&null==n&&p.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),e}e.d(n,"a",(function(){return b})),e.d(n,"b",(function(){return h})),e.d(n,"c",(function(){return O}))},1334:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(3),i=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1366:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(273);function i(){return Object(r.a)().attachment}},1385:function(t,n,e){"use strict";var r,i,c;e.d(n,"c",(function(){return r})),e.d(n,"b",(function(){return i})),e.d(n,"a",(function(){return c})),function(t){t[t.Compose=0]="Compose",t[t.Extensibility=1]="Extensibility",t[t.ReadingPane=2]="ReadingPane",t[t.Fileshub=3]="Fileshub",t[t.Txp=4]="Txp",t[t.Peek=5]="Peek",t[t.CalendarCard=6]="CalendarCard"}(r||(r={})),function(t){t[t.SmimeSignature=0]="SmimeSignature",t[t.Safety=1]="Safety",t[t.Error=2]="Error",t[t.Info=3]="Info",t[t.Encryption=4]="Encryption",t[t.Translation=5]="Translation",t[t.Sensitivity=6]="Sensitivity",t[t.InsightMessage=7]="InsightMessage",t[t.External=8]="External",t[t.Spotlight=9]="Spotlight"}(i||(i={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow",t[t.Orange=4]="Orange",t[t.Green20=5]="Green20"}(c||(c={}))},1394:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(74),i=e(1334);e.d(n,"b",(function(){return i.a}));var c=new r.c((function(){return e.e(1356).then(e.bind(null,1689))})),u=new r.a(c,(function(t){return t.getAndUpdateAccessToken}))},1479:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(0);function i(t){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},t)}},1535:function(t,n,e){"use strict";e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return c})),e.d(n,"e",(function(){return u})),e.d(n,"d",(function(){return o}));var r="FileAttachment:#Exchange",i="ItemAttachment:#Exchange",c="ItemIdAttachment:#Exchange",u="ReferenceAttachment:#Exchange",o="LinkAttachment:#Exchange"},1566:function(t,n,e){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return i})),function(t){t.noPermissionToShare="WarningNoPermissionToShare",t.getSharingInfoFailed="WarningGetSharingInfoFailed",t.linkHasExpired="WarningLinksHasExpired",t.linkWillExpire="WarningLinksWillExpire",t.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",t.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",t.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",t.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1598:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(1535);function i(t){return(t.__type||t.OwsTypeName)===r.e}},1644:function(t,n){t.exports=function(t){return t instanceof Date}},1662:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(267);function i(t){switch(t){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(t)}}},1670:function(t,n,e){var r=e(1644),i=36e5,c=6e4,u=2,o=/[T ]/,a=/:/,s=/^(\d{2})$/,f=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,l=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,v=/^-?(\d{3})$/,p=/^-?(\d{2})-?(\d{2})$/,h=/^-?W(\d{2})$/,m=/^-?W(\d{2})-?(\d{1})$/,O=/^(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,y=/^(Z)$/,A=/^([+-])(\d{2})$/,x=/^([+-])(\d{2}):?(\d{2})$/;function I(t,n,e){n=n||0,e=e||0;var r=new Date(0);r.setUTCFullYear(t,0,4);var i=7*n+e+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}t.exports=function(t,n){if(r(t))return new Date(t.getTime());if("string"!=typeof t)return new Date(t);var e=(n||{}).additionalDigits;e=null==e?u:Number(e);var w=function(t){var n,e={},r=t.split(o);a.test(r[0])?(e.date=null,n=r[0]):(e.date=r[0],n=r[1]);if(n){var i=S.exec(n);i?(e.time=n.replace(i[1],""),e.timezone=i[1]):e.time=n}return e}(t),T=function(t,n){var e,r=f[n],i=l[n];if(e=d.exec(t)||i.exec(t)){var c=e[1];return{year:parseInt(c,10),restDateString:t.slice(c.length)}}if(e=s.exec(t)||r.exec(t)){var u=e[1];return{year:100*parseInt(u,10),restDateString:t.slice(u.length)}}return{year:null}}(w.date,e),k=T.year,_=function(t,n){if(null===n)return null;var e,r,i,c;if(0===t.length)return(r=new Date(0)).setUTCFullYear(n),r;if(e=b.exec(t))return r=new Date(0),i=parseInt(e[1],10)-1,r.setUTCFullYear(n,i),r;if(e=v.exec(t)){r=new Date(0);var u=parseInt(e[1],10);return r.setUTCFullYear(n,0,u),r}if(e=p.exec(t)){r=new Date(0),i=parseInt(e[1],10)-1;var o=parseInt(e[2],10);return r.setUTCFullYear(n,i,o),r}if(e=h.exec(t))return c=parseInt(e[1],10)-1,I(n,c);if(e=m.exec(t)){c=parseInt(e[1],10)-1;var a=parseInt(e[2],10)-1;return I(n,c,a)}return null}(T.restDateString,k);if(_){var E,P=_.getTime(),C=0;return w.time&&(C=function(t){var n,e,r;if(n=O.exec(t))return(e=parseFloat(n[1].replace(",",".")))%24*i;if(n=g.exec(t))return e=parseInt(n[1],10),r=parseFloat(n[2].replace(",",".")),e%24*i+r*c;if(n=j.exec(t)){e=parseInt(n[1],10),r=parseInt(n[2],10);var u=parseFloat(n[3].replace(",","."));return e%24*i+r*c+1e3*u}return null}(w.time)),w.timezone?E=function(t){var n,e;if(n=y.exec(t))return 0;if(n=A.exec(t))return e=60*parseInt(n[2],10),"+"===n[1]?-e:e;if(n=x.exec(t))return e=60*parseInt(n[2],10)+parseInt(n[3],10),"+"===n[1]?-e:e;return 0}(w.timezone):(E=new Date(P+C).getTimezoneOffset(),E=new Date(P+C+E*c).getTimezoneOffset()),new Date(P+C+E*c)}return new Date(t)}},1695:function(t,n,e){"use strict";var r=e(1535),i=e(11),c=function(t){return t&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(t)};function u(t){var n=t.__type||t.OwsTypeName;switch(n){case r.a:return 0;case r.e:return t.IsLink?3:1;case r.d:return 3;case r.b:return 2;case r.c:var e=t,u=t.EmbeddedItemClass;return u&&c(u)||Object(i.f)(e.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+n)}}e.d(n,"a",(function(){return u}))},1750:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.InProgress=0]="InProgress",t[t.Failed=1]="Failed",t[t.Succeeded=2]="Succeeded"}(r||(r={}))},1761:function(t,n,e){"use strict";e.d(n,"a",(function(){return i})),e.d(n,"b",(function(){return c}));var r=e(1695);function i(t){return u(t.type)}function c(t){return u(Object(r.a)(t))}function u(t){return 1===t||3===t}},1784:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(3),i=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(t){return{id:t}}))},1785:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.ignore=0]="ignore",t[t.refreshExpiration=1]="refreshExpiration",t[t.changePermission=2]="changePermission",t[t.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1814:function(t,n,e){"use strict";var r=e(1366);function i(){var t=Object(r.a)();return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var c=e(1662),u=e(1598);function o(){return i()}function a(t){return(t&&t.length>0&&function(t){return t.some((function(t){return!((n=t).IsInline&&!Object(u.a)(n));var n}))}(t)?i():[]).map(c.a)}e.d(n,"a",(function(){return o})),e.d(n,"b",(function(){return a}))},186:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(24);function i(){var t=Object(r.a)(),n=t.origin;return n||(n=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),n}},187:function(t,n,e){"use strict";function r(){var t=Object.create(null),n=0,e=0,r=0,i=!1;function c(n){r--,delete t[n]}this.put=function(n,e,i,u){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var o=t[n];o?clearTimeout(o.timeout):r++;var a={value:e,expire:i+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){c(n),u&&u(n,e)}.bind(this),i)),t[n]=a,e},this.del=function(n){var e=!0,r=t[n];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(e=!1)):e=!1,e&&c(n),e},this.clear=function(){for(var c in t)clearTimeout(t[c].timeout);r=0,t=Object.create(null),i&&(n=0,e=0)},this.get=function(c){var u=t[c];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return i&&n++,u.value;i&&e++,r--,delete t[c]}else i&&e++;return null},this.size=function(){return r},this.memsize=function(){var n,e=0;for(n in t)e++;return e},this.debug=function(t){i=t},this.hits=function(){return n},this.misses=function(){return e},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var n={};for(var e in t){var r=t[e];n[e]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(n)},this.importJson=function(n,e){var r=JSON.parse(n),i=Date.now(),c=e&&e.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(c)if(t[u])continue;var o=r[u],a=o.expire-i;if(a<=0){this.del(u);continue}a=a>0?a:void 0,this.put(u,o.value,a)}return this.size()}}t.exports=new r,t.exports.Cache=r},1887:function(t,n,e){"use strict";e.d(n,"h",(function(){return s})),e.d(n,"i",(function(){return f})),e.d(n,"f",(function(){return d})),e.d(n,"k",(function(){return l})),e.d(n,"m",(function(){return b})),e.d(n,"e",(function(){return v})),e.d(n,"g",(function(){return p})),e.d(n,"j",(function(){return h})),e.d(n,"l",(function(){return m}));var r=e(74),i=e(1784);e.d(n,"n",(function(){return i.a}));var c=e(1750);e.d(n,"a",(function(){return c.a}));var u=e(1566);e.d(n,"d",(function(){return u.b})),e.d(n,"c",(function(){return u.a}));var o=e(1785);e.d(n,"b",(function(){return o.a}));var a=new r.c((function(){return Promise.all([e.e(3),e.e(34),e.e(71),e.e(740)]).then(e.bind(null,3100))})),s=new r.b(a,(function(t){return t.getSharingInformation})),f=new r.b(a,(function(t){return t.getSharingIssuesForSharingData})),d=new r.b(a,(function(t){return t.getInfoBarCreator})),l=new r.b(a,(function(t){return t.hasLargeDLRecipient})),b=new r.b(a,(function(t){return t.hasRecipientExpansionFailure})),v=new r.b(a,(function(t){return t.getGroupsAndSmallDLs})),p=new r.b(a,(function(t){return t.getInvididualRecipients})),h=new r.b(a,(function(t){return t.hasGetRecipientPermissionFailed})),m=new r.b(a,(function(t){return t.logSharingTipChangesForLinkRemoval}))},2004:function(t,n,e){"use strict";var r=e(74),i=[0,1],c=e(2195),u=e(2125),o=e(11),a=e(267),s=e(1385);function f(t){switch(t){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(u.a),messageParts:[Object(o.b)(u.a),d()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(c.b),messageParts:[Object(o.b)(c.b),d()],color:s.a.Red};default:return Object(a.a)(t)}}function d(){return{text:Object(o.b)(c.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var l=e(1814),b=e(1662),v=e(0),p=e(77),h=e(1366);function m(){var t=Object(h.a)();if(Object(p.i)("fwk-devTools")){if(Object(p.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(v.__assign)(Object(v.__assign)({},t),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(p.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(v.__assign)(Object(v.__assign)({},t),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return t}function O(){var t=m();return t.DirectFileAccessOnPrivateComputersEnabled&&t.DirectFileAccessOnPublicComputersEnabled?2:t.WacViewingOnPrivateComputersEnabled&&t.WacViewingOnPublicComputersEnabled?0:1}e.d(n,"g",(function(){return j})),e.d(n,"a",(function(){return i})),e.d(n,"f",(function(){return f})),e.d(n,"b",(function(){return l.a})),e.d(n,"e",(function(){return b.a})),e.d(n,"d",(function(){return O})),e.d(n,"c",(function(){return m}));var g=new r.c((function(){return e.e(1779).then(e.bind(null,16781))})),j=new r.b(g,(function(t){return t.getAccessIssuesForAttachments}))},2125:function(t){t.exports=JSON.parse('{"a":"q$a"}')},2195:function(t){t.exports=JSON.parse('{"a":"Tsb","b":"Usb"}')},290:function(t,n,e){"use strict";var r=e(30),i=e(0),c=e(96),u=e(77);function o(t){var n=Object(c.i)(t);return n&&n.SessionSettings?0===n.SessionSettings.WebSessionType?Object(u.i)("doc-attachment-routingKeyAadSmtp")?"SMTP:":"":"MSA:":"no-routing-key:"}var a=e(56);function s(t,n,e){var r,c;if(e)try{for(var u=Object(i.__values)(e),o=u.next();!o.done;o=u.next()){var a=o.value;if(!f(t,a))return a}}catch(t){r={error:t}}finally{try{o&&!o.done&&(c=u.return)&&c.call(u)}finally{if(r)throw r.error}}return n&&n.length>0?n[0]:"NoResolvableAddress@invalid.outlook.com"}function f(t,n){return("outlook_"+t+"@outlook.com").toLowerCase()===n.toLowerCase()}function d(){var t=function(){var t=Object(r.a)();if(!t||!t.SessionSettings)return a.d("SessionSettings not available"),"no-routing-key";var n=t.SessionSettings.UserEmailAddress;if(0===t.SessionSettings.WebSessionType)return o()+n;if(Object(u.i)("doc-attachment-routingKeyPuid"))return"PUID:"+t.SessionSettings.UserPuid+"@"+t.SessionSettings.TenantGuid;if(t.SessionSettings.IsShadowMailbox)return o()+t.SessionSettings.LogonEmailAddress;if(f(t.HexCID,t.SessionSettings.UserEmailAddress))return o()+s(t.HexCID,t.SessionSettings.NotManagedEmailAddresses,t.SessionSettings.UserProxyAddresses);return o()+n}();return t=encodeURIComponent(t)}function l(){var t=Object(r.a)();if(!t||!t.SessionSettings)return a.d("SessionSettings not available"),"no-mailbox-id";var n=t.SessionSettings.UserEmailAddress;return Object(u.i)("doc-attachment-usePrimarySmtpAddressForMailboxId")?n:(t.SessionSettings.IsShadowMailbox?n=t.SessionSettings.LogonEmailAddress:f(t.HexCID,t.SessionSettings.UserEmailAddress)&&(n=s(t.HexCID,t.SessionSettings.NotManagedEmailAddresses,t.SessionSettings.UserProxyAddresses)),n)}var b=e(751),v=e(631);function p(t){var n=Object(v.a)().userMailboxInfoMap;n&&n.delete(t)}function h(t,n){return t===n||null!=t&&null!=n&&t.Id===n.Id}e.d(n,"c",(function(){return l})),e.d(n,"d",(function(){return b.a})),e.d(n,"f",(function(){return p})),e.d(n,"e",(function(){return h})),e.d(n,"a",(function(){return d})),e.d(n,"b",(function(){return o}))},3162:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(1535);function i(t){return(t.__type||t.OwsTypeName)===r.d}},322:function(t,n,e){"use strict";e.d(n,"b",(function(){return c})),e.d(n,"a",(function(){return u}));var r,i=e(0);function c(t){r=t}function u(){var t,n;return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(c=r)?[4,r()]:[3,2];case 1:c=i.sent(),i.label=2;case 2:if((e=c)&&e.length>0){if("bearer"===(null===(t=null==e?void 0:e.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,e.split(" ")[1]];if("msauth1.0"===(null===(n=null==e?void 0:e.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return[2,e]}return[2,void 0]}}))}))}},336:function(t,n,e){"use strict";var r=e(732);e.d(n,"a",(function(){return r.a}))},361:function(t,n,e){"use strict";e.d(n,"a",(function(){return c})),e.d(n,"b",(function(){return u}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function c(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}function u(t){return r.test(t)}},389:function(t,n,e){"use strict";var r,i=e(3);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var c,u=e(72),o=Object(i.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),a=Object(i.action)("removeAccount",(function(t){return{userIdentity:t}})),s=Object(i.action)("updateAccount",(function(t,n,e){return{userIdentity:t,accountToken:n,accountTokenExpiresIn:e}})),f=Object(i.action)("updateOWAConnectedAccountStatus",(function(t,n){return{userIdentity:t,accountState:n}})),d=Object(i.action)("accountIsInErrorState",(function(t,n){return Object(u.c)({name:"accountIsInErrorState",options:{isCore:!0},customData:{accountState_1:r[t],accountProvider_2:n}},{accountState:t})})),l=Object(i.action)("retryAccountUpdateToken",(function(t,n,e,i,c,o){return Object(u.c)({name:"retryAccountUpdateToken",customData:{currentAccountState_1:r[i],localAccountState_2:r[c],previousAccountState_3:r[o]}},{accountId:t,userIdentity:n,currentToken:e})})),b=Object(i.action)("connectedAccountsListRequested",(function(t){return Object(u.c)({name:"connectedAccountsGetResponse",options:{isCore:!0},customData:{isSuccess_1:t}},{isSuccess:t})})),v=Object(i.action)("setAccountsStoreState",(function(t){return{state:t}})),p=e(0),h=e(20);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(c||(c={}));var m=Object(i.createStore)("OWAAccountsStore",{accountsMap:new h.ObservableMap({}),accountsLoadedState:c.None}),O=e(267),g=e(96);function j(t){return t!=Object(g.b)()&&void 0!==y(t)}function S(){return Object(p.__spread)(m().accountsMap.values())}function y(t){return m().accountsMap.get(t)}function A(){var t;return(null===(t=S())||void 0===t?void 0:t.length)>0?S()[0]:null}function x(){return S().filter((function(t){return t.accountState!=r.Valid}))}function I(t){return S().filter((function(n){return t.includes(n.accountState)}))}function w(t){return S().filter((function(n){return n.accountProviderType==t}))}function T(t){return j(t)?y(t).accountProviderType:null}function k(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(O.a)(t.accountProviderType)}function _(t,n){return function(e){var r=y(e);return r?r[t]:n}}_("accountUniqueId","0");var E=_("accountState",r.Valid),P=function(){return S().some((function(t){return!M(t.userIdentity)}))},C=_("accountProviderType",null),D=function(t){return"Outlook"==C(t)},M=function(t){return E(t)==r.Valid},L=function(){return S().length>0};function R(){return m().accountsLoadedState}var N=e(10),F=e(266);Object(i.mutator)(o,(function(t){var n=t.account;Object(F.q)("owaAccountAdded",{accountStatus_1:r[n.accountState]}),m().accountsMap.set(n.userIdentity,n)})),Object(i.mutator)(a,(function(t){var n=t.userIdentity;m().accountsMap.delete(n)})),Object(i.mutator)(s,(function(t){var n=t.userIdentity,e=t.accountToken,r=t.accountTokenExpiresIn,i=m().accountsMap.get(n);i.token=e,i.tokenExpiry=Object(N.j)(Object(N.Pb)(),parseInt(r))})),Object(i.mutator)(f,(function(t){var n=t.userIdentity,e=t.accountState,i=m().accountsMap.get(n);i.accountState==r.Valid&&e!=r.Valid&&Object(F.q)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[e]}),i.accountState=e})),Object(i.mutator)(b,(function(t){var n=t.isSuccess?c.AccountsLoadSuccessful:c.AccountsLoadError;m().accountsLoadedState=n})),Object(i.mutator)(v,(function(t){m().accountsLoadedState=t.state})),e.d(n,"d",(function(){return o})),e.d(n,"u",(function(){return a})),e.d(n,"y",(function(){return s})),e.d(n,"x",(function(){return f})),e.d(n,"c",(function(){return d})),e.d(n,"v",(function(){return l})),e.d(n,"e",(function(){return b})),e.d(n,"w",(function(){return v})),e.d(n,"n",(function(){return S})),e.d(n,"k",(function(){return y})),e.d(n,"i",(function(){return A})),e.d(n,"f",(function(){return x})),e.d(n,"g",(function(){return I})),e.d(n,"o",(function(){return w})),e.d(n,"j",(function(){return T})),e.d(n,"m",(function(){return k})),e.d(n,"l",(function(){return E})),e.d(n,"q",(function(){return P})),e.d(n,"t",(function(){return D})),e.d(n,"s",(function(){return M})),e.d(n,"p",(function(){return L})),e.d(n,"h",(function(){return R})),e.d(n,"r",(function(){return j})),e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return c}))},432:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(73);function i(t){return Object(r.a)(t,[r.c])}},443:function(t,n,e){"use strict";var r=e(0);function i(t,n){return t?Object(r.__assign)({mailboxInfo:t},n):null!=n?n:void 0}e.d(n,"a",(function(){return i}))},447:function(t,n,e){"use strict";var r=function(){function t(t,n,e){this.maxParallelTasks=t,this.taskCallback=n,this.taskDelay=e,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var n=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(n).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();e.d(n,"a",(function(){return r}))},554:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(0);function i(t){return Object(r.__assign)({__type:"FolderId:#Exchange"},t)}},5687:function(t,n,e){"use strict";var r=e(0),i=e(1352),c=e(1905),u=e(4410),o=e(1761),a=e(2181),s=e(281);n.a=Object(s.action)("refreshThumbnailImageUrl")((function(t,n,e){return void 0===e&&(e=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(s=Object(i.a)(t),!Object(o.b)(s.model))return[3,7];switch(s.model.ProviderType){case c.e:return[3,1]}return[3,5];case 1:return r.trys.push([1,3,,4]),[4,Object(u.a)(s.model)];case 2:return f=r.sent(),s.thumbnailImage.url=f,[3,4];case 3:return r.sent(),s.thumbnailImage.url=null,[3,4];case 4:case 5:return[3,6];case 6:return[3,8];case 7:f=Object(a.a)(t,s.model,2,Object(o.b)(s.model),n,e),s.thumbnailImage.url=f,r.label=8;case 8:return[2]}}))}))}))},629:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(0);function i(t){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},t)}},631:function(t,n,e){"use strict";var r=e(3),i=e(20);n.a=Object(r.createStore)("OWAClientIdStore",{userMailboxInfoMap:new i.ObservableMap})},669:function(t,n,e){"use strict";var r=e(3),i=Object(r.action)("initializeOwaObservableDateTime"),c=Object(r.action)("observableNowChanged"),u=Object(r.action)("observableTodayChanged"),o=e(10),a=e(20),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),f=Object(a.computed)((function(){return Object(o.lc)(s().now)})),d=function(){return f.get()},l=Object(a.computed)((function(){return Object(o.lc)(s().today)})),b=function(){return l.get()},v=function(t){return Object(o.Gb)(t,d())},p=function(t){return Object(o.Eb)(t,d())},h=function(t){return O(t,o.Gb)},m=function(t){return O(t,o.Hb)},O=function(t,n){return n(Object(o.Wb)(Object(o.lc)(t)),b())};function g(t){if(!t)return"";var n=Object(o.lc)(t);return function(t,n){var e=Object(o.Wb)(t);if(Object(o.Ib)(e,n))return o.Z;var r=function(t){return Object(o.Mb)(e,Object(o.e)(n,-t),n)};if(r(3))return o.hb;if(r(30))return o.gb;return o.X}(n,b())(n)}function j(t){if(!t)return"";var n=Object(o.lc)(t);return function(t,n){var e=Object(o.Wb)(t);if(Object(o.Ib)(e,n))return o.S;return o.T}(n,b())(n)}function S(t){return t?function(t,n){var e=Object(o.Wb)(t);return Object(o.Ib)(e,n)?Object(o.Z)(t):y(e,n,2)?Object(o.kb)(t):y(e,n,7)?Object(o.H)(Object(o.ab)(t),Object(o.Z)(t)):Object(o.H)(Object(o.J)(t),Object(o.Z)(t))}(Object(o.lc)(t),b()):""}function y(t,n,e){return Object(o.Mb)(t,Object(o.e)(n,-e),n)}var A=Object(r.action)("updateTimes"),x=Object(r.action)("setNow"),I=Object(r.action)("setToday",(function(t){return{today:t}}));Object(r.mutator)(x,(function(){s().now=Object(o.jc)()})),Object(r.mutator)(I,(function(t){var n=t.today;s().today=n}));var w=e(34),T=e(127);Object(r.orchestrator)(i,(function(){A();var t=Object(o.Pb)(),n=Object(o.Yb)(Object(o.h)(t,1)),e=Object(o.w)(n,t);setTimeout((function(){return setInterval(A,w.g)}),e)})),Object(r.orchestrator)(T.l,(function(){A()})),Object(r.orchestrator)(A,(function(){x();var t=Object(o.zb)(Object(o.kc)()),n=s().today!=t;n&&I(t),c(),n&&u()})),e.d(n,"d",(function(){return i})),e.d(n,"j",(function(){return c})),e.d(n,"l",(function(){return u})),e.d(n,"i",(function(){return d})),e.d(n,"k",(function(){return b})),e.d(n,"g",(function(){return v})),e.d(n,"e",(function(){return p})),e.d(n,"f",(function(){return h})),e.d(n,"h",(function(){return m})),e.d(n,"a",(function(){return g})),e.d(n,"b",(function(){return j})),e.d(n,"c",(function(){return S}))},677:function(t,n,e){"use strict";function r(t){void 0===t&&(t={}),function(t){t.timeBetweenRetryInMS=t.timeBetweenRetryInMS||function(){return 6e4}}(t);var n=t.maximumAttempts,e=t.timeBetweenRetryInMS;return function(t){var r=0,i=!1,c=function(u,o){i?o(new Error("The function retry was cancelled")):(r++,t().then((function(t){return u(t)})).catch((function(t){n&&r>=n?o(t):setTimeout((function(){return c(u,o)}),e(r))})))};return{retriableFunc:function(){return new Promise((function(t,n){return c(t,n)}))},cancel:function(){return i=!0}}}}function i(t){return function(n){return Math.pow(2,n)*t}}e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return i}))},6938:function(t,n,e){"use strict";var r=e(0),i=e(281),c=e(10),u=e(7348);function o(t){return Object(r.__assign)({__type:"SetAttachmentPermissionsRequest:#Exchange"},t)}var a=e(29);function s(t,n,e,r){void 0===e&&(e=null),void 0===r&&(r=!1);var i,c,u=function(t,n,e,r){return void 0===e&&(e=null),void 0===r&&(r=!1),o({AttachmentIds:t,PermissionLevel:n,NewAttachLongPathNames:e,SetToOriginalPermissionLevel:r})}(t,n,e,r);return void 0===(i={request:u}).request||i.request.__type||(i.request=o(i.request)),Object(a.a)("SetAttachmentPermissionsV2",i,c)}n.a=Object(i.action)("changeAttachmentPermission")((function(t,n,e,i){return void 0===e&&(e=null),void 0===i&&(i=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,s(t.map((function(t){return t.Id})),n,e,i)];case 1:if(!(o=r.sent()).OperationSucceeded||!o.NewAttachLongPathNames||o.NewAttachLongPathNames.length!==t.length)throw new Error("Error setting attachment permissions");return t.forEach((function(t,e){var r,i=null;(null===(r=o.ExpirationDates)||void 0===r?void 0:r[e])&&(i=Object(c.lc)(o.ExpirationDates[e])),Object(u.a)(t,n,o.NewAttachLongPathNames[e],i)})),[2]}}))}))}))},732:function(t,n,e){"use strict";function r(t){return t>=200&&t<300}e.d(n,"a",(function(){return r}))},7348:function(t,n,e){"use strict";var r=e(2227),i=e(1352),c=e(6496),u=e(77),o=e(281);n.a=Object(o.action)("setAttachmentPermissionLevel")((function(t,n,e,o){var a=Object(i.a)(t),s=a.model;s.PermissionType=n,e&&(s.AttachLongPathName=e,a.openUrl=Object(c.a)(s)),Object(u.i)("doc-attachment-referenceAttachmentExpiration")&&a.info&&a.info.sharingInfo&&(a.info.sharingInfo.expirationDate=o),Object(r.a)(t)}))},751:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(96),i=e(631);function c(t){var n=Object(i.a)().userMailboxInfoMap;if(!n||!n.get(t)){var e=!1;t&&(e=t!=Object(r.b)());var c={type:"UserMailbox",userIdentity:e?t:Object(r.b)(),mailboxSmtpAddress:e?t:Object(r.c)()};return n.set(t,c),c}return n.get(t)}},791:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(0);function i(t){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},t)}},804:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(29),i=e(791);function c(t,n){return void 0===t||t.__type||(t=Object(i.a)(t)),Object(r.a)("FindItem",t,n)}},805:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(0);function i(t){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},t)}}}]);
//# sourceMappingURL=owa.AttachmentModelStore.js.map
self.scriptsLoaded['owa.AttachmentModelStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentModelStore.js'] = (new Date()).getTime();