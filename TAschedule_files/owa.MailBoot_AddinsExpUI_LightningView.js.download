self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AddinsExpUI~LightningView.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[205],{1341:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return s}));var r=t(3),o=t(20),i=Object(r.createStore)("lightningState",{unseenItems:new o.ObservableMap,lightedCount:0,lastShownId:null}),s=i()},1396:function(e,n,t){"use strict";var r=t(0),o=t(47),i=t(1418),s=t(1),a=t.n(s);function u(e,n){var t=function(n,t){return a.a.createElement(d,Object(r.__assign)({},n),a.a.createElement(e,Object(r.__assign)({},n)))};return t.displayName=e.displayName,n?a.a.forwardRef(t):t}var d=Object(o.a)((function(e){var n=e.lid,t=e.when,r=e.series,o=e.children,s=e.disposeOnUnmount,u=void 0===s||s;return a.a.useEffect((function(){return Object(i.b)(n,t,r),function(){u&&i.c.importAndExecute(n)}}),[]),o&&l(n)?a.a.createElement(a.a.Fragment,null,o):null}));function c(e,n){i.c.importAndExecute(e,n)}function l(e){if(i.d.unseenItems){var n=i.d.unseenItems.get(e);if(null==n?void 0:n.visible)return!0}return!1}function f(e){var n;return null===(n=i.d.unseenItems)||void 0===n?void 0:n.has(e)}t.d(n,"d",(function(){return u})),t.d(n,"a",(function(){return d})),t.d(n,"e",(function(){return c})),t.d(n,"f",(function(){return l})),t.d(n,"c",(function(){return f})),t.d(n,"b",(function(){return i.a}))},1418:function(e,n,t){"use strict";var r=t(74),o=t(1341),i=t(56),s=t(0),a=t(4),u=t(20),d=t(3),c=Object(d.mutatorAction)("initializeLightning",(function(e){var n,t;if(i.g.info("initialize lightning store"),Object(o.a)().lastShownId=null,Object(o.a)().lightedCount=0,Object(o.a)().unseenItems=new u.ObservableMap,e)try{for(var r=Object(s.__values)(e),a=r.next();!a.done;a=r.next()){var d=a.value;Object(o.a)().unseenItems.set(d.identity,d)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}}));var l=t(319),f="ows/v1.0/lightning/items/unseen";function g(){return i.g.info("initialize lightning from server"),Object(l.b)(f).then((function(e){var n=e.map(p);c(n)}))}function p(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var v,h=t(30),m=t(77),b="lightning",w="UnseenLightening";function y(){var e,n,t;if(!v){var r=Object(a.a)(b);if(r)v=function(e){i.g.info("initialize lightning from override query parameter");var n=e.split(",").map((function(e){return{identity:e,visible:!1}}));return c(n),Promise.resolve()}(r);else{var o=Object(h.a)().PrimeSettings;if(Object(m.i)("lightning-initFromSD")&&o&&o.Items)try{for(var u=Object(s.__values)(o.Items),d=u.next();!d.done;d=u.next()){var l=d.value;if(l.Id===w&&l.Value){t=l.Value,i.g.info("initialize lightning from session data"),c(t.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),v=Promise.resolve();break}}}catch(n){e={error:n}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}v||(v=g())}}return v}var I=t(1708),S=Object(d.action)("lightup",(function(e){return{id:e}})),V=S;Object(d.mutator)(S,(function(e){i.g.info("lightup - id:"+e.id),Object(o.a)().lastShownId=e.id,Object(o.a)().lightedCount++;var n=Object(o.a)().unseenItems.get(e.id);n&&(n.visible=!0)})),Object(d.orchestrator)(S,(function(e){Object(I.a)("LIGHTUP",e.id)}));var C,O=t(627);function A(e,n){(i.g.info("lightupOrReject - id:"+e+", recurrenceCount:"+n+", lightedCount:"+Object(o.a)().lightedCount+", lastShown:"+Object(o.a)().lastShownId),Object(O.v)())?i.g.info("lightning is disabled for deeplink"):Object(o.a)().unseenItems.has(e)&&(!Object(o.a)().lastShownId||function(e,n){var t=!1,r=Object(o.a)().lastShownId;if(r&&n&&!function(){var e=Object(o.a)(),n=e.lastShownId,t=e.unseenItems;return n&&t.has(n)&&t.get(n).visible}()){var i=n.indexOf(r),s=n.indexOf(e);i>=0&&i+1==s&&(t=!0)}return t}(e,n)||function(e){var n=Object(o.a)().unseenItems.get(e);return!!n&&n.category==C.UIFeatureDiscovery}(e)||function(e){var n=Object(o.a)().unseenItems.get(e);return!!n&&n.category==C.Compliance}(e))&&V(e)}function P(e,n,t){i.g.info("beginLightning - id:"+e),n((function(){y().then((function(){return A(e,t)})).catch((function(n){i.g.warn("something is wrong, lightning id:"+e+", reason:"+n)}))}))}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(C||(C={}));var j=t(1423);t.d(n,"c",(function(){return E})),t.d(n,"d",(function(){return o.b})),t.d(n,"b",(function(){return P})),t.d(n,"a",(function(){return j.a}));var L=new r.c((function(){return t.e(452).then(t.bind(null,17471))})),E=new r.a(L,(function(e){return e.endLightningImp}))},1423:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67",e.InsertLinkTeachingMomentOpenCompose="68",e.InsertLinkTeachingMomentAfterAttach="69",e.ShortenEventsDurationSetting="70",e.HoneybeeClipboard="71",e.AttachmentSaveToCloudOpenAndEdit="72",e.GdprAdsEPrivacy="73",e.AdminInstalledNewAddinsFRE="75",e.InsertLinkFREOpenCompose="76",e.InsertLinkFREAfterAttach="77",e.SpotlightFre="78",e.OverlayFolderPaneFre="79",e.SpotlightPropertyIcon="80",e.GdprAdsV3ClearNull="81"}(r||(r={}))},1708:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(72),o=t(1423);function i(e,n){Object.keys(o.a).some((function(t){return o.a[t]==n&&(Object(r.h)(e,{key:t,id:n},{isCore:!0}),!0)}))}},3992:function(e,n,t){"use strict";var r=t(0),o=t(77),i=t(1299);function s(e){var n;n=Object(o.i)("fwk-gdprAdsV2")?Object(i.d)(i.a.GdprAdsV2):Object(i.d)(i.a.GdprAdsPrefs);var t=Object(r.__assign)(Object(r.__assign)({},n),{consentString:e});return Object(o.i)("fwk-gdprAdsV2")?i.e.importAndExecute(i.a.GdprAdsV2,t):i.e.importAndExecute(i.a.GdprAdsPrefs,t)}var a,u=t(5173),d=t(96),c=t(56),l=t(74),f=new l.c((function(){return t.e(807).then(t.bind(null,17506))})),g=new l.b(f,(function(e){return e.getVendorListJson}));function p(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return a?[3,2]:[4,g.import()];case 1:e=n.sent(),a=e(),n.label=2;case 2:return[2,a]}}))}))}function v(e,n,t,o,i,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,l,f,g,v,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,p()];case 1:return(a=r.sent())?((l=new u.ConsentString).setGlobalVendorList(a),f=[],[e,n,t,o,i].forEach((function(e,n){e&&f.push(n+1)})),g=[],a.vendors.forEach((function(e){null!=s&&-1!=s.indexOf(e.id)||g.push(e.id)})),v=Object(d.h)().SessionSettings.UserCulture,h=v?v.split("-")[0]:"en",l.setCmpId(168),l.setCmpVersion(1),l.setConsentScreen(1),l.setConsentLanguage(h),l.setPurposesAllowed(f),l.setVendorsAllowed(g),[2,l.getConsentString()]):(c.d("Fetching vendor list failed."),[2,null])}}))}))}var h=t(72);function m(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,n,t,a,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=175,[4,i.f.import()];case 1:return t=r.sent(),Object(o.i)("fwk-gdprAdsV2")?[4,t(i.a.GdprAdsV2)]:[3,3];case 2:return a=r.sent(),[3,5];case 3:return[4,t(i.a.GdprAdsPrefs)];case 4:a=r.sent(),r.label=5;case 5:if(null==a||null==a.consentString||""==a.consentString)return[2,null];n=a.consentString;try{d=new u.ConsentString(n)}catch(e){return Object(h.h)("InvalidFormatConsentDataString",{consentString:n,errorMessage:e.message}),[2,null]}return 168!=d.getCmpId()?(Object(h.h)("InvalidCmpIdConsentDataString",{consentString:n}),[2,null]):d.getVendorListVersion()<e?(Object(h.h)("UpdateConsentDataVenorListVersion",{consentString:n}),[4,v(a.allowStorageAndAccess,a.allowPersonalization,a.allowAdSelectionDeliveryReporting,a.allowContentSelectionDeliveryReporting,a.allowMeasurement,a.disselectedVendorId)]):[3,8];case 6:return[4,s(n=r.sent())];case 7:r.sent(),r.label=8;case 8:return[2,n]}}))}))}t.d(n,"c",(function(){return m})),t.d(n,"b",(function(){return v})),t.d(n,"a",(function(){return p}))},5173:function(e,n,t){"use strict";var r=t(8139).ConsentString,o=t(6404).decodeConsentString,i=t(6401).encodeConsentString;e.exports={ConsentString:r,decodeConsentString:o,encodeConsentString:i}},6401:function(e,n,t){"use strict";var r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},o=t(6402),i=o.encodeToBase64,s=o.padRight;function a(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t="",r=1;r<=e;r+=1)t+=-1!==n.indexOf(r)?"1":"0";return s(t,Math.max(0,e-t.length))}function u(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set,t=0,r=0;r<e.length;r+=1)t=Math.max(t,e[r].id);for(var o=0;o<n.length;o+=1)t=Math.max(t,n[o]);for(var i="",s=1;s<=t;s+=1)i+=-1!==n.indexOf(s)?"1":"0";return i}function d(e,n){for(var t=[],r=[],o=e.map((function(e){return e.id})),i=0;i<e.length;i+=1){var s=e[i].id;if(-1!==n.indexOf(s)&&t.push(s),(-1===n.indexOf(s)||i===e.length-1||-1===o.indexOf(s+1))&&t.length){var a=t.shift(),u=t.pop();t=[],r.push({isRange:"number"==typeof u,startVendorId:a,endVendorId:u})}}return r}function c(e){var n=0;return e.forEach((function(e){e.id>n&&(n=e.id)})),n}e.exports={convertVendorsToRanges:d,encodeConsentString:function(e){var n=e.maxVendorId,t=e.vendorList,o=void 0===t?{}:t,s=e.allowedPurposeIds,l=e.allowedVendorIds,f=o.vendors,g=void 0===f?[]:f,p=o.purposes,v=void 0===p?[]:p;n||(n=c(g));var h=i(r({},e,{maxVendorId:n,purposeIdBitString:u(v,s),isRange:!1,vendorIdBitString:a(n,l)})),m=d(g,l),b=i(r({},e,{maxVendorId:n,purposeIdBitString:u(v,s),isRange:!0,defaultConsent:!1,numEntries:m.length,vendorRangeList:m}));return h.length<b.length?h:b},getMaxVendorId:c,encodeVendorIdsToBits:a,encodePurposeIdsToBits:u}},6402:function(e,n,t){"use strict";var r=t(8140),o=t(6403),i=o.versionNumBits,s=o.vendorVersionMap;function a(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",t="",r=0;r<e;r+=1)t+=n;return t}function u(e,n){return a(Math.max(0,n))+e}function d(e,n){return e+a(Math.max(0,n))}function c(e,n){var t="";return"number"!=typeof e||isNaN(e)||(t=parseInt(e,10).toString(2)),n>=t.length&&(t=u(t,n-t.length)),t.length>n&&(t=t.substring(0,n)),t}function l(e){return c(!0===e?1:0,1)}function f(e,n){return e instanceof Date?c(e.getTime()/100,n):c(e,n)}function g(e,n){return c(e.toUpperCase().charCodeAt(0)-65,n)}function p(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return g(e.slice(0,1),n/2)+g(e.slice(1),n/2)}function v(e,n,t){return parseInt(e.substr(n,t),2)}function h(e,n,t){return new Date(100*v(e,n,t))}function m(e,n){return 1===parseInt(e.substr(n,1),2)}function b(e){var n=v(e);return String.fromCharCode(n+65).toLowerCase()}function w(e,n,t){var r=e.substr(n,t);return b(r.slice(0,t/2))+b(r.slice(t/2))}function y(e){var n=e.input,t=e.field,r=t.name,o=t.type,i=t.numBits,s=t.encoder,a=t.validator;if("function"==typeof a&&!a(n))return"";if("function"==typeof s)return s(n);var u="function"==typeof i?i(n):i,g=n[r],v=null==g?"":g;switch(o){case"int":return c(v,u);case"bool":return l(v);case"date":return f(v,u);case"bits":return d(v,u-v.length).substring(0,u);case"list":return v.reduce((function(e,n){return e+I({input:n,fields:t.fields})}),"");case"language":return p(v,u);default:throw new Error("ConsentString - Unknown field type "+o+" for encoding")}}function I(e){var n=e.input;return e.fields.reduce((function(e,t){return e+=y({input:n,field:t})}),"")}function S(e){var n=e.input,t=e.output,r=e.startPosition,o=e.field,i=o.type,s=o.numBits,a=o.decoder,u=o.validator,d=o.listCount;if("function"==typeof u&&!u(t))return{newPosition:r};if("function"==typeof a)return a(n,t,r);var c="function"==typeof s?s(t):s;switch(i){case"int":return{fieldValue:v(n,r,c)};case"bool":return{fieldValue:m(n,r)};case"date":return{fieldValue:h(n,r,c)};case"bits":return{fieldValue:n.substr(r,c)};case"list":return function(e,n,t,r,o){var i=0;"function"==typeof o?i=o(n):"number"==typeof o&&(i=o);for(var s=t,a=[],u=0;u<i;u+=1){var d=V({input:e,fields:r.fields,startPosition:s});s=d.newPosition,a.push(d.decodedObject)}return{fieldValue:a,newPosition:s}}(n,t,r,o,d);case"language":return{fieldValue:w(n,r,c)};default:throw new Error("ConsentString - Unknown field type "+i+" for decoding")}}function V(e){var n=e.input,t=e.fields,r=e.startPosition,o=void 0===r?0:r;return{decodedObject:t.reduce((function(e,t){var r=t.name,i=t.numBits,s=S({input:n,output:e,startPosition:o,field:t}),a=s.fieldValue,u=s.newPosition;return void 0!==a&&(e[r]=a),void 0!==u?o=u:"number"==typeof i&&(o+=i),e}),{}),newPosition:o}}function C(e,n){var t=e.version;if("number"!=typeof t)throw new Error("ConsentString - No version field to encode");if(n[t])return I({input:e,fields:n[t].fields});throw new Error("ConsentString - No definition for version "+t)}e.exports={padRight:d,padLeft:u,encodeField:y,encodeDataToBits:C,encodeIntToBits:c,encodeBoolToBits:l,encodeDateToBits:f,encodeLanguageToBits:p,encodeLetterToBits:g,encodeToBase64:function(e){var n=C(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:s);if(n){for(var t=d(n,7-(n.length+7)%8),o="",i=0;i<t.length;i+=8)o+=String.fromCharCode(parseInt(t.substr(i,8),2));return r.encode(o).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}return null},decodeBitsToIds:function(e){return e.split("").reduce((function(e,n,t){return"1"===n&&-1===e.indexOf(t+1)&&e.push(t+1),e}),[])},decodeBitsToInt:v,decodeBitsToDate:h,decodeBitsToBool:m,decodeBitsToLanguage:w,decodeBitsToLetter:b,decodeFromBase64:function(e,n){for(var t=e;t.length%4!=0;)t+="=";t=t.replace(/-/g,"+").replace(/_/g,"/");for(var o=r.decode(t),a="",d=0;d<o.length;d+=1){var c=o.charCodeAt(d).toString(2);a+=u(c,8-c.length)}return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,t=v(e,0,i);if("number"!=typeof t)throw new Error("ConsentString - Unknown version number in the string to decode");if(!s[t])throw new Error("ConsentString - Unsupported version "+t+" in the string to decode");return V({input:e,fields:n[t].fields}).decodedObject}(a,n)}}},6403:function(e,n,t){"use strict";e.exports={versionNumBits:6,vendorVersionMap:{1:{version:1,metadataFields:["version","created","lastUpdated","cmpId","cmpVersion","consentScreen","vendorListVersion"],fields:[{name:"version",type:"int",numBits:6},{name:"created",type:"date",numBits:36},{name:"lastUpdated",type:"date",numBits:36},{name:"cmpId",type:"int",numBits:12},{name:"cmpVersion",type:"int",numBits:12},{name:"consentScreen",type:"int",numBits:6},{name:"consentLanguage",type:"language",numBits:12},{name:"vendorListVersion",type:"int",numBits:12},{name:"purposeIdBitString",type:"bits",numBits:24},{name:"maxVendorId",type:"int",numBits:16},{name:"isRange",type:"bool",numBits:1},{name:"vendorIdBitString",type:"bits",numBits:function(e){return e.maxVendorId},validator:function(e){return!e.isRange}},{name:"defaultConsent",type:"bool",numBits:1,validator:function(e){return e.isRange}},{name:"numEntries",numBits:12,type:"int",validator:function(e){return e.isRange}},{name:"vendorRangeList",type:"list",listCount:function(e){return e.numEntries},validator:function(e){return e.isRange},fields:[{name:"isRange",type:"bool",numBits:1},{name:"startVendorId",type:"int",numBits:16},{name:"endVendorId",type:"int",numBits:16,validator:function(e){return e.isRange}}]}]}}}},6404:function(e,n,t){"use strict";var r=t(6402),o=r.decodeBitsToIds,i=r.decodeFromBase64;e.exports={decodeConsentString:function(e){var n=i(e),t=n.version,r=n.cmpId,s=n.vendorListVersion,a=n.purposeIdBitString,u=n.maxVendorId,d=n.created,c=n.lastUpdated,l=n.isRange,f=n.defaultConsent,g=n.vendorIdBitString,p=n.vendorRangeList,v=n.cmpVersion,h=n.consentScreen,m=n.consentLanguage,b={version:t,cmpId:r,vendorListVersion:s,allowedPurposeIds:o(a),maxVendorId:u,created:d,lastUpdated:c,cmpVersion:v,consentScreen:h,consentLanguage:m};if(l){var w=p.reduce((function(e,n){for(var t=n.isRange,r=n.startVendorId,o=n.endVendorId,i=t?o:r,s=r;s<=i;s+=1)e[s]=!0;return e}),{});b.allowedVendorIds=[];for(var y=1;y<=u;y+=1)(f&&!w[y]||!f&&w[y])&&-1===b.allowedVendorIds.indexOf(y)&&b.allowedVendorIds.push(y)}else b.allowedVendorIds=o(g);return b}}},8139:function(e,n,t){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();var i=t(6401),s=i.encodeConsentString,a=i.getMaxVendorId,u=i.encodeVendorIdsToBits,d=i.encodePurposeIdsToBits,c=t(6404).decodeConsentString,l=t(6403).vendorVersionMap,f=/^[a-z]{2}$/,g=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.created=new Date,this.lastUpdated=new Date,this.version=1,this.vendorList=null,this.vendorListVersion=null,this.cmpId=null,this.cmpVersion=null,this.consentScreen=null,this.consentLanguage=null,this.allowedPurposeIds=[],this.allowedVendorIds=[],n&&Object.assign(this,c(n))}return o(e,[{key:"getConsentString",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.vendorList)throw new Error("ConsentString - A vendor list is required to encode a consent string");return!0===e&&(this.lastUpdated=new Date),s({version:this.getVersion(),vendorList:this.vendorList,allowedPurposeIds:this.allowedPurposeIds,allowedVendorIds:this.allowedVendorIds,created:this.created,lastUpdated:this.lastUpdated,cmpId:this.cmpId,cmpVersion:this.cmpVersion,consentScreen:this.consentScreen,consentLanguage:this.consentLanguage,vendorListVersion:this.vendorListVersion})}},{key:"getMaxVendorId",value:function(){return a(this.vendorList.vendors)}},{key:"getParsedVendorConsents",value:function(){return u(a(this.vendorList.vendors),this.allowedVendorIds)}},{key:"getParsedPurposeConsents",value:function(){return d(this.vendorList.purposes,this.allowedPurposeIds)}},{key:"getMetadataString",value:function(){return s({version:this.getVersion(),created:this.created,lastUpdated:this.lastUpdated,cmpId:this.cmpId,cmpVersion:this.cmpVersion,consentScreen:this.consentScreen,vendorListVersion:this.vendorListVersion})}},{key:"getVersion",value:function(){return this.version}},{key:"getVendorListVersion",value:function(){return this.vendorListVersion}},{key:"setGlobalVendorList",value:function(e){if("object"!==(void 0===e?"undefined":r(e)))throw new Error("ConsentString - You must provide an object when setting the global vendor list");if(!e.vendorListVersion||!Array.isArray(e.purposes)||!Array.isArray(e.vendors))throw new Error("ConsentString - The provided vendor list does not respect the schema from the IAB EU’s GDPR Consent and Transparency Framework");this.vendorList={vendorListVersion:e.vendorListVersion,lastUpdated:e.lastUpdated,purposes:e.purposes,features:e.features,vendors:e.vendors.slice(0).sort((function(e,n){return e.id<n.id?-1:1}))},this.vendorListVersion=e.vendorListVersion}},{key:"setCmpId",value:function(e){this.cmpId=e}},{key:"getCmpId",value:function(){return this.cmpId}},{key:"setCmpVersion",value:function(e){this.cmpVersion=e}},{key:"getCmpVersion",value:function(){return this.cmpVersion}},{key:"setConsentScreen",value:function(e){this.consentScreen=e}},{key:"getConsentScreen",value:function(){return this.consentScreen}},{key:"setConsentLanguage",value:function(e){if(!1===f.test(e))throw new Error("ConsentString - The consent language must be a two-letter ISO639-1 code (en, fr, de, etc.)");this.consentLanguage=e}},{key:"getConsentLanguage",value:function(){return this.consentLanguage}},{key:"setPurposesAllowed",value:function(e){this.allowedPurposeIds=e}},{key:"getPurposesAllowed",value:function(){return this.allowedPurposeIds}},{key:"setPurposeAllowed",value:function(e,n){var t=this.allowedPurposeIds.indexOf(e);!0===n?-1===t&&this.allowedPurposeIds.push(e):!1===n&&-1!==t&&this.allowedPurposeIds.splice(t,1)}},{key:"isPurposeAllowed",value:function(e){return-1!==this.allowedPurposeIds.indexOf(e)}},{key:"setVendorsAllowed",value:function(e){this.allowedVendorIds=e}},{key:"getVendorsAllowed",value:function(){return this.allowedVendorIds}},{key:"setVendorAllowed",value:function(e,n){var t=this.allowedVendorIds.indexOf(e);!0===n?-1===t&&this.allowedVendorIds.push(e):!1===n&&-1!==t&&this.allowedVendorIds.splice(t,1)}},{key:"isVendorAllowed",value:function(e){return-1!==this.allowedVendorIds.indexOf(e)}}],[{key:"decodeMetadataString",value:function(e){var n=c(e),t={};return l[n.version].metadataFields.forEach((function(e){t[e]=n[e]})),t}}]),e}();e.exports={ConsentString:g}},8140:function(e,n,t){(function(e,r){var o;/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */!function(i){var s=n,a=(e&&e.exports,"object"==typeof r&&r);a.global!==a&&a.window;var u=function(e){this.message=e};(u.prototype=new Error).name="InvalidCharacterError";var d=function(e){throw new u(e)},c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=/[\t\n\f\r ]/g,f={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&d("The string to be encoded contains characters outside of the Latin1 range.");for(var n,t,r,o,i=e.length%3,s="",a=-1,u=e.length-i;++a<u;)n=e.charCodeAt(a)<<16,t=e.charCodeAt(++a)<<8,r=e.charCodeAt(++a),s+=c.charAt((o=n+t+r)>>18&63)+c.charAt(o>>12&63)+c.charAt(o>>6&63)+c.charAt(63&o);return 2==i?(n=e.charCodeAt(a)<<8,t=e.charCodeAt(++a),s+=c.charAt((o=n+t)>>10)+c.charAt(o>>4&63)+c.charAt(o<<2&63)+"="):1==i&&(o=e.charCodeAt(a),s+=c.charAt(o>>2)+c.charAt(o<<4&63)+"=="),s},decode:function(e){var n=(e=String(e).replace(l,"")).length;n%4==0&&(n=(e=e.replace(/==?$/,"")).length),(n%4==1||/[^+a-zA-Z0-9/]/.test(e))&&d("Invalid character: the string to be decoded is not correctly encoded.");for(var t,r,o=0,i="",s=-1;++s<n;)r=c.indexOf(e.charAt(s)),t=o%4?64*t+r:r,o++%4&&(i+=String.fromCharCode(255&t>>(-2*o&6)));return i},version:"0.1.0"};void 0===(o=function(){return f}.call(n,t,n,e))||(e.exports=o)}()}).call(this,t(477)(e),t(115))}}]);
//# sourceMappingURL=owa.MailBoot~AddinsExpUI~LightningView.js.map
self.scriptsLoaded['owa.MailBoot~AddinsExpUI~LightningView.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AddinsExpUI~LightningView.js'] = (new Date()).getTime();